"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/dungeons/run/[id]/fight/route";
exports.ids = ["app/api/dungeons/run/[id]/fight/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&page=%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute.ts&appDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&page=%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute.ts&appDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_artosetrov_Documents_Cursor_AI_BumWars_app_api_dungeons_run_id_fight_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/dungeons/run/[id]/fight/route.ts */ \"(rsc)/./app/api/dungeons/run/[id]/fight/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/dungeons/run/[id]/fight/route\",\n        pathname: \"/api/dungeons/run/[id]/fight\",\n        filename: \"route\",\n        bundlePath: \"app/api/dungeons/run/[id]/fight/route\"\n    },\n    resolvedPagePath: \"/Users/artosetrov/Documents/Cursor AI/BumWars/app/api/dungeons/run/[id]/fight/route.ts\",\n    nextConfigOutput,\n    userland: _Users_artosetrov_Documents_Cursor_AI_BumWars_app_api_dungeons_run_id_fight_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/dungeons/run/[id]/fight/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZkdW5nZW9ucyUyRnJ1biUyRiU1QmlkJTVEJTJGZmlnaHQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmR1bmdlb25zJTJGcnVuJTJGJTVCaWQlNUQlMkZmaWdodCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmR1bmdlb25zJTJGcnVuJTJGJTVCaWQlNUQlMkZmaWdodCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFydG9zZXRyb3YlMkZEb2N1bWVudHMlMkZDdXJzb3IlMjBBSSUyRkJ1bVdhcnMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGYXJ0b3NldHJvdiUyRkRvY3VtZW50cyUyRkN1cnNvciUyMEFJJTJGQnVtV2FycyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDc0M7QUFDbkg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcm9uLWZpc3QtYXJlbmEvP2IwMzEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2FydG9zZXRyb3YvRG9jdW1lbnRzL0N1cnNvciBBSS9CdW1XYXJzL2FwcC9hcGkvZHVuZ2VvbnMvcnVuL1tpZF0vZmlnaHQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2R1bmdlb25zL3J1bi9baWRdL2ZpZ2h0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZHVuZ2VvbnMvcnVuL1tpZF0vZmlnaHRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2R1bmdlb25zL3J1bi9baWRdL2ZpZ2h0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2FydG9zZXRyb3YvRG9jdW1lbnRzL0N1cnNvciBBSS9CdW1XYXJzL2FwcC9hcGkvZHVuZ2VvbnMvcnVuL1tpZF0vZmlnaHQvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2R1bmdlb25zL3J1bi9baWRdL2ZpZ2h0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&page=%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute.ts&appDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/dungeons/run/[id]/fight/route.ts":
/*!**************************************************!*\
  !*** ./app/api/dungeons/run/[id]/fight/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_game_combat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/game/combat */ \"(rsc)/./lib/game/combat.ts\");\n/* harmony import */ var _lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/game/dungeon */ \"(rsc)/./lib/game/dungeon.ts\");\n/* harmony import */ var _lib_game_loot__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/game/loot */ \"(rsc)/./lib/game/loot.ts\");\n/* harmony import */ var _lib_game_levelUp__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/game/levelUp */ \"(rsc)/./lib/game/levelUp.ts\");\n/* harmony import */ var _lib_game_quests__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/game/quests */ \"(rsc)/./lib/game/quests.ts\");\n\n\n\n\n\n\n\n\nasync function POST(request, { params }) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createServerSupabaseClient)();\n        const { data: { user: authUser } } = await supabase.auth.getUser();\n        if (!authUser) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const { id: runId } = await params;\n        const run = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.dungeonRun.findFirst({\n            where: {\n                id: runId\n            },\n            include: {\n                character: true\n            }\n        });\n        if (!run || run.character.userId !== authUser.id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"Run not found\"\n            }, {\n                status: 404\n            });\n        }\n        const state = run.state;\n        const character = run.character;\n        const dungeon = (0,_lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__.getDungeonById)(state.dungeonId);\n        if (!dungeon) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                error: \"Dungeon data not found\"\n            }, {\n                status: 500\n            });\n        }\n        // Build player combatant\n        const playerState = (0,_lib_game_combat__WEBPACK_IMPORTED_MODULE_3__.buildCombatantState)({\n            id: character.id,\n            name: character.characterName,\n            class: character.class,\n            origin: character.origin,\n            level: character.level,\n            strength: character.strength,\n            agility: character.agility,\n            vitality: character.vitality,\n            endurance: character.endurance,\n            intelligence: character.intelligence,\n            wisdom: character.wisdom,\n            luck: character.luck,\n            charisma: character.charisma,\n            armor: character.armor\n        });\n        // Build boss combatant\n        const bs = state.bossStats;\n        const enemyState = (0,_lib_game_combat__WEBPACK_IMPORTED_MODULE_3__.buildCombatantState)({\n            id: \"boss\",\n            name: bs.name,\n            class: \"warrior\",\n            level: character.level,\n            strength: bs.strength,\n            agility: bs.agility,\n            vitality: bs.vitality,\n            endurance: bs.endurance,\n            intelligence: bs.intelligence,\n            wisdom: bs.wisdom,\n            luck: bs.luck,\n            charisma: bs.charisma,\n            armor: bs.armor\n        });\n        enemyState.currentHp = state.bossCurrentHp;\n        enemyState.maxHp = bs.maxHp;\n        const result = (0,_lib_game_combat__WEBPACK_IMPORTED_MODULE_3__.runCombat)(playerState, enemyState, []);\n        // DEFEAT — delete run, return result\n        if (result.winnerId !== character.id) {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.dungeonRun.delete({\n                where: {\n                    id: runId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                victory: false,\n                log: result.log,\n                playerSnapshot: result.playerSnapshot,\n                enemySnapshot: result.enemySnapshot,\n                message: \"Defeat\"\n            });\n        }\n        // VICTORY — calculate rewards\n        const dungeonIndex = _lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__.DUNGEONS.findIndex((d)=>d.id === state.dungeonId);\n        const goldEarned = (0,_lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__.getBossGoldReward)(Math.max(0, dungeonIndex), state.bossIndex);\n        const xpEarned = (0,_lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__.getBossXpReward)(Math.max(0, dungeonIndex), state.bossIndex);\n        state.rewards.gold += goldEarned;\n        state.rewards.xp += xpEarned;\n        // Loot roll\n        const difficultyForLoot = dungeonIndex <= 1 ? \"easy\" : dungeonIndex <= 4 ? \"normal\" : \"hard\";\n        const isBoss = true;\n        const droppedItem = (0,_lib_game_loot__WEBPACK_IMPORTED_MODULE_5__.rollDropChance)(difficultyForLoot, isBoss) && (()=>{\n            const rarity = (0,_lib_game_loot__WEBPACK_IMPORTED_MODULE_5__.rollRarity)(character.luck, difficultyForLoot);\n            return {\n                rarity,\n                bossIndex: state.bossIndex\n            };\n        })();\n        const nextBossIndex = state.bossIndex + 1;\n        const dungeonComplete = nextBossIndex >= dungeon.bosses.length;\n        // Apply completion bonus\n        if (dungeonComplete) {\n            const bonus = (0,_lib_game_dungeon__WEBPACK_IMPORTED_MODULE_4__.getDungeonCompletionBonus)(Math.max(0, dungeonIndex));\n            state.rewards.gold += bonus.gold;\n            state.rewards.xp += bonus.xp;\n        }\n        let newItemId = null;\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.$transaction(async (tx)=>{\n            // Handle dropped item\n            if (droppedItem) {\n                const itemLevel = Math.max(1, character.level + Math.floor(Math.random() * 6) - 2);\n                const rarity = droppedItem.rarity;\n                let item = await tx.item.findFirst({\n                    where: {\n                        rarity,\n                        itemLevel: {\n                            gte: itemLevel - 1,\n                            lte: itemLevel + 1\n                        }\n                    }\n                });\n                if (!item) {\n                    const statRange = {\n                        common: [\n                            5,\n                            15\n                        ],\n                        uncommon: [\n                            12,\n                            25\n                        ],\n                        rare: [\n                            20,\n                            45\n                        ],\n                        epic: [\n                            40,\n                            80\n                        ],\n                        legendary: [\n                            75,\n                            150\n                        ]\n                    };\n                    const [lo, hi] = statRange[rarity];\n                    const primary = Math.floor(lo + Math.random() * (hi - lo + 1));\n                    item = await tx.item.create({\n                        data: {\n                            itemName: `${dungeon.name} ${rarity} Loot`,\n                            itemType: \"weapon\",\n                            rarity,\n                            itemLevel,\n                            baseStats: {\n                                strength: primary\n                            },\n                            buyPrice: itemLevel * 10 * (rarity === \"legendary\" ? 25 : rarity === \"epic\" ? 10 : rarity === \"rare\" ? 4 : rarity === \"uncommon\" ? 2 : 1)\n                        }\n                    });\n                }\n                const inv = await tx.equipmentInventory.create({\n                    data: {\n                        characterId: character.id,\n                        itemId: item.id\n                    }\n                });\n                newItemId = inv.id;\n            }\n            // Update dungeon progress\n            await tx.dungeonProgress.upsert({\n                where: {\n                    characterId_dungeonId: {\n                        characterId: character.id,\n                        dungeonId: state.dungeonId\n                    }\n                },\n                create: {\n                    characterId: character.id,\n                    dungeonId: state.dungeonId,\n                    bossIndex: nextBossIndex,\n                    completed: dungeonComplete\n                },\n                update: {\n                    bossIndex: nextBossIndex,\n                    completed: dungeonComplete\n                }\n            });\n            if (dungeonComplete) {\n                // Apply total rewards\n                const levelUp = (0,_lib_game_levelUp__WEBPACK_IMPORTED_MODULE_6__.applyLevelUp)({\n                    level: character.level,\n                    currentXp: character.currentXp + state.rewards.xp,\n                    statPointsAvailable: character.statPointsAvailable,\n                    gold: character.gold + state.rewards.gold,\n                    maxHp: character.maxHp\n                });\n                await tx.character.update({\n                    where: {\n                        id: character.id\n                    },\n                    data: {\n                        gold: levelUp.gold,\n                        currentXp: levelUp.currentXp,\n                        level: levelUp.level,\n                        statPointsAvailable: levelUp.statPointsAvailable,\n                        currentHp: levelUp.currentHp\n                    }\n                });\n                await tx.dungeonRun.delete({\n                    where: {\n                        id: runId\n                    }\n                });\n            } else {\n                // Give gold/xp per boss immediately\n                await tx.character.update({\n                    where: {\n                        id: character.id\n                    },\n                    data: {\n                        gold: {\n                            increment: goldEarned\n                        },\n                        currentXp: {\n                            increment: xpEarned\n                        }\n                    }\n                });\n                await tx.dungeonRun.delete({\n                    where: {\n                        id: runId\n                    }\n                });\n            }\n        });\n        if (dungeonComplete) {\n            await (0,_lib_game_quests__WEBPACK_IMPORTED_MODULE_7__.updateDailyQuestProgress)(character.id, \"dungeons_complete\", 1);\n        }\n        if (dungeonComplete) {\n            return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n                victory: true,\n                dungeonComplete: true,\n                log: result.log,\n                playerSnapshot: result.playerSnapshot,\n                enemySnapshot: result.enemySnapshot,\n                rewards: state.rewards,\n                goldEarned,\n                xpEarned,\n                droppedItem: droppedItem ? {\n                    itemId: newItemId,\n                    rarity: droppedItem.rarity\n                } : null,\n                bossIndex: state.bossIndex,\n                dungeonName: dungeon.name\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n            victory: true,\n            dungeonComplete: false,\n            log: result.log,\n            playerSnapshot: result.playerSnapshot,\n            enemySnapshot: result.enemySnapshot,\n            goldEarned,\n            xpEarned,\n            droppedItem: droppedItem ? {\n                itemId: newItemId,\n                rarity: droppedItem.rarity\n            } : null,\n            bossIndex: state.bossIndex,\n            nextBossIndex,\n            dungeonName: dungeon.name\n        });\n    } catch (error) {\n        console.error(\"[api/dungeons/run/fight POST]\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2R1bmdlb25zL3J1bi9baWRdL2ZpZ2h0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFtRTtBQUNqQztBQUNTO0FBQ3dCO0FBVXZDO0FBQ2lDO0FBR1g7QUFDVztBQUV0RCxlQUFlYyxLQUNwQkMsT0FBZ0IsRUFDaEIsRUFBRUMsTUFBTSxFQUF1QztJQUUvQyxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxNQUFNakIsZ0ZBQTBCQTtRQUNqRCxNQUFNLEVBQ0prQixNQUFNLEVBQUVDLE1BQU1DLFFBQVEsRUFBRSxFQUN6QixHQUFHLE1BQU1ILFNBQVNJLElBQUksQ0FBQ0MsT0FBTztRQUMvQixJQUFJLENBQUNGLFVBQVU7WUFDYixPQUFPbEIscURBQVlBLENBQUNxQixJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZSxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxNQUFNLEVBQUVDLElBQUlDLEtBQUssRUFBRSxHQUFHLE1BQU1YO1FBQzVCLE1BQU1ZLE1BQU0sTUFBTTNCLDJDQUFNQSxDQUFDNEIsVUFBVSxDQUFDQyxTQUFTLENBQUM7WUFDNUNDLE9BQU87Z0JBQUVMLElBQUlDO1lBQU07WUFDbkJLLFNBQVM7Z0JBQUVDLFdBQVc7WUFBSztRQUM3QjtRQUNBLElBQUksQ0FBQ0wsT0FBT0EsSUFBSUssU0FBUyxDQUFDQyxNQUFNLEtBQUtkLFNBQVNNLEVBQUUsRUFBRTtZQUNoRCxPQUFPeEIscURBQVlBLENBQUNxQixJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZ0IsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3JFO1FBRUEsTUFBTVUsUUFBUVAsSUFBSU8sS0FBSztRQUN2QixNQUFNRixZQUFZTCxJQUFJSyxTQUFTO1FBQy9CLE1BQU1HLFVBQVUvQixpRUFBY0EsQ0FBQzhCLE1BQU1FLFNBQVM7UUFDOUMsSUFBSSxDQUFDRCxTQUFTO1lBQ1osT0FBT2xDLHFEQUFZQSxDQUFDcUIsSUFBSSxDQUN0QjtnQkFBRUMs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QUl5RCxpQkFBaUI7WUFDbkIsT0FBT2pGLHFEQUFZQSxDQUFDcUIsSUFBSSxDQUFDO2dCQUN2QnVDLFNBQVM7Z0JBQ1RxQixpQkFBaUI7Z0JBQ2pCcEIsS0FBS0osT0FBT0ksR0FBRztnQkFDZkMsZ0JBQWdCTCxPQUFPSyxjQUFjO2dCQUNyQ0MsZUFBZU4sT0FBT00sYUFBYTtnQkFDbkNVLFNBQVN4QyxNQUFNd0MsT0FBTztnQkFDdEJMO2dCQUNBSTtnQkFDQU0sYUFBYUEsY0FDVDtvQkFBRWlDLFFBQVExQjtvQkFBV04sUUFBUUQsWUFBWUMsTUFBTTtnQkFBQyxJQUNoRDtnQkFDSlIsV0FBV3RDLE1BQU1zQyxTQUFTO2dCQUMxQmtELGFBQWF2RixRQUFRRyxJQUFJO1lBQzNCO1FBQ0Y7UUFFQSxPQUFPckMscURBQVlBLENBQUNxQixJQUFJLENBQUM7WUFDdkJ1QyxTQUFTO1lBQ1RxQixpQkFBaUI7WUFDakJwQixLQUFLSixPQUFPSSxHQUFHO1lBQ2ZDLGdCQUFnQkwsT0FBT0ssY0FBYztZQUNyQ0MsZUFBZU4sT0FBT00sYUFBYTtZQUNuQ0s7WUFDQUk7WUFDQU0sYUFBYUEsY0FDVDtnQkFBRWlDLFFBQVExQjtnQkFBV04sUUFBUUQsWUFBWUMsTUFBTTtZQUFDLElBQ2hEO1lBQ0pSLFdBQVd0QyxNQUFNc0MsU0FBUztZQUMxQlM7WUFDQXlDLGFBQWF2RixRQUFRRyxJQUFJO1FBQzNCO0lBQ0YsRUFBRSxPQUFPZixPQUFPO1FBQ2RvRyxRQUFRcEcsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsT0FBT3RCLHFEQUFZQSxDQUFDcUIsSUFBSSxDQUN0QjtZQUFFQyxPQUFPO1FBQXdCLEdBQ2pDO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vYXBwL2FwaS9kdW5nZW9ucy9ydW4vW2lkXS9maWdodC9yb3V0ZS50cz80Y2JiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IH0gZnJvbSBcIkAvbGliL3N1cGFiYXNlL3NlcnZlclwiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL2RiXCI7XG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHJ1bkNvbWJhdCwgYnVpbGRDb21iYXRhbnRTdGF0ZSB9IGZyb20gXCJAL2xpYi9nYW1lL2NvbWJhdFwiO1xuaW1wb3J0IHR5cGUgeyBEdW5nZW9uUnVuU3RhdGUgfSBmcm9tIFwiQC9hcHAvYXBpL2R1bmdlb25zL3N0YXJ0L3JvdXRlXCI7XG5pbXBvcnQge1xuICBnZXREdW5nZW9uQnlJZCxcbiAgZ2V0Qm9zc1N0YXRzLFxuICBnZXRCb3NzR29sZFJld2FyZCxcbiAgZ2V0Qm9zc1hwUmV3YXJkLFxuICBnZXREdW5nZW9uQ29tcGxldGlvbkJvbnVzLFxuICBCT1NTRVNfUEVSX0RVTkdFT04sXG4gIERVTkdFT05TLFxufSBmcm9tIFwiQC9saWIvZ2FtZS9kdW5nZW9uXCI7XG5pbXBvcnQgeyByb2xsUmFyaXR5LCByb2xsRHJvcENoYW5jZSB9IGZyb20gXCJAL2xpYi9nYW1lL2xvb3RcIjtcbmltcG9ydCB0eXBlIHsgQ2hhcmFjdGVyQ2xhc3MsIENoYXJhY3Rlck9yaWdpbiB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuaW1wb3J0IHsgUmFyaXR5IH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5pbXBvcnQgeyBhcHBseUxldmVsVXAgfSBmcm9tIFwiQC9saWIvZ2FtZS9sZXZlbFVwXCI7XG5pbXBvcnQgeyB1cGRhdGVEYWlseVF1ZXN0UHJvZ3Jlc3MgfSBmcm9tIFwiQC9saWIvZ2FtZS9xdWVzdHNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QoXG4gIHJlcXVlc3Q6IFJlcXVlc3QsXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiBQcm9taXNlPHsgaWQ6IHN0cmluZyB9PiB9XG4pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50KCk7XG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyB1c2VyOiBhdXRoVXNlciB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcbiAgICBpZiAoIWF1dGhVc2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgaWQ6IHJ1bklkIH0gPSBhd2FpdCBwYXJhbXM7XG4gICAgY29uc3QgcnVuID0gYXdhaXQgcHJpc21hLmR1bmdlb25SdW4uZmluZEZpcnN0KHtcbiAgICAgIHdoZXJlOiB7IGlkOiBydW5JZCB9LFxuICAgICAgaW5jbHVkZTogeyBjaGFyYWN0ZXI6IHRydWUgfSxcbiAgICB9KTtcbiAgICBpZiAoIXJ1biB8fCBydW4uY2hhcmFjdGVyLnVzZXJJZCAhPT0gYXV0aFVzZXIuaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlJ1biBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXRlID0gcnVuLnN0YXRlIGFzIHVua25vd24gYXMgRHVuZ2VvblJ1blN0YXRlO1xuICAgIGNvbnN0IGNoYXJhY3RlciA9IHJ1bi5jaGFyYWN0ZXI7XG4gICAgY29uc3QgZHVuZ2VvbiA9IGdldER1bmdlb25CeUlkKHN0YXRlLmR1bmdlb25JZCk7XG4gICAgaWYgKCFkdW5nZW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiRHVuZ2VvbiBkYXRhIG5vdCBmb3VuZFwiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBCdWlsZCBwbGF5ZXIgY29tYmF0YW50XG4gICAgY29uc3QgcGxheWVyU3RhdGUgPSBidWlsZENvbWJhdGFudFN0YXRlKHtcbiAgICAgIGlkOiBjaGFyYWN0ZXIuaWQsXG4gICAgICBuYW1lOiBjaGFyYWN0ZXIuY2hhcmFjdGVyTmFtZSxcbiAgICAgIGNsYXNzOiBjaGFyYWN0ZXIuY2xhc3MgYXMgQ2hhcmFjdGVyQ2xhc3MsXG4gICAgICBvcmlnaW46IGNoYXJhY3Rlci5vcmlnaW4gYXMgQ2hhcmFjdGVyT3JpZ2luLFxuICAgICAgbGV2ZWw6IGNoYXJhY3Rlci5sZXZlbCxcbiAgICAgIHN0cmVuZ3RoOiBjaGFyYWN0ZXIuc3RyZW5ndGgsXG4gICAgICBhZ2lsaXR5OiBjaGFyYWN0ZXIuYWdpbGl0eSxcbiAgICAgIHZpdGFsaXR5OiBjaGFyYWN0ZXIudml0YWxpdHksXG4gICAgICBlbmR1cmFuY2U6IGNoYXJhY3Rlci5lbmR1cmFuY2UsXG4gICAgICBpbnRlbGxpZ2VuY2U6IGNoYXJhY3Rlci5pbnRlbGxpZ2VuY2UsXG4gICAgICB3aXNkb206IGNoYXJhY3Rlci53aXNkb20sXG4gICAgICBsdWNrOiBjaGFyYWN0ZXIubHVjayxcbiAgICAgIGNoYXJpc21hOiBjaGFyYWN0ZXIuY2hhcmlzbWEsXG4gICAgICBhcm1vcjogY2hhcmFjdGVyLmFybW9yLFxuICAgIH0pO1xuXG4gICAgLy8gQnVpbGQgYm9zcyBjb21iYXRhbnRcbiAgICBjb25zdCBicyA9IHN0YXRlLmJvc3NTdGF0cztcbiAgICBjb25zdCBlbmVteVN0YXRlID0gYnVpbGRDb21iYXRhbnRTdGF0ZSh7XG4gICAgICBpZDogXCJib3NzXCIsXG4gICAgICBuYW1lOiBicy5uYW1lLFxuICAgICAgY2xhc3M6IFwid2FycmlvclwiLFxuICAgICAgbGV2ZWw6IGNoYXJhY3Rlci5sZXZlbCxcbiAgICAgIHN0cmVuZ3RoOiBicy5zdHJlbmd0aCxcbiAgICAgIGFnaWxpdHk6IGJzLmFnaWxpdHksXG4gICAgICB2aXRhbGl0eTogYnMudml0YWxpdHksXG4gICAgICBlbmR1cmFuY2U6IGJzLmVuZHVyYW5jZSxcbiAgICAgIGludGVsbGlnZW5jZTogYnMuaW50ZWxsaWdlbmNlLFxuICAgICAgd2lzZG9tOiBicy53aXNkb20sXG4gICAgICBsdWNrOiBicy5sdWNrLFxuICAgICAgY2hhcmlzbWE6IGJzLmNoYXJpc21hLFxuICAgICAgYXJtb3I6IGJzLmFybW9yLFxuICAgIH0pO1xuICAgIGVuZW15U3RhdGUuY3VycmVudEhwID0gc3RhdGUuYm9zc0N1cnJlbnRIcDtcbiAgICBlbmVteVN0YXRlLm1heEhwID0gYnMubWF4SHA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBydW5Db21iYXQocGxheWVyU3RhdGUsIGVuZW15U3RhdGUsIFtdKTtcblxuICAgIC8vIERFRkVBVCDigJQgZGVsZXRlIHJ1biwgcmV0dXJuIHJlc3VsdFxuICAgIGlmIChyZXN1bHQud2lubmVySWQgIT09IGNoYXJhY3Rlci5pZCkge1xuICAgICAgYXdhaXQgcHJpc21hLmR1bmdlb25SdW4uZGVsZXRlKHsgd2hlcmU6IHsgaWQ6IHJ1bklkIH0gfSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICB2aWN0b3J5OiBmYWxzZSxcbiAgICAgICAgbG9nOiByZXN1bHQubG9nLFxuICAgICAgICBwbGF5ZXJTbmFwc2hvdDogcmVzdWx0LnBsYXllclNuYXBzaG90LFxuICAgICAgICBlbmVteVNuYXBzaG90OiByZXN1bHQuZW5lbXlTbmFwc2hvdCxcbiAgICAgICAgbWVzc2FnZTogXCJEZWZlYXRcIixcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFZJQ1RPUlkg4oCUIGNhbGN1bGF0ZSByZXdhcmRzXG4gICAgY29uc3QgZHVuZ2VvbkluZGV4ID0gRFVOR0VPTlMuZmluZEluZGV4KChkKSA9PiBkLmlkID09PSBzdGF0ZS5kdW5nZW9uSWQpO1xuICAgIGNvbnN0IGdvbGRFYXJuZWQgPSBnZXRCb3NzR29sZFJld2FyZChcbiAgICAgIE1hdGgubWF4KDAsIGR1bmdlb25JbmRleCksXG4gICAgICBzdGF0ZS5ib3NzSW5kZXhcbiAgICApO1xuICAgIGNvbnN0IHhwRWFybmVkID0gZ2V0Qm9zc1hwUmV3YXJkKFxuICAgICAgTWF0aC5tYXgoMCwgZHVuZ2VvbkluZGV4KSxcbiAgICAgIHN0YXRlLmJvc3NJbmRleFxuICAgICk7XG5cbiAgICBzdGF0ZS5yZXdhcmRzLmdvbGQgKz0gZ29sZEVhcm5lZDtcbiAgICBzdGF0ZS5yZXdhcmRzLnhwICs9IHhwRWFybmVkO1xuXG4gICAgLy8gTG9vdCByb2xsXG4gICAgY29uc3QgZGlmZmljdWx0eUZvckxvb3QgPVxuICAgICAgZHVuZ2VvbkluZGV4IDw9IDEgPyBcImVhc3lcIiA6IGR1bmdlb25JbmRleCA8PSA0ID8gXCJub3JtYWxcIiA6IFwiaGFyZFwiO1xuICAgIGNvbnN0IGlzQm9zcyA9IHRydWU7XG4gICAgY29uc3QgZHJvcHBlZEl0ZW0gPVxuICAgICAgcm9sbERyb3BDaGFuY2UoZGlmZmljdWx0eUZvckxvb3QsIGlzQm9zcykgJiZcbiAgICAgICgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJhcml0eSA9IHJvbGxSYXJpdHkoY2hhcmFjdGVyLmx1Y2ssIGRpZmZpY3VsdHlGb3JMb290KTtcbiAgICAgICAgcmV0dXJuIHsgcmFyaXR5LCBib3NzSW5kZXg6IHN0YXRlLmJvc3NJbmRleCB9O1xuICAgICAgfSkoKTtcblxuICAgIGNvbnN0IG5leHRCb3NzSW5kZXggPSBzdGF0ZS5ib3NzSW5kZXggKyAxO1xuICAgIGNvbnN0IGR1bmdlb25Db21wbGV0ZSA9IG5leHRCb3NzSW5kZXggPj0gZHVuZ2Vvbi5ib3NzZXMubGVuZ3RoO1xuXG4gICAgLy8gQXBwbHkgY29tcGxldGlvbiBib251c1xuICAgIGlmIChkdW5nZW9uQ29tcGxldGUpIHtcbiAgICAgIGNvbnN0IGJvbnVzID0gZ2V0RHVuZ2VvbkNvbXBsZXRpb25Cb251cyhNYXRoLm1heCgwLCBkdW5nZW9uSW5kZXgpKTtcbiAgICAgIHN0YXRlLnJld2FyZHMuZ29sZCArPSBib251cy5nb2xkO1xuICAgICAgc3RhdGUucmV3YXJkcy54cCArPSBib251cy54cDtcbiAgICB9XG5cbiAgICBsZXQgbmV3SXRlbUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgICAgLy8gSGFuZGxlIGRyb3BwZWQgaXRlbVxuICAgICAgaWYgKGRyb3BwZWRJdGVtKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1MZXZlbCA9IE1hdGgubWF4KFxuICAgICAgICAgIDEsXG4gICAgICAgICAgY2hhcmFjdGVyLmxldmVsICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNikgLSAyXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHJhcml0eSA9IGRyb3BwZWRJdGVtLnJhcml0eSBhcyBSYXJpdHk7XG4gICAgICAgIGxldCBpdGVtID0gYXdhaXQgdHguaXRlbS5maW5kRmlyc3Qoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICByYXJpdHksXG4gICAgICAgICAgICBpdGVtTGV2ZWw6IHsgZ3RlOiBpdGVtTGV2ZWwgLSAxLCBsdGU6IGl0ZW1MZXZlbCArIDEgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgY29uc3Qgc3RhdFJhbmdlOiBSZWNvcmQ8UmFyaXR5LCBbbnVtYmVyLCBudW1iZXJdPiA9IHtcbiAgICAgICAgICAgIGNvbW1vbjogWzUsIDE1XSxcbiAgICAgICAgICAgIHVuY29tbW9uOiBbMTIsIDI1XSxcbiAgICAgICAgICAgIHJhcmU6IFsyMCwgNDVdLFxuICAgICAgICAgICAgZXBpYzogWzQwLCA4MF0sXG4gICAgICAgICAgICBsZWdlbmRhcnk6IFs3NSwgMTUwXSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IFtsbywgaGldID0gc3RhdFJhbmdlW3Jhcml0eV07XG4gICAgICAgICAgY29uc3QgcHJpbWFyeSA9IE1hdGguZmxvb3IobG8gKyBNYXRoLnJhbmRvbSgpICogKGhpIC0gbG8gKyAxKSk7XG4gICAgICAgICAgaXRlbSA9IGF3YWl0IHR4Lml0ZW0uY3JlYXRlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaXRlbU5hbWU6IGAke2R1bmdlb24ubmFtZX0gJHtyYXJpdHl9IExvb3RgLFxuICAgICAgICAgICAgICBpdGVtVHlwZTogXCJ3ZWFwb25cIixcbiAgICAgICAgICAgICAgcmFyaXR5LFxuICAgICAgICAgICAgICBpdGVtTGV2ZWwsXG4gICAgICAgICAgICAgIGJhc2VTdGF0czogeyBzdHJlbmd0aDogcHJpbWFyeSB9LFxuICAgICAgICAgICAgICBidXlQcmljZTpcbiAgICAgICAgICAgICAgICBpdGVtTGV2ZWwgKlxuICAgICAgICAgICAgICAgIDEwICpcbiAgICAgICAgICAgICAgICAocmFyaXR5ID09PSBcImxlZ2VuZGFyeVwiXG4gICAgICAgICAgICAgICAgICA/IDI1XG4gICAgICAgICAgICAgICAgICA6IHJhcml0eSA9PT0gXCJlcGljXCJcbiAgICAgICAgICAgICAgICAgICAgPyAxMFxuICAgICAgICAgICAgICAgICAgICA6IHJhcml0eSA9PT0gXCJyYXJlXCJcbiAgICAgICAgICAgICAgICAgICAgICA/IDRcbiAgICAgICAgICAgICAgICAgICAgICA6IHJhcml0eSA9PT0gXCJ1bmNvbW1vblwiXG4gICAgICAgICAgICAgICAgICAgICAgICA/IDJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogMSksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGludiA9IGF3YWl0IHR4LmVxdWlwbWVudEludmVudG9yeS5jcmVhdGUoe1xuICAgICAgICAgIGRhdGE6IHsgY2hhcmFjdGVySWQ6IGNoYXJhY3Rlci5pZCwgaXRlbUlkOiBpdGVtLmlkIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBuZXdJdGVtSWQgPSBpbnYuaWQ7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSBkdW5nZW9uIHByb2dyZXNzXG4gICAgICBhd2FpdCB0eC5kdW5nZW9uUHJvZ3Jlc3MudXBzZXJ0KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjaGFyYWN0ZXJJZF9kdW5nZW9uSWQ6IHtcbiAgICAgICAgICAgIGNoYXJhY3RlcklkOiBjaGFyYWN0ZXIuaWQsXG4gICAgICAgICAgICBkdW5nZW9uSWQ6IHN0YXRlLmR1bmdlb25JZCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBjaGFyYWN0ZXJJZDogY2hhcmFjdGVyLmlkLFxuICAgICAgICAgIGR1bmdlb25JZDogc3RhdGUuZHVuZ2VvbklkLFxuICAgICAgICAgIGJvc3NJbmRleDogbmV4dEJvc3NJbmRleCxcbiAgICAgICAgICBjb21wbGV0ZWQ6IGR1bmdlb25Db21wbGV0ZSxcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgYm9zc0luZGV4OiBuZXh0Qm9zc0luZGV4LFxuICAgICAgICAgIGNvbXBsZXRlZDogZHVuZ2VvbkNvbXBsZXRlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChkdW5nZW9uQ29tcGxldGUpIHtcbiAgICAgICAgLy8gQXBwbHkgdG90YWwgcmV3YXJkc1xuICAgICAgICBjb25zdCBsZXZlbFVwID0gYXBwbHlMZXZlbFVwKHtcbiAgICAgICAgICBsZXZlbDogY2hhcmFjdGVyLmxldmVsLFxuICAgICAgICAgIGN1cnJlbnRYcDogY2hhcmFjdGVyLmN1cnJlbnRYcCArIHN0YXRlLnJld2FyZHMueHAsXG4gICAgICAgICAgc3RhdFBvaW50c0F2YWlsYWJsZTogY2hhcmFjdGVyLnN0YXRQb2ludHNBdmFpbGFibGUsXG4gICAgICAgICAgZ29sZDogY2hhcmFjdGVyLmdvbGQgKyBzdGF0ZS5yZXdhcmRzLmdvbGQsXG4gICAgICAgICAgbWF4SHA6IGNoYXJhY3Rlci5tYXhIcCxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHR4LmNoYXJhY3Rlci51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBjaGFyYWN0ZXIuaWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnb2xkOiBsZXZlbFVwLmdvbGQsXG4gICAgICAgICAgICBjdXJyZW50WHA6IGxldmVsVXAuY3VycmVudFhwLFxuICAgICAgICAgICAgbGV2ZWw6IGxldmVsVXAubGV2ZWwsXG4gICAgICAgICAgICBzdGF0UG9pbnRzQXZhaWxhYmxlOiBsZXZlbFVwLnN0YXRQb2ludHNBdmFpbGFibGUsXG4gICAgICAgICAgICBjdXJyZW50SHA6IGxldmVsVXAuY3VycmVudEhwLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0eC5kdW5nZW9uUnVuLmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBydW5JZCB9IH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gR2l2ZSBnb2xkL3hwIHBlciBib3NzIGltbWVkaWF0ZWx5XG4gICAgICAgIGF3YWl0IHR4LmNoYXJhY3Rlci51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBjaGFyYWN0ZXIuaWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnb2xkOiB7IGluY3JlbWVudDogZ29sZEVhcm5lZCB9LFxuICAgICAgICAgICAgY3VycmVudFhwOiB7IGluY3JlbWVudDogeHBFYXJuZWQgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdHguZHVuZ2VvblJ1bi5kZWxldGUoeyB3aGVyZTogeyBpZDogcnVuSWQgfSB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChkdW5nZW9uQ29tcGxldGUpIHtcbiAgICAgIGF3YWl0IHVwZGF0ZURhaWx5UXVlc3RQcm9ncmVzcyhjaGFyYWN0ZXIuaWQsIFwiZHVuZ2VvbnNfY29tcGxldGVcIiwgMSk7XG4gICAgfVxuXG4gICAgaWYgKGR1bmdlb25Db21wbGV0ZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgdmljdG9yeTogdHJ1ZSxcbiAgICAgICAgZHVuZ2VvbkNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBsb2c6IHJlc3VsdC5sb2csXG4gICAgICAgIHBsYXllclNuYXBzaG90OiByZXN1bHQucGxheWVyU25hcHNob3QsXG4gICAgICAgIGVuZW15U25hcHNob3Q6IHJlc3VsdC5lbmVteVNuYXBzaG90LFxuICAgICAgICByZXdhcmRzOiBzdGF0ZS5yZXdhcmRzLFxuICAgICAgICBnb2xkRWFybmVkLFxuICAgICAgICB4cEVhcm5lZCxcbiAgICAgICAgZHJvcHBlZEl0ZW06IGRyb3BwZWRJdGVtXG4gICAgICAgICAgPyB7IGl0ZW1JZDogbmV3SXRlbUlkLCByYXJpdHk6IGRyb3BwZWRJdGVtLnJhcml0eSB9XG4gICAgICAgICAgOiBudWxsLFxuICAgICAgICBib3NzSW5kZXg6IHN0YXRlLmJvc3NJbmRleCxcbiAgICAgICAgZHVuZ2Vvbk5hbWU6IGR1bmdlb24ubmFtZSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICB2aWN0b3J5OiB0cnVlLFxuICAgICAgZHVuZ2VvbkNvbXBsZXRlOiBmYWxzZSxcbiAgICAgIGxvZzogcmVzdWx0LmxvZyxcbiAgICAgIHBsYXllclNuYXBzaG90OiByZXN1bHQucGxheWVyU25hcHNob3QsXG4gICAgICBlbmVteVNuYXBzaG90OiByZXN1bHQuZW5lbXlTbmFwc2hvdCxcbiAgICAgIGdvbGRFYXJuZWQsXG4gICAgICB4cEVhcm5lZCxcbiAgICAgIGRyb3BwZWRJdGVtOiBkcm9wcGVkSXRlbVxuICAgICAgICA/IHsgaXRlbUlkOiBuZXdJdGVtSWQsIHJhcml0eTogZHJvcHBlZEl0ZW0ucmFyaXR5IH1cbiAgICAgICAgOiBudWxsLFxuICAgICAgYm9zc0luZGV4OiBzdGF0ZS5ib3NzSW5kZXgsXG4gICAgICBuZXh0Qm9zc0luZGV4LFxuICAgICAgZHVuZ2Vvbk5hbWU6IGR1bmdlb24ubmFtZSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiW2FwaS9kdW5nZW9ucy9ydW4vZmlnaHQgUE9TVF1cIiwgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCIsInByaXNtYSIsIk5leHRSZXNwb25zZSIsInJ1bkNvbWJhdCIsImJ1aWxkQ29tYmF0YW50U3RhdGUiLCJnZXREdW5nZW9uQnlJZCIsImdldEJvc3NHb2xkUmV3YXJkIiwiZ2V0Qm9zc1hwUmV3YXJkIiwiZ2V0RHVuZ2VvbkNvbXBsZXRpb25Cb251cyIsIkRVTkdFT05TIiwicm9sbFJhcml0eSIsInJvbGxEcm9wQ2hhbmNlIiwiYXBwbHlMZXZlbFVwIiwidXBkYXRlRGFpbHlRdWVzdFByb2dyZXNzIiwiUE9TVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiYXV0aFVzZXIiLCJhdXRoIiwiZ2V0VXNlciIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImlkIiwicnVuSWQiLCJydW4iLCJkdW5nZW9uUnVuIiwiZmluZEZpcnN0Iiwid2hlcmUiLCJpbmNsdWRlIiwiY2hhcmFjdGVyIiwidXNlcklkIiwic3RhdGUiLCJkdW5nZW9uIiwiZHVuZ2VvbklkIiwicGxheWVyU3RhdGUiLCJuYW1lIiwiY2hhcmFjdGVyTmFtZSIsImNsYXNzIiwib3JpZ2luIiwibGV2ZWwiLCJzdHJlbmd0aCIsImFnaWxpdHkiLCJ2aXRhbGl0eSIsImVuZHVyYW5jZSIsImludGVsbGlnZW5jZSIsIndpc2RvbSIsImx1Y2siLCJjaGFyaXNtYSIsImFybW9yIiwiYnMiLCJib3NzU3RhdHMiLCJlbmVteVN0YXRlIiwiY3VycmVudEhwIiwiYm9zc0N1cnJlbnRIcCIsIm1heEhwIiwicmVzdWx0Iiwid2lubmVySWQiLCJkZWxldGUiLCJ2aWN0b3J5IiwibG9nIiwicGxheWVyU25hcHNob3QiLCJlbmVteVNuYXBzaG90IiwibWVzc2FnZSIsImR1bmdlb25JbmRleCIsImZpbmRJbmRleCIsImQiLCJnb2xkRWFybmVkIiwiTWF0aCIsIm1heCIsImJvc3NJbmRleCIsInhwRWFybmVkIiwicmV3YXJkcyIsImdvbGQiLCJ4cCIsImRpZmZpY3VsdHlGb3JMb290IiwiaXNCb3NzIiwiZHJvcHBlZEl0ZW0iLCJyYXJpdHkiLCJuZXh0Qm9zc0luZGV4IiwiZHVuZ2VvbkNvbXBsZXRlIiwiYm9zc2VzIiwibGVuZ3RoIiwiYm9udXMiLCJuZXdJdGVtSWQiLCIkdHJhbnNhY3Rpb24iLCJ0eCIsIml0ZW1MZXZlbCIsImZsb29yIiwicmFuZG9tIiwiaXRlbSIsImd0ZSIsImx0ZSIsInN0YXRSYW5nZSIsImNvbW1vbiIsInVuY29tbW9uIiwicmFyZSIsImVwaWMiLCJsZWdlbmRhcnkiLCJsbyIsImhpIiwicHJpbWFyeSIsImNyZWF0ZSIsIml0ZW1OYW1lIiwiaXRlbVR5cGUiLCJiYXNlU3RhdHMiLCJidXlQcmljZSIsImludiIsImVxdWlwbWVudEludmVudG9yeSIsImNoYXJhY3RlcklkIiwiaXRlbUlkIiwiZHVuZ2VvblByb2dyZXNzIiwidXBzZXJ0IiwiY2hhcmFjdGVySWRfZHVuZ2VvbklkIiwiY29tcGxldGVkIiwidXBkYXRlIiwibGV2ZWxVcCIsImN1cnJlbnRYcCIsInN0YXRQb2ludHNBdmFpbGFibGUiLCJpbmNyZW1lbnQiLCJkdW5nZW9uTmFtZSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/dungeons/run/[id]/fight/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThDO0FBRTlDLE1BQU1DLGtCQUFrQkM7QUFFakIsTUFBTUMsU0FDWEYsZ0JBQWdCRSxNQUFNLElBQ3RCLElBQUlILHdEQUFZQSxDQUFDO0lBQ2ZJLEtBQUtDLEtBQXNDLEdBQUc7UUFBQztRQUFTO1FBQVM7S0FBTyxHQUFHLENBQVM7QUFDdEYsR0FBRztBQUVMLElBQUlBLElBQXFDLEVBQUVKLGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL2lyb24tZmlzdC1hcmVuYS8uL2xpYi9kYi50cz8xZGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMgeyBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZCB9O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/P1xuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBbXCJxdWVyeVwiLCBcImVycm9yXCIsIFwid2FyblwiXSA6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/abilities.ts":
/*!*******************************!*\
  !*** ./lib/game/abilities.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ABILITIES: () => (/* binding */ ABILITIES),\n/* harmony export */   getAbilitiesForClass: () => (/* binding */ getAbilitiesForClass),\n/* harmony export */   getAbilityById: () => (/* binding */ getAbilityById)\n/* harmony export */ });\nconst ABILITIES = {\n    warrior: [\n        {\n            id: \"heavy_strike\",\n            name: \"Heavy Strike\",\n            unlockLevel: 5,\n            type: \"physical\",\n            multiplier: 2,\n            status: {\n                chance: 0.15,\n                duration: 1,\n                type: \"stun\"\n            },\n            cooldown: 3\n        },\n        {\n            id: \"battle_cry\",\n            name: \"Battle Cry\",\n            unlockLevel: 10,\n            type: \"buff\",\n            multiplier: 0,\n            selfBuff: {\n                str: 0.3\n            },\n            cooldown: 6\n        },\n        {\n            id: \"whirlwind\",\n            name: \"Whirlwind\",\n            unlockLevel: 15,\n            type: \"physical\",\n            multiplier: 1.5,\n            hits: 2,\n            cooldown: 4\n        },\n        {\n            id: \"titan_slam\",\n            name: \"Titan's Slam\",\n            unlockLevel: 20,\n            type: \"physical\",\n            multiplier: 3.5,\n            armorBreak: 0.5,\n            cooldown: 5\n        }\n    ],\n    rogue: [\n        {\n            id: \"quick_strike\",\n            name: \"Quick Strike\",\n            unlockLevel: 5,\n            type: \"physical\",\n            multiplier: 1.6,\n            critBonus: 20,\n            cooldown: 2\n        },\n        {\n            id: \"shadow_step\",\n            name: \"Shadow Step\",\n            unlockLevel: 10,\n            type: \"buff\",\n            multiplier: 0,\n            dodgeBonus: 50,\n            dodgeBonusTurns: 2,\n            cooldown: 5\n        },\n        {\n            id: \"backstab\",\n            name: \"Backstab\",\n            unlockLevel: 15,\n            type: \"physical\",\n            multiplier: 2.5,\n            firstStrikeOnly: true,\n            cooldown: 3\n        },\n        {\n            id: \"assassinate\",\n            name: \"Assassinate\",\n            unlockLevel: 20,\n            type: \"physical\",\n            multiplier: 4,\n            executeThreshold: 0.3,\n            cooldown: 6\n        }\n    ],\n    mage: [\n        {\n            id: \"fireball\",\n            name: \"Fireball\",\n            unlockLevel: 5,\n            type: \"magic\",\n            multiplier: 2.2,\n            status: {\n                chance: 0.18,\n                duration: 3,\n                type: \"burn\"\n            },\n            cooldown: 2\n        },\n        {\n            id: \"frost_nova\",\n            name: \"Frost Nova\",\n            unlockLevel: 10,\n            type: \"magic\",\n            multiplier: 1.8,\n            status: {\n                chance: 0.25,\n                duration: 2,\n                type: \"slow\"\n            },\n            cooldown: 4\n        },\n        {\n            id: \"lightning_strike\",\n            name: \"Lightning Strike\",\n            unlockLevel: 15,\n            type: \"magic\",\n            multiplier: 2.8,\n            status: {\n                chance: 0.1,\n                duration: 1,\n                type: \"stun\"\n            },\n            cooldown: 3\n        },\n        {\n            id: \"meteor_storm\",\n            name: \"Meteor Storm\",\n            unlockLevel: 20,\n            type: \"magic\",\n            multiplier: 3.8,\n            cooldown: 6\n        }\n    ],\n    tank: [\n        {\n            id: \"shield_bash\",\n            name: \"Shield Bash\",\n            unlockLevel: 5,\n            type: \"physical\",\n            multiplier: 1.4,\n            cooldown: 2\n        },\n        {\n            id: \"iron_wall\",\n            name: \"Iron Wall\",\n            unlockLevel: 10,\n            type: \"buff\",\n            multiplier: 0,\n            selfBuff: {\n                armor: 0.8\n            },\n            cooldown: 6\n        },\n        {\n            id: \"counter_strike\",\n            name: \"Counter Strike\",\n            unlockLevel: 15,\n            type: \"physical\",\n            multiplier: 1.2,\n            cooldown: 4\n        },\n        {\n            id: \"immovable_object\",\n            name: \"Immovable Object\",\n            unlockLevel: 20,\n            type: \"buff\",\n            multiplier: 0,\n            selfBuff: {\n                resist: 0.6\n            },\n            cooldown: 8\n        }\n    ]\n};\nconst getAbilitiesForClass = (cls, level)=>{\n    return ABILITIES[cls].filter((a)=>a.unlockLevel <= level);\n};\nconst getAbilityById = (cls, id)=>ABILITIES[cls].find((a)=>a.id === id);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUIsQ0FBQ0MsS0FBcUJDO0lBQ3hELE9BQU8zQixTQUFTLENBQUMwQixJQUFJLENBQUNFLE1BQU0sQ0FBQyxDQUFDQyxJQUFNQSxFQUFFekIsV0FBVyxJQUFJdUI7QUFDdkQsRUFBRTtBQUVLLE1BQU1HLGlCQUFpQixDQUFDSixLQUFxQnhCLEtBQ2xERixTQUFTLENBQUMwQixJQUFJLENBQUNLLElBQUksQ0FBQyxDQUFDRixJQUFNQSxFQUFFM0IsRUFBRSxLQUFLQSxJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvYWJpbGl0aWVzLnRzP2Y4NTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDaGFyYWN0ZXJDbGFzcyB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWJpbGl0eURlZiB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgdW5sb2NrTGV2ZWw6IG51bWJlcjtcbiAgdHlwZTogXCJwaHlzaWNhbFwiIHwgXCJtYWdpY1wiIHwgXCJidWZmXCI7XG4gIC8qKiBQaHlzaWNhbDogU1RSIG11bHQuIE1hZ2ljOiBJTlQgbXVsdC4gKi9cbiAgbXVsdGlwbGllcjogbnVtYmVyO1xuICAvKiogRm9yIG11bHRpLWhpdCAqL1xuICBoaXRzPzogbnVtYmVyO1xuICAvKiogU3RhdHVzIHRvIGFwcGx5OiBbY2hhbmNlIDAtMSwgZHVyYXRpb24sIHR5cGVdICovXG4gIHN0YXR1cz86IHsgY2hhbmNlOiBudW1iZXI7IGR1cmF0aW9uOiBudW1iZXI7IHR5cGU6IHN0cmluZyB9O1xuICAvKiogU2VsZiBidWZmOiBlLmcuIHsgc3RyOiAwLjMgfSBmb3IgKzMwJSBTVFIgKi9cbiAgc2VsZkJ1ZmY/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAvKiogZS5nLiBhcm1vckJyZWFrOiAwLjUgKi9cbiAgYXJtb3JCcmVhaz86IG51bWJlcjtcbiAgLyoqICtjcml0IGNoYW5jZSBmb3IgdGhpcyBhdHRhY2sgKGFkZGl0aXZlICUpICovXG4gIGNyaXRCb251cz86IG51bWJlcjtcbiAgLyoqIGRvZGdlIGJvbnVzIGZvciBzZWxmIChhZGRpdGl2ZSAlLCBlLmcuIDUwKSAqL1xuICBkb2RnZUJvbnVzPzogbnVtYmVyO1xuICBkb2RnZUJvbnVzVHVybnM/OiBudW1iZXI7XG4gIC8qKiBPbmx5IGlmIGZpcnN0IHN0cmlrZSBpbiByb3VuZCAqL1xuICBmaXJzdFN0cmlrZU9ubHk/OiBib29sZWFuO1xuICAvKiogSWYgdGFyZ2V0IEhQJSA8IHRoaXMsIGF1dG8tY3JpdCAoZS5nLiAwLjMpICovXG4gIGV4ZWN1dGVUaHJlc2hvbGQ/OiBudW1iZXI7XG4gIGNvb2xkb3duOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBBQklMSVRJRVM6IFJlY29yZDxDaGFyYWN0ZXJDbGFzcywgQWJpbGl0eURlZltdPiA9IHtcbiAgd2FycmlvcjogW1xuICAgIHsgaWQ6IFwiaGVhdnlfc3RyaWtlXCIsIG5hbWU6IFwiSGVhdnkgU3RyaWtlXCIsIHVubG9ja0xldmVsOiA1LCB0eXBlOiBcInBoeXNpY2FsXCIsIG11bHRpcGxpZXI6IDIsIHN0YXR1czogeyBjaGFuY2U6IDAuMTUsIGR1cmF0aW9uOiAxLCB0eXBlOiBcInN0dW5cIiB9LCBjb29sZG93bjogMyB9LFxuICAgIHsgaWQ6IFwiYmF0dGxlX2NyeVwiLCBuYW1lOiBcIkJhdHRsZSBDcnlcIiwgdW5sb2NrTGV2ZWw6IDEwLCB0eXBlOiBcImJ1ZmZcIiwgbXVsdGlwbGllcjogMCwgc2VsZkJ1ZmY6IHsgc3RyOiAwLjMgfSwgY29vbGRvd246IDYgfSxcbiAgICB7IGlkOiBcIndoaXJsd2luZFwiLCBuYW1lOiBcIldoaXJsd2luZFwiLCB1bmxvY2tMZXZlbDogMTUsIHR5cGU6IFwicGh5c2ljYWxcIiwgbXVsdGlwbGllcjogMS41LCBoaXRzOiAyLCBjb29sZG93bjogNCB9LFxuICAgIHsgaWQ6IFwidGl0YW5fc2xhbVwiLCBuYW1lOiBcIlRpdGFuJ3MgU2xhbVwiLCB1bmxvY2tMZXZlbDogMjAsIHR5cGU6IFwicGh5c2ljYWxcIiwgbXVsdGlwbGllcjogMy41LCBhcm1vckJyZWFrOiAwLjUsIGNvb2xkb3duOiA1IH0sXG4gIF0sXG4gIHJvZ3VlOiBbXG4gICAgeyBpZDogXCJxdWlja19zdHJpa2VcIiwgbmFtZTogXCJRdWljayBTdHJpa2VcIiwgdW5sb2NrTGV2ZWw6IDUsIHR5cGU6IFwicGh5c2ljYWxcIiwgbXVsdGlwbGllcjogMS42LCBjcml0Qm9udXM6IDIwLCBjb29sZG93bjogMiB9LFxuICAgIHsgaWQ6IFwic2hhZG93X3N0ZXBcIiwgbmFtZTogXCJTaGFkb3cgU3RlcFwiLCB1bmxvY2tMZXZlbDogMTAsIHR5cGU6IFwiYnVmZlwiLCBtdWx0aXBsaWVyOiAwLCBkb2RnZUJvbnVzOiA1MCwgZG9kZ2VCb251c1R1cm5zOiAyLCBjb29sZG93bjogNSB9LFxuICAgIHsgaWQ6IFwiYmFja3N0YWJcIiwgbmFtZTogXCJCYWNrc3RhYlwiLCB1bmxvY2tMZXZlbDogMTUsIHR5cGU6IFwicGh5c2ljYWxcIiwgbXVsdGlwbGllcjogMi41LCBmaXJzdFN0cmlrZU9ubHk6IHRydWUsIGNvb2xkb3duOiAzIH0sXG4gICAgeyBpZDogXCJhc3Nhc3NpbmF0ZVwiLCBuYW1lOiBcIkFzc2Fzc2luYXRlXCIsIHVubG9ja0xldmVsOiAyMCwgdHlwZTogXCJwaHlzaWNhbFwiLCBtdWx0aXBsaWVyOiA0LCBleGVjdXRlVGhyZXNob2xkOiAwLjMsIGNvb2xkb3duOiA2IH0sXG4gIF0sXG4gIG1hZ2U6IFtcbiAgICB7IGlkOiBcImZpcmViYWxsXCIsIG5hbWU6IFwiRmlyZWJhbGxcIiwgdW5sb2NrTGV2ZWw6IDUsIHR5cGU6IFwibWFnaWNcIiwgbXVsdGlwbGllcjogMi4yLCBzdGF0dXM6IHsgY2hhbmNlOiAwLjE4LCBkdXJhdGlvbjogMywgdHlwZTogXCJidXJuXCIgfSwgY29vbGRvd246IDIgfSxcbiAgICB7IGlkOiBcImZyb3N0X25vdmFcIiwgbmFtZTogXCJGcm9zdCBOb3ZhXCIsIHVubG9ja0xldmVsOiAxMCwgdHlwZTogXCJtYWdpY1wiLCBtdWx0aXBsaWVyOiAxLjgsIHN0YXR1czogeyBjaGFuY2U6IDAuMjUsIGR1cmF0aW9uOiAyLCB0eXBlOiBcInNsb3dcIiB9LCBjb29sZG93bjogNCB9LFxuICAgIHsgaWQ6IFwibGlnaHRuaW5nX3N0cmlrZVwiLCBuYW1lOiBcIkxpZ2h0bmluZyBTdHJpa2VcIiwgdW5sb2NrTGV2ZWw6IDE1LCB0eXBlOiBcIm1hZ2ljXCIsIG11bHRpcGxpZXI6IDIuOCwgc3RhdHVzOiB7IGNoYW5jZTogMC4xLCBkdXJhdGlvbjogMSwgdHlwZTogXCJzdHVuXCIgfSwgY29vbGRvd246IDMgfSxcbiAgICB7IGlkOiBcIm1ldGVvcl9zdG9ybVwiLCBuYW1lOiBcIk1ldGVvciBTdG9ybVwiLCB1bmxvY2tMZXZlbDogMjAsIHR5cGU6IFwibWFnaWNcIiwgbXVsdGlwbGllcjogMy44LCBjb29sZG93bjogNiB9LFxuICBdLFxuICB0YW5rOiBbXG4gICAgeyBpZDogXCJzaGllbGRfYmFzaFwiLCBuYW1lOiBcIlNoaWVsZCBCYXNoXCIsIHVubG9ja0xldmVsOiA1LCB0eXBlOiBcInBoeXNpY2FsXCIsIG11bHRpcGxpZXI6IDEuNCwgY29vbGRvd246IDIgfSxcbiAgICB7IGlkOiBcImlyb25fd2FsbFwiLCBuYW1lOiBcIklyb24gV2FsbFwiLCB1bmxvY2tMZXZlbDogMTAsIHR5cGU6IFwiYnVmZlwiLCBtdWx0aXBsaWVyOiAwLCBzZWxmQnVmZjogeyBhcm1vcjogMC44IH0sIGNvb2xkb3duOiA2IH0sXG4gICAgeyBpZDogXCJjb3VudGVyX3N0cmlrZVwiLCBuYW1lOiBcIkNvdW50ZXIgU3RyaWtlXCIsIHVubG9ja0xldmVsOiAxNSwgdHlwZTogXCJwaHlzaWNhbFwiLCBtdWx0aXBsaWVyOiAxLjIsIGNvb2xkb3duOiA0IH0sXG4gICAgeyBpZDogXCJpbW1vdmFibGVfb2JqZWN0XCIsIG5hbWU6IFwiSW1tb3ZhYmxlIE9iamVjdFwiLCB1bmxvY2tMZXZlbDogMjAsIHR5cGU6IFwiYnVmZlwiLCBtdWx0aXBsaWVyOiAwLCBzZWxmQnVmZjogeyByZXNpc3Q6IDAuNiB9LCBjb29sZG93bjogOCB9LFxuICBdLFxufTtcblxuZXhwb3J0IGNvbnN0IGdldEFiaWxpdGllc0ZvckNsYXNzID0gKGNsczogQ2hhcmFjdGVyQ2xhc3MsIGxldmVsOiBudW1iZXIpOiBBYmlsaXR5RGVmW10gPT4ge1xuICByZXR1cm4gQUJJTElUSUVTW2Nsc10uZmlsdGVyKChhKSA9PiBhLnVubG9ja0xldmVsIDw9IGxldmVsKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRBYmlsaXR5QnlJZCA9IChjbHM6IENoYXJhY3RlckNsYXNzLCBpZDogc3RyaW5nKTogQWJpbGl0eURlZiB8IHVuZGVmaW5lZCA9PlxuICBBQklMSVRJRVNbY2xzXS5maW5kKChhKSA9PiBhLmlkID09PSBpZCk7XG4iXSwibmFtZXMiOlsiQUJJTElUSUVTIiwid2FycmlvciIsImlkIiwibmFtZSIsInVubG9ja0xldmVsIiwidHlwZSIsIm11bHRpcGxpZXIiLCJzdGF0dXMiLCJjaGFuY2UiLCJkdXJhdGlvbiIsImNvb2xkb3duIiwic2VsZkJ1ZmYiLCJzdHIiLCJoaXRzIiwiYXJtb3JCcmVhayIsInJvZ3VlIiwiY3JpdEJvbnVzIiwiZG9kZ2VCb251cyIsImRvZGdlQm9udXNUdXJucyIsImZpcnN0U3RyaWtlT25seSIsImV4ZWN1dGVUaHJlc2hvbGQiLCJtYWdlIiwidGFuayIsImFybW9yIiwicmVzaXN0IiwiZ2V0QWJpbGl0aWVzRm9yQ2xhc3MiLCJjbHMiLCJsZXZlbCIsImZpbHRlciIsImEiLCJnZXRBYmlsaXR5QnlJZCIsImZpbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/abilities.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/combat.ts":
/*!****************************!*\
  !*** ./lib/game/combat.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildCombatantState: () => (/* binding */ buildCombatantState),\n/* harmony export */   runCombat: () => (/* binding */ runCombat)\n/* harmony export */ });\n/* harmony import */ var _abilities__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abilities */ \"(rsc)/./lib/game/abilities.ts\");\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stats */ \"(rsc)/./lib/game/stats.ts\");\n/* harmony import */ var _damage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./damage */ \"(rsc)/./lib/game/damage.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./constants */ \"(rsc)/./lib/game/constants.ts\");\n/* harmony import */ var _origins__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./origins */ \"(rsc)/./lib/game/origins.ts\");\n\n\n\n\n\n/** Apply damage to combatant. Returns actual damage dealt. Zero is valid for buffs.\n *  Supports Sewer Shadow \"Cheating Death\" passive — 5% chance to survive at 1 HP. */ const applyDamage = (state, amount)=>{\n    if (amount <= 0) return {\n        actual: 0,\n        cheatedDeath: false\n    };\n    const actual = Math.max(1, Math.floor(amount));\n    const newHp = state.currentHp - actual;\n    if (newHp <= 0 && state.origin && (0,_origins__WEBPACK_IMPORTED_MODULE_4__.hasCheatDeath)(state.origin) && state.currentHp > 1) {\n        const chance = (0,_origins__WEBPACK_IMPORTED_MODULE_4__.getCheatDeathChance)(state.origin);\n        if (Math.random() < chance) {\n            state.currentHp = 1;\n            return {\n                actual: state.currentHp - 1 + actual,\n                cheatedDeath: true\n            };\n        }\n    }\n    state.currentHp = Math.max(0, newHp);\n    return {\n        actual,\n        cheatedDeath: false\n    };\n};\nconst toSnapshot = (s)=>({\n        id: s.id,\n        name: s.name,\n        class: s.class,\n        origin: s.origin,\n        level: s.level,\n        currentHp: s.currentHp,\n        maxHp: s.maxHp,\n        baseStats: {\n            ...s.baseStats\n        }\n    });\n/** Get effective armor considering armor_break status */ const getEffectiveArmor = (state)=>{\n    const hasArmorBreak = state.statusEffects.some((s)=>s.type === \"armor_break\");\n    if (hasArmorBreak) return Math.floor(state.armor * 0.6); // -40% armor per GDD\n    return state.armor;\n};\n/** Get effective dodge chance considering dodge bonus buffs */ const getEffectiveDodge = (state)=>{\n    const dodgeBuff = state.statusEffects.find((s)=>s.type === \"dodge_buff\");\n    return state.derived.dodgeChance + (dodgeBuff?.value ?? 0);\n};\nconst tickStatusEffects = (state, log, turn)=>{\n    const ticks = [];\n    state.statusEffects = state.statusEffects.filter((s)=>{\n        s.duration--;\n        if (s.type === \"bleed\" && s.duration >= 0) {\n            const dmg = Math.max(1, Math.floor(state.maxHp * 0.05));\n            state.currentHp = Math.max(0, state.currentHp - dmg);\n            ticks.push({\n                type: \"bleed\",\n                damage: dmg\n            });\n        }\n        if (s.type === \"poison\" && s.duration >= 0) {\n            const dmg = Math.max(1, Math.floor(state.maxHp * 0.03));\n            state.currentHp = Math.max(0, state.currentHp - dmg);\n            ticks.push({\n                type: \"poison\",\n                damage: dmg\n            });\n        }\n        if (s.type === \"burn\" && s.duration >= 0) {\n            const dmg = Math.max(1, Math.floor(state.maxHp * 0.04));\n            state.currentHp = Math.max(0, state.currentHp - dmg);\n            ticks.push({\n                type: \"burn\",\n                damage: dmg\n            });\n        }\n        if (s.type === \"regen\" && s.duration >= 0) {\n            const heal = Math.max(1, Math.floor(state.maxHp * 0.05));\n            state.currentHp = Math.min(state.maxHp, state.currentHp + heal);\n            ticks.push({\n                type: \"regen\",\n                healed: heal\n            });\n        }\n        return s.duration > 0;\n    });\n    // Clean up expired self-buff status effects (str_buff, dodge_buff, armor_buff, resist_buff)\n    // These are automatically removed by the duration filter above.\n    if (ticks.length > 0 && state.currentHp > 0) {\n        log.push({\n            turn,\n            actorId: state.id,\n            targetId: state.id,\n            action: \"status_tick\",\n            statusTicks: ticks,\n            message: `Effects: ${ticks.map((t)=>t.damage ? `-${t.damage}` : `+${t.healed}`).join(\", \")}`\n        });\n    }\n};\nconst tryApplyStatus = (target, type, duration, resistChance)=>{\n    if (Math.random() * 100 < resistChance) return false;\n    const existing = target.statusEffects.find((s)=>s.type === type);\n    if (existing) existing.duration = Math.max(existing.duration, duration);\n    else target.statusEffects.push({\n        type,\n        duration\n    });\n    return true;\n};\n/** GDD: Resist_Chance_% = (END/10) + (WIS/15), Max 60% */ const getResistChance = (end, wis)=>Math.min(60, end / 10 + wis / 15);\nconst isStunned = (state)=>state.statusEffects.some((s)=>s.type === \"stun\");\n/** Apply self-buff from ability (e.g. Battle Cry +30% STR) */ const applySelfBuff = (caster, ability, log, turnNum)=>{\n    if (!ability.selfBuff) return;\n    const buffMessages = [];\n    for (const [stat, pct] of Object.entries(ability.selfBuff)){\n        if (stat === \"str\" || stat === \"strength\") {\n            // Temporary STR buff stored as status effect with value\n            caster.statusEffects.push({\n                type: \"berserk\",\n                duration: 3,\n                value: Math.floor(caster.baseStats.strength * pct)\n            });\n            caster.baseStats.strength += Math.floor(caster.baseStats.strength * pct);\n            buffMessages.push(`+${Math.round(pct * 100)}% STR`);\n        }\n        if (stat === \"armor\") {\n            caster.statusEffects.push({\n                type: \"regen\",\n                duration: 3,\n                value: Math.floor(caster.armor * pct)\n            });\n            caster.armor += Math.floor(caster.armor * pct);\n            buffMessages.push(`+${Math.round(pct * 100)}% Armor`);\n        }\n        if (stat === \"resist\") {\n            // Resist buff — reduces incoming status chance. Stored as status.\n            caster.statusEffects.push({\n                type: \"weaken\",\n                duration: 3,\n                value: Math.floor(pct * 100)\n            });\n            buffMessages.push(`+${Math.round(pct * 100)}% Resistance`);\n        }\n    }\n    if (ability.dodgeBonus) {\n        const turns = ability.dodgeBonusTurns ?? 2;\n        caster.statusEffects.push({\n            type: \"blind\",\n            duration: turns,\n            value: ability.dodgeBonus\n        });\n        // Temporarily increase dodge\n        caster.derived = {\n            ...caster.derived,\n            dodgeChance: Math.min(40, caster.derived.dodgeChance + ability.dodgeBonus)\n        };\n        buffMessages.push(`+${ability.dodgeBonus}% Dodge for ${turns} turns`);\n    }\n    log.push({\n        turn: turnNum,\n        actorId: caster.id,\n        targetId: caster.id,\n        action: ability.id,\n        message: `${caster.name} uses ${ability.name}: ${buffMessages.join(\", \")}.`\n    });\n};\nconst runCombat = (player, enemy, playerChoices = [])=>{\n    const log = [];\n    let turn = 0;\n    // Track first strike for abilities like Backstab\n    player.isFirstStrike = true;\n    enemy.isFirstStrike = true;\n    /** Stamp HP on a specific log entry (or the last one if not given) */ const stampHp = (actor, target, entry)=>{\n        const e = entry ?? log[log.length - 1];\n        if (!e) return;\n        e.actorHpAfter = actor.currentHp;\n        e.targetHpAfter = target.currentHp;\n    };\n    /** Stamp HP only on entries added since `sinceLength` */ const stampHpSince = (sinceLength, actor, target)=>{\n        for(let i = sinceLength; i < log.length; i++){\n            stampHp(actor, target, log[i]);\n        }\n    };\n    let choiceIndex = 0;\n    const getPlayerAction = ()=>{\n        if (choiceIndex < playerChoices.length) {\n            return playerChoices[choiceIndex++];\n        }\n        const abilities = (0,_abilities__WEBPACK_IMPORTED_MODULE_0__.getAbilitiesForClass)(player.class, player.level);\n        const available = abilities.filter((a)=>(player.abilityCooldowns[a.id] ?? 0) <= 0);\n        if (available.length > 0 && Math.random() < 0.5) {\n            const pick = available[Math.floor(Math.random() * available.length)];\n            return pick.id;\n        }\n        return \"basic\";\n    };\n    const resolveAttack = (attacker, target, action, turnNum)=>{\n        const isBasic = action === \"basic\";\n        let skillMult = 1;\n        let spellMult = 0;\n        let ability;\n        let critBonus = 0;\n        let armorBreakApplied = 0;\n        let statusToApply;\n        let effectiveAction = action;\n        if (!isBasic) {\n            ability = (0,_abilities__WEBPACK_IMPORTED_MODULE_0__.getAbilityById)(attacker.class, action);\n            if (ability && (attacker.abilityCooldowns[ability.id] ?? 0) <= 0) {\n                // FIX: firstStrikeOnly — ability only works if this is attacker's first strike\n                if (ability.firstStrikeOnly && !attacker.isFirstStrike) {\n                    // Fallback to basic attack\n                    skillMult = 1;\n                    ability = undefined;\n                    effectiveAction = \"basic\";\n                } else if (ability.type === \"buff\") {\n                    // FIX: Buff abilities don't deal damage — apply self buff and return\n                    attacker.abilityCooldowns[ability.id] = ability.cooldown;\n                    applySelfBuff(attacker, ability, log, turnNum);\n                    stampHp(attacker, target);\n                    return;\n                } else {\n                    if (ability.type === \"physical\") skillMult = ability.multiplier;\n                    if (ability.type === \"magic\") spellMult = ability.multiplier;\n                    critBonus = ability.critBonus ?? 0;\n                    ability.armorBreak && (armorBreakApplied = ability.armorBreak);\n                    ability.status && (statusToApply = ability.status);\n                    attacker.abilityCooldowns[ability.id] = ability.cooldown;\n                }\n            } else {\n                // Ability on cooldown — fallback to basic\n                skillMult = 1;\n                effectiveAction = \"basic\";\n            }\n        }\n        // Use effective dodge (includes dodge buff)\n        const dodgeChance = getEffectiveDodge(target);\n        const didDodge = (0,_damage__WEBPACK_IMPORTED_MODULE_2__.rollDodge)(dodgeChance);\n        if (didDodge) {\n            log.push({\n                turn: turnNum,\n                actorId: attacker.id,\n                targetId: target.id,\n                action: effectiveAction,\n                dodge: true,\n                message: \"DODGE!\"\n            });\n            stampHp(attacker, target);\n            // Mark first strike consumed\n            attacker.isFirstStrike = false;\n            return;\n        }\n        let damage = 0;\n        const isPhysical = !spellMult || spellMult === 0;\n        const critChance = Math.min(50, attacker.derived.critChance + critBonus);\n        const isCrit = (0,_damage__WEBPACK_IMPORTED_MODULE_2__.rollCrit)(critChance);\n        // Use effective armor (considering armor_break)\n        const effectiveArmor = getEffectiveArmor(target);\n        if (isPhysical && skillMult > 0) {\n            damage = (0,_damage__WEBPACK_IMPORTED_MODULE_2__.calcPhysicalDamage)({\n                attackerStr: attacker.baseStats.strength,\n                defenderEnd: target.baseStats.endurance,\n                defenderArmor: effectiveArmor,\n                skillMultiplier: skillMult,\n                isCrit,\n                critDamageMult: attacker.derived.critDamageMult\n            });\n        } else if (spellMult > 0) {\n            damage = (0,_damage__WEBPACK_IMPORTED_MODULE_2__.calcMagicDamage)({\n                attackerInt: attacker.baseStats.intelligence,\n                defenderWis: target.baseStats.wisdom,\n                spellMultiplier: spellMult,\n                isCrit,\n                critDamageMult: attacker.derived.critDamageMult\n            });\n        }\n        if (ability?.hits) damage *= ability.hits;\n        // FIX: Execute threshold — only apply extra multiplier if NOT already a crit (no double crit)\n        if (ability?.executeThreshold && target.currentHp / target.maxHp < ability.executeThreshold) {\n            if (!isCrit) {\n                damage = Math.floor(damage * attacker.derived.critDamageMult);\n            }\n        // If already crit, execute doesn't stack — damage already includes crit mult\n        }\n        const { actual, cheatedDeath } = applyDamage(target, damage);\n        let message = `${attacker.name} ${effectiveAction === \"basic\" ? \"attacks\" : effectiveAction}: ${actual} damage${isCrit ? \" (crit)\" : \"\"}.`;\n        if (cheatedDeath) {\n            message += ` ${target.name} cheated death! (1 HP)`;\n        }\n        log.push({\n            turn: turnNum,\n            actorId: attacker.id,\n            targetId: target.id,\n            action: effectiveAction,\n            damage: actual,\n            crit: isCrit,\n            message\n        });\n        stampHp(attacker, target);\n        // Mark first strike consumed after first attack\n        attacker.isFirstStrike = false;\n        if (armorBreakApplied > 0) {\n            const reduction = target.armor * armorBreakApplied;\n            target.armor = Math.max(0, Math.floor(target.armor - reduction));\n            // FIX: Pass resist chance directly (higher resist = more chance to resist)\n            tryApplyStatus(target, \"armor_break\", 2, getResistChance(target.baseStats.endurance, target.baseStats.wisdom));\n        }\n        if (statusToApply && Math.random() < statusToApply.chance) {\n            // FIX: Pass resist chance directly (higher resist = more chance to resist)\n            tryApplyStatus(target, statusToApply.type, statusToApply.duration, getResistChance(target.baseStats.endurance, target.baseStats.wisdom));\n        }\n    };\n    const decrementCooldowns = (state)=>{\n        for (const key of Object.keys(state.abilityCooldowns)){\n            state.abilityCooldowns[key] = Math.max(0, state.abilityCooldowns[key] - 1);\n        }\n    };\n    while(turn < _constants__WEBPACK_IMPORTED_MODULE_3__.MAX_TURNS && player.currentHp > 0 && enemy.currentHp > 0){\n        turn++;\n        const lenBeforePlayerTick = log.length;\n        tickStatusEffects(player, log, turn);\n        stampHpSince(lenBeforePlayerTick, player, enemy);\n        const lenBeforeEnemyTick = log.length;\n        tickStatusEffects(enemy, log, turn);\n        stampHpSince(lenBeforeEnemyTick, enemy, player);\n        if (player.currentHp <= 0 || enemy.currentHp <= 0) break;\n        const playerFirst = player.baseStats.agility >= enemy.baseStats.agility;\n        const first = playerFirst ? player : enemy;\n        const second = playerFirst ? enemy : player;\n        decrementCooldowns(player);\n        decrementCooldowns(enemy);\n        if (!isStunned(first)) {\n            const action = first.id === player.id ? getPlayerAction() : \"basic\";\n            resolveAttack(first, second, action, turn);\n        } else {\n            first.statusEffects = first.statusEffects.filter((s)=>s.type !== \"stun\" || s.duration > 1);\n            log.push({\n                turn,\n                actorId: first.id,\n                targetId: first.id,\n                action: \"stun\",\n                message: `${first.name} is stunned.`\n            });\n            stampHp(first, second);\n        }\n        if (second.currentHp <= 0) break;\n        if (!isStunned(second)) {\n            const action = second.id === player.id ? getPlayerAction() : \"basic\";\n            resolveAttack(second, first, action, turn);\n        } else {\n            second.statusEffects = second.statusEffects.filter((s)=>s.type !== \"stun\" || s.duration > 1);\n            log.push({\n                turn,\n                actorId: second.id,\n                targetId: second.id,\n                action: \"stun\",\n                message: `${second.name} is stunned.`\n            });\n            stampHp(second, first);\n        }\n    }\n    let winnerId = null;\n    let loserId = null;\n    let draw = false;\n    if (player.currentHp <= 0 && enemy.currentHp <= 0) {\n        draw = true;\n    } else if (player.currentHp <= 0) {\n        winnerId = enemy.id;\n        loserId = player.id;\n    } else if (enemy.currentHp <= 0) {\n        winnerId = player.id;\n        loserId = enemy.id;\n    } else {\n        const playerHpPct = player.currentHp / player.maxHp;\n        const enemyHpPct = enemy.currentHp / enemy.maxHp;\n        if (playerHpPct > enemyHpPct) {\n            winnerId = player.id;\n            loserId = enemy.id;\n        } else if (enemyHpPct > playerHpPct) {\n            winnerId = enemy.id;\n            loserId = player.id;\n        } else {\n            draw = true;\n        }\n    }\n    return {\n        winnerId,\n        loserId,\n        draw,\n        turns: turn,\n        log,\n        playerSnapshot: toSnapshot(player),\n        enemySnapshot: toSnapshot(enemy)\n    };\n};\n/** Build CombatantState from character-like object and optional display name */ const buildCombatantState = (params)=>{\n    const { id, name, class: cls, origin, level, strength, agility, vitality, endurance, intelligence, wisdom, luck, charisma, armor = 0 } = params;\n    const baseStats = (0,_stats__WEBPACK_IMPORTED_MODULE_1__.getEffectiveStats)({\n        strength,\n        agility,\n        vitality,\n        endurance,\n        intelligence,\n        wisdom,\n        luck,\n        charisma\n    }, origin);\n    const derived = (0,_stats__WEBPACK_IMPORTED_MODULE_1__.computeDerivedStats)(baseStats, armor, 0);\n    const maxHp = derived.maxHp;\n    return {\n        id,\n        name,\n        class: cls,\n        origin,\n        level,\n        baseStats,\n        derived,\n        currentHp: maxHp,\n        maxHp,\n        armor,\n        magicResist: derived.magicResist,\n        statusEffects: [],\n        abilityCooldowns: {}\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLEVBQ1YsR0FBRzZIO0lBRUosTUFBTW5JLFlBQVk1Qix5REFBaUJBLENBQ2pDO1FBQUVnRjtRQUFVb0U7UUFBU2E7UUFBVWhDO1FBQVdLO1FBQWNFO1FBQVEwQjtRQUFNQztJQUFTLEdBQy9Fako7SUFHRixNQUFNb0IsVUFBVXZDLDJEQUFtQkEsQ0FBQzZCLFdBQVdNLE9BQU87SUFDdEQsTUFBTVAsUUFBUVcsUUFBUVgsS0FBSztJQUMzQixPQUFPO1FBQ0xKO1FBQ0FDO1FBQ0FDLE9BQU91STtRQUNQOUk7UUFDQVE7UUFDQUU7UUFDQVU7UUFDQXJCLFdBQVdVO1FBQ1hBO1FBQ0FPO1FBQ0FrSSxhQUFhOUgsUUFBUThILFdBQVc7UUFDaENySSxlQUFlLEVBQUU7UUFDakJ5RSxrQkFBa0IsQ0FBQztJQUNyQjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcm9uLWZpc3QtYXJlbmEvLi9saWIvZ2FtZS9jb21iYXQudHM/NmZiYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7XG4gIENvbWJhdGFudFN0YXRlLFxuICBDb21iYXRhbnRTbmFwc2hvdCxcbiAgQ29tYmF0TG9nRW50cnksXG4gIENvbWJhdFJlc3VsdCxcbiAgU3RhdHVzRWZmZWN0VHlwZSxcbiAgQ2hhcmFjdGVyT3JpZ2luLFxufSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHR5cGUgeyBBYmlsaXR5RGVmIH0gZnJvbSBcIi4vYWJpbGl0aWVzXCI7XG5pbXBvcnQgeyBnZXRBYmlsaXRpZXNGb3JDbGFzcywgZ2V0QWJpbGl0eUJ5SWQgfSBmcm9tIFwiLi9hYmlsaXRpZXNcIjtcbmltcG9ydCB7IGNvbXB1dGVEZXJpdmVkU3RhdHMsIGdldEVmZmVjdGl2ZVN0YXRzIH0gZnJvbSBcIi4vc3RhdHNcIjtcbmltcG9ydCB7IGNhbGNQaHlzaWNhbERhbWFnZSwgY2FsY01hZ2ljRGFtYWdlLCByb2xsQ3JpdCwgcm9sbERvZGdlIH0gZnJvbSBcIi4vZGFtYWdlXCI7XG5pbXBvcnQgeyBNQVhfVFVSTlMgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IGhhc0NoZWF0RGVhdGgsIGdldENoZWF0RGVhdGhDaGFuY2UgfSBmcm9tIFwiLi9vcmlnaW5zXCI7XG5cbi8qKiBBcHBseSBkYW1hZ2UgdG8gY29tYmF0YW50LiBSZXR1cm5zIGFjdHVhbCBkYW1hZ2UgZGVhbHQuIFplcm8gaXMgdmFsaWQgZm9yIGJ1ZmZzLlxuICogIFN1cHBvcnRzIFNld2VyIFNoYWRvdyBcIkNoZWF0aW5nIERlYXRoXCIgcGFzc2l2ZSDigJQgNSUgY2hhbmNlIHRvIHN1cnZpdmUgYXQgMSBIUC4gKi9cbmNvbnN0IGFwcGx5RGFtYWdlID0gKHN0YXRlOiBDb21iYXRhbnRTdGF0ZSwgYW1vdW50OiBudW1iZXIpOiB7IGFjdHVhbDogbnVtYmVyOyBjaGVhdGVkRGVhdGg6IGJvb2xlYW4gfSA9PiB7XG4gIGlmIChhbW91bnQgPD0gMCkgcmV0dXJuIHsgYWN0dWFsOiAwLCBjaGVhdGVkRGVhdGg6IGZhbHNlIH07XG4gIGNvbnN0IGFjdHVhbCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoYW1vdW50KSk7XG4gIGNvbnN0IG5ld0hwID0gc3RhdGUuY3VycmVudEhwIC0gYWN0dWFsO1xuXG4gIGlmIChuZXdIcCA8PSAwICYmIHN0YXRlLm9yaWdpbiAmJiBoYXNDaGVhdERlYXRoKHN0YXRlLm9yaWdpbikgJiYgc3RhdGUuY3VycmVudEhwID4gMSkge1xuICAgIGNvbnN0IGNoYW5jZSA9IGdldENoZWF0RGVhdGhDaGFuY2Uoc3RhdGUub3JpZ2luKTtcbiAgICBpZiAoTWF0aC5yYW5kb20oKSA8IGNoYW5jZSkge1xuICAgICAgc3RhdGUuY3VycmVudEhwID0gMTtcbiAgICAgIHJldHVybiB7IGFjdHVhbDogc3RhdGUuY3VycmVudEhwIC0gMSArIGFjdHVhbCwgY2hlYXRlZERlYXRoOiB0cnVlIH07XG4gICAgfVxuICB9XG5cbiAgc3RhdGUuY3VycmVudEhwID0gTWF0aC5tYXgoMCwgbmV3SHApO1xuICByZXR1cm4geyBhY3R1YWwsIGNoZWF0ZWREZWF0aDogZmFsc2UgfTtcbn07XG5cbmNvbnN0IHRvU25hcHNob3QgPSAoczogQ29tYmF0YW50U3RhdGUpOiBDb21iYXRhbnRTbmFwc2hvdCA9PiAoe1xuICBpZDogcy5pZCxcbiAgbmFtZTogcy5uYW1lLFxuICBjbGFzczogcy5jbGFzcyxcbiAgb3JpZ2luOiBzLm9yaWdpbixcbiAgbGV2ZWw6IHMubGV2ZWwsXG4gIGN1cnJlbnRIcDogcy5jdXJyZW50SHAsXG4gIG1heEhwOiBzLm1heEhwLFxuICBiYXNlU3RhdHM6IHsgLi4ucy5iYXNlU3RhdHMgfSxcbn0pO1xuXG4vKiogR2V0IGVmZmVjdGl2ZSBhcm1vciBjb25zaWRlcmluZyBhcm1vcl9icmVhayBzdGF0dXMgKi9cbmNvbnN0IGdldEVmZmVjdGl2ZUFybW9yID0gKHN0YXRlOiBDb21iYXRhbnRTdGF0ZSk6IG51bWJlciA9PiB7XG4gIGNvbnN0IGhhc0FybW9yQnJlYWsgPSBzdGF0ZS5zdGF0dXNFZmZlY3RzLnNvbWUoKHMpID0+IHMudHlwZSA9PT0gXCJhcm1vcl9icmVha1wiKTtcbiAgaWYgKGhhc0FybW9yQnJlYWspIHJldHVybiBNYXRoLmZsb29yKHN0YXRlLmFybW9yICogMC42KTsgLy8gLTQwJSBhcm1vciBwZXIgR0REXG4gIHJldHVybiBzdGF0ZS5hcm1vcjtcbn07XG5cbi8qKiBHZXQgZWZmZWN0aXZlIGRvZGdlIGNoYW5jZSBjb25zaWRlcmluZyBkb2RnZSBib251cyBidWZmcyAqL1xuY29uc3QgZ2V0RWZmZWN0aXZlRG9kZ2UgPSAoc3RhdGU6IENvbWJhdGFudFN0YXRlKTogbnVtYmVyID0+IHtcbiAgY29uc3QgZG9kZ2VCdWZmID0gc3RhdGUuc3RhdHVzRWZmZWN0cy5maW5kKChzKSA9PiBzLnR5cGUgPT09IFwiZG9kZ2VfYnVmZlwiIGFzIFN0YXR1c0VmZmVjdFR5cGUpO1xuICByZXR1cm4gc3RhdGUuZGVyaXZlZC5kb2RnZUNoYW5jZSArIChkb2RnZUJ1ZmY/LnZhbHVlID8/IDApO1xufTtcblxuY29uc3QgdGlja1N0YXR1c0VmZmVjdHMgPSAoXG4gIHN0YXRlOiBDb21iYXRhbnRTdGF0ZSxcbiAgbG9nOiBDb21iYXRMb2dFbnRyeVtdLFxuICB0dXJuOiBudW1iZXJcbik6IHZvaWQgPT4ge1xuICBjb25zdCB0aWNrczogeyB0eXBlOiBTdGF0dXNFZmZlY3RUeXBlOyBkYW1hZ2U/OiBudW1iZXI7IGhlYWxlZD86IG51bWJlciB9W10gPSBbXTtcbiAgc3RhdGUuc3RhdHVzRWZmZWN0cyA9IHN0YXRlLnN0YXR1c0VmZmVjdHMuZmlsdGVyKChzKSA9PiB7XG4gICAgcy5kdXJhdGlvbi0tO1xuICAgIGlmIChzLnR5cGUgPT09IFwiYmxlZWRcIiAmJiBzLmR1cmF0aW9uID49IDApIHtcbiAgICAgIGNvbnN0IGRtZyA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3Ioc3RhdGUubWF4SHAgKiAwLjA1KSk7XG4gICAgICBzdGF0ZS5jdXJyZW50SHAgPSBNYXRoLm1heCgwLCBzdGF0ZS5jdXJyZW50SHAgLSBkbWcpO1xuICAgICAgdGlja3MucHVzaCh7IHR5cGU6IFwiYmxlZWRcIiwgZGFtYWdlOiBkbWcgfSk7XG4gICAgfVxuICAgIGlmIChzLnR5cGUgPT09IFwicG9pc29uXCIgJiYgcy5kdXJhdGlvbiA+PSAwKSB7XG4gICAgICBjb25zdCBkbWcgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKHN0YXRlLm1heEhwICogMC4wMykpO1xuICAgICAgc3RhdGUuY3VycmVudEhwID0gTWF0aC5tYXgoMCwgc3RhdGUuY3VycmVudEhwIC0gZG1nKTtcbiAgICAgIHRpY2tzLnB1c2goeyB0eXBlOiBcInBvaXNvblwiLCBkYW1hZ2U6IGRtZyB9KTtcbiAgICB9XG4gICAgaWYgKHMudHlwZSA9PT0gXCJidXJuXCIgJiYgcy5kdXJhdGlvbiA+PSAwKSB7XG4gICAgICBjb25zdCBkbWcgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKHN0YXRlLm1heEhwICogMC4wNCkpO1xuICAgICAgc3RhdGUuY3VycmVudEhwID0gTWF0aC5tYXgoMCwgc3RhdGUuY3VycmVudEhwIC0gZG1nKTtcbiAgICAgIHRpY2tzLnB1c2goeyB0eXBlOiBcImJ1cm5cIiwgZGFtYWdlOiBkbWcgfSk7XG4gICAgfVxuICAgIGlmIChzLnR5cGUgPT09IFwicmVnZW5cIiAmJiBzLmR1cmF0aW9uID49IDApIHtcbiAgICAgIGNvbnN0IGhlYWwgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKHN0YXRlLm1heEhwICogMC4wNSkpO1xuICAgICAgc3RhdGUuY3VycmVudEhwID0gTWF0aC5taW4oc3RhdGUubWF4SHAsIHN0YXRlLmN1cnJlbnRIcCArIGhlYWwpO1xuICAgICAgdGlja3MucHVzaCh7IHR5cGU6IFwicmVnZW5cIiwgaGVhbGVkOiBoZWFsIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcy5kdXJhdGlvbiA+IDA7XG4gIH0pO1xuXG4gIC8vIENsZWFuIHVwIGV4cGlyZWQgc2VsZi1idWZmIHN0YXR1cyBlZmZlY3RzIChzdHJfYnVmZiwgZG9kZ2VfYnVmZiwgYXJtb3JfYnVmZiwgcmVzaXN0X2J1ZmYpXG4gIC8vIFRoZXNlIGFyZSBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgYnkgdGhlIGR1cmF0aW9uIGZpbHRlciBhYm92ZS5cblxuICBpZiAodGlja3MubGVuZ3RoID4gMCAmJiBzdGF0ZS5jdXJyZW50SHAgPiAwKSB7XG4gICAgbG9nLnB1c2goe1xuICAgICAgdHVybixcbiAgICAgIGFjdG9ySWQ6IHN0YXRlLmlkLFxuICAgICAgdGFyZ2V0SWQ6IHN0YXRlLmlkLFxuICAgICAgYWN0aW9uOiBcInN0YXR1c190aWNrXCIsXG4gICAgICBzdGF0dXNUaWNrczogdGlja3MsXG4gICAgICBtZXNzYWdlOiBgRWZmZWN0czogJHt0aWNrcy5tYXAoKHQpID0+ICh0LmRhbWFnZSA/IGAtJHt0LmRhbWFnZX1gIDogYCske3QuaGVhbGVkfWApKS5qb2luKFwiLCBcIil9YCxcbiAgICB9KTtcbiAgfVxufTtcblxuY29uc3QgdHJ5QXBwbHlTdGF0dXMgPSAoXG4gIHRhcmdldDogQ29tYmF0YW50U3RhdGUsXG4gIHR5cGU6IFN0YXR1c0VmZmVjdFR5cGUsXG4gIGR1cmF0aW9uOiBudW1iZXIsXG4gIHJlc2lzdENoYW5jZTogbnVtYmVyXG4pOiBib29sZWFuID0+IHtcbiAgaWYgKE1hdGgucmFuZG9tKCkgKiAxMDAgPCByZXNpc3RDaGFuY2UpIHJldHVybiBmYWxzZTtcbiAgY29uc3QgZXhpc3RpbmcgPSB0YXJnZXQuc3RhdHVzRWZmZWN0cy5maW5kKChzKSA9PiBzLnR5cGUgPT09IHR5cGUpO1xuICBpZiAoZXhpc3RpbmcpIGV4aXN0aW5nLmR1cmF0aW9uID0gTWF0aC5tYXgoZXhpc3RpbmcuZHVyYXRpb24sIGR1cmF0aW9uKTtcbiAgZWxzZSB0YXJnZXQuc3RhdHVzRWZmZWN0cy5wdXNoKHsgdHlwZSwgZHVyYXRpb24gfSk7XG4gIHJldHVybiB0cnVlO1xufTtcblxuLyoqIEdERDogUmVzaXN0X0NoYW5jZV8lID0gKEVORC8xMCkgKyAoV0lTLzE1KSwgTWF4IDYwJSAqL1xuY29uc3QgZ2V0UmVzaXN0Q2hhbmNlID0gKGVuZDogbnVtYmVyLCB3aXM6IG51bWJlcik6IG51bWJlciA9PlxuICBNYXRoLm1pbig2MCwgZW5kIC8gMTAgKyB3aXMgLyAxNSk7XG5cbmNvbnN0IGlzU3R1bm5lZCA9IChzdGF0ZTogQ29tYmF0YW50U3RhdGUpOiBib29sZWFuID0+XG4gIHN0YXRlLnN0YXR1c0VmZmVjdHMuc29tZSgocykgPT4gcy50eXBlID09PSBcInN0dW5cIik7XG5cbi8qKiBBcHBseSBzZWxmLWJ1ZmYgZnJvbSBhYmlsaXR5IChlLmcuIEJhdHRsZSBDcnkgKzMwJSBTVFIpICovXG5jb25zdCBhcHBseVNlbGZCdWZmID0gKFxuICBjYXN0ZXI6IENvbWJhdGFudFN0YXRlLFxuICBhYmlsaXR5OiBBYmlsaXR5RGVmLFxuICBsb2c6IENvbWJhdExvZ0VudHJ5W10sXG4gIHR1cm5OdW06IG51bWJlclxuKTogdm9pZCA9PiB7XG4gIGlmICghYWJpbGl0eS5zZWxmQnVmZikgcmV0dXJuO1xuXG4gIGNvbnN0IGJ1ZmZNZXNzYWdlczogc3RyaW5nW10gPSBbXTtcblxuICBmb3IgKGNvbnN0IFtzdGF0LCBwY3RdIG9mIE9iamVjdC5lbnRyaWVzKGFiaWxpdHkuc2VsZkJ1ZmYpKSB7XG4gICAgaWYgKHN0YXQgPT09IFwic3RyXCIgfHwgc3RhdCA9PT0gXCJzdHJlbmd0aFwiKSB7XG4gICAgICAvLyBUZW1wb3JhcnkgU1RSIGJ1ZmYgc3RvcmVkIGFzIHN0YXR1cyBlZmZlY3Qgd2l0aCB2YWx1ZVxuICAgICAgY2FzdGVyLnN0YXR1c0VmZmVjdHMucHVzaCh7XG4gICAgICAgIHR5cGU6IFwiYmVyc2Vya1wiIGFzIFN0YXR1c0VmZmVjdFR5cGUsIC8vIHJldXNlIGJlcnNlcmsgYXMgU1RSIGJ1ZmYgbWFya2VyXG4gICAgICAgIGR1cmF0aW9uOiAzLFxuICAgICAgICB2YWx1ZTogTWF0aC5mbG9vcihjYXN0ZXIuYmFzZVN0YXRzLnN0cmVuZ3RoICogcGN0KSxcbiAgICAgIH0pO1xuICAgICAgY2FzdGVyLmJhc2VTdGF0cy5zdHJlbmd0aCArPSBNYXRoLmZsb29yKGNhc3Rlci5iYXNlU3RhdHMuc3RyZW5ndGggKiBwY3QpO1xuICAgICAgYnVmZk1lc3NhZ2VzLnB1c2goYCske01hdGgucm91bmQocGN0ICogMTAwKX0lIFNUUmApO1xuICAgIH1cbiAgICBpZiAoc3RhdCA9PT0gXCJhcm1vclwiKSB7XG4gICAgICBjYXN0ZXIuc3RhdHVzRWZmZWN0cy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJyZWdlblwiIGFzIFN0YXR1c0VmZmVjdFR5cGUsIC8vIGFybW9yIGJ1ZmYgbWFya2VyIOKAlCBzZXBhcmF0ZSBmcm9tIGhlYWwgcmVnZW5cbiAgICAgICAgZHVyYXRpb246IDMsXG4gICAgICAgIHZhbHVlOiBNYXRoLmZsb29yKGNhc3Rlci5hcm1vciAqIHBjdCksXG4gICAgICB9KTtcbiAgICAgIGNhc3Rlci5hcm1vciArPSBNYXRoLmZsb29yKGNhc3Rlci5hcm1vciAqIHBjdCk7XG4gICAgICBidWZmTWVzc2FnZXMucHVzaChgKyR7TWF0aC5yb3VuZChwY3QgKiAxMDApfSUgQXJtb3JgKTtcbiAgICB9XG4gICAgaWYgKHN0YXQgPT09IFwicmVzaXN0XCIpIHtcbiAgICAgIC8vIFJlc2lzdCBidWZmIOKAlCByZWR1Y2VzIGluY29taW5nIHN0YXR1cyBjaGFuY2UuIFN0b3JlZCBhcyBzdGF0dXMuXG4gICAgICBjYXN0ZXIuc3RhdHVzRWZmZWN0cy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJ3ZWFrZW5cIiBhcyBTdGF0dXNFZmZlY3RUeXBlLCAvLyByZXVzZSB3ZWFrZW4gc2xvdCBmb3IgcmVzaXN0IGJ1ZmYgb24gc2VsZlxuICAgICAgICBkdXJhdGlvbjogMyxcbiAgICAgICAgdmFsdWU6IE1hdGguZmxvb3IocGN0ICogMTAwKSwgLy8gc3RvcmUgYXMgcGVyY2VudGFnZVxuICAgICAgfSk7XG4gICAgICBidWZmTWVzc2FnZXMucHVzaChgKyR7TWF0aC5yb3VuZChwY3QgKiAxMDApfSUgUmVzaXN0YW5jZWApO1xuICAgIH1cbiAgfVxuXG4gIGlmIChhYmlsaXR5LmRvZGdlQm9udXMpIHtcbiAgICBjb25zdCB0dXJucyA9IGFiaWxpdHkuZG9kZ2VCb251c1R1cm5zID8/IDI7XG4gICAgY2FzdGVyLnN0YXR1c0VmZmVjdHMucHVzaCh7XG4gICAgICB0eXBlOiBcImJsaW5kXCIgYXMgU3RhdHVzRWZmZWN0VHlwZSwgLy8gcmV1c2UgYmxpbmQgc2xvdCBhcyBkb2RnZSBidWZmIG9uIHNlbGZcbiAgICAgIGR1cmF0aW9uOiB0dXJucyxcbiAgICAgIHZhbHVlOiBhYmlsaXR5LmRvZGdlQm9udXMsXG4gICAgfSk7XG4gICAgLy8gVGVtcG9yYXJpbHkgaW5jcmVhc2UgZG9kZ2VcbiAgICBjYXN0ZXIuZGVyaXZlZCA9IHtcbiAgICAgIC4uLmNhc3Rlci5kZXJpdmVkLFxuICAgICAgZG9kZ2VDaGFuY2U6IE1hdGgubWluKDQwLCBjYXN0ZXIuZGVyaXZlZC5kb2RnZUNoYW5jZSArIGFiaWxpdHkuZG9kZ2VCb251cyksXG4gICAgfTtcbiAgICBidWZmTWVzc2FnZXMucHVzaChgKyR7YWJpbGl0eS5kb2RnZUJvbnVzfSUgRG9kZ2UgZm9yICR7dHVybnN9IHR1cm5zYCk7XG4gIH1cblxuICBsb2cucHVzaCh7XG4gICAgdHVybjogdHVybk51bSxcbiAgICBhY3RvcklkOiBjYXN0ZXIuaWQsXG4gICAgdGFyZ2V0SWQ6IGNhc3Rlci5pZCxcbiAgICBhY3Rpb246IGFiaWxpdHkuaWQsXG4gICAgbWVzc2FnZTogYCR7Y2FzdGVyLm5hbWV9IHVzZXMgJHthYmlsaXR5Lm5hbWV9OiAke2J1ZmZNZXNzYWdlcy5qb2luKFwiLCBcIil9LmAsXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IHJ1bkNvbWJhdCA9IChcbiAgcGxheWVyOiBDb21iYXRhbnRTdGF0ZSxcbiAgZW5lbXk6IENvbWJhdGFudFN0YXRlLFxuICBwbGF5ZXJDaG9pY2VzOiAoXCJiYXNpY1wiIHwgc3RyaW5nKVtdID0gW11cbik6IENvbWJhdFJlc3VsdCA9PiB7XG4gIGNvbnN0IGxvZzogQ29tYmF0TG9nRW50cnlbXSA9IFtdO1xuICBsZXQgdHVybiA9IDA7XG5cbiAgLy8gVHJhY2sgZmlyc3Qgc3RyaWtlIGZvciBhYmlsaXRpZXMgbGlrZSBCYWNrc3RhYlxuICBwbGF5ZXIuaXNGaXJzdFN0cmlrZSA9IHRydWU7XG4gIGVuZW15LmlzRmlyc3RTdHJpa2UgPSB0cnVlO1xuXG4gIC8qKiBTdGFtcCBIUCBvbiBhIHNwZWNpZmljIGxvZyBlbnRyeSAob3IgdGhlIGxhc3Qgb25lIGlmIG5vdCBnaXZlbikgKi9cbiAgY29uc3Qgc3RhbXBIcCA9IChhY3RvcjogQ29tYmF0YW50U3RhdGUsIHRhcmdldDogQ29tYmF0YW50U3RhdGUsIGVudHJ5PzogQ29tYmF0TG9nRW50cnkpOiB2b2lkID0+IHtcbiAgICBjb25zdCBlID0gZW50cnkgPz8gbG9nW2xvZy5sZW5ndGggLSAxXTtcbiAgICBpZiAoIWUpIHJldHVybjtcbiAgICBlLmFjdG9ySHBBZnRlciA9IGFjdG9yLmN1cnJlbnRIcDtcbiAgICBlLnRhcmdldEhwQWZ0ZXIgPSB0YXJnZXQuY3VycmVudEhwO1xuICB9O1xuXG4gIC8qKiBTdGFtcCBIUCBvbmx5IG9uIGVudHJpZXMgYWRkZWQgc2luY2UgYHNpbmNlTGVuZ3RoYCAqL1xuICBjb25zdCBzdGFtcEhwU2luY2UgPSAoc2luY2VMZW5ndGg6IG51bWJlciwgYWN0b3I6IENvbWJhdGFudFN0YXRlLCB0YXJnZXQ6IENvbWJhdGFudFN0YXRlKTogdm9pZCA9PiB7XG4gICAgZm9yIChsZXQgaSA9IHNpbmNlTGVuZ3RoOyBpIDwgbG9nLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdGFtcEhwKGFjdG9yLCB0YXJnZXQsIGxvZ1tpXSk7XG4gICAgfVxuICB9O1xuXG4gIGxldCBjaG9pY2VJbmRleCA9IDA7XG4gIGNvbnN0IGdldFBsYXllckFjdGlvbiA9ICgpOiBcImJhc2ljXCIgfCBzdHJpbmcgPT4ge1xuICAgIGlmIChjaG9pY2VJbmRleCA8IHBsYXllckNob2ljZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gcGxheWVyQ2hvaWNlc1tjaG9pY2VJbmRleCsrXSBhcyBcImJhc2ljXCIgfCBzdHJpbmc7XG4gICAgfVxuICAgIGNvbnN0IGFiaWxpdGllcyA9IGdldEFiaWxpdGllc0ZvckNsYXNzKHBsYXllci5jbGFzcywgcGxheWVyLmxldmVsKTtcbiAgICBjb25zdCBhdmFpbGFibGUgPSBhYmlsaXRpZXMuZmlsdGVyKFxuICAgICAgKGEpID0+IChwbGF5ZXIuYWJpbGl0eUNvb2xkb3duc1thLmlkXSA/PyAwKSA8PSAwXG4gICAgKTtcbiAgICBpZiAoYXZhaWxhYmxlLmxlbmd0aCA+IDAgJiYgTWF0aC5yYW5kb20oKSA8IDAuNSkge1xuICAgICAgY29uc3QgcGljayA9IGF2YWlsYWJsZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhdmFpbGFibGUubGVuZ3RoKV07XG4gICAgICByZXR1cm4gcGljay5pZDtcbiAgICB9XG4gICAgcmV0dXJuIFwiYmFzaWNcIjtcbiAgfTtcblxuICBjb25zdCByZXNvbHZlQXR0YWNrID0gKFxuICAgIGF0dGFja2VyOiBDb21iYXRhbnRTdGF0ZSxcbiAgICB0YXJnZXQ6IENvbWJhdGFudFN0YXRlLFxuICAgIGFjdGlvbjogXCJiYXNpY1wiIHwgc3RyaW5nLFxuICAgIHR1cm5OdW06IG51bWJlclxuICApOiB2b2lkID0+IHtcbiAgICBjb25zdCBpc0Jhc2ljID0gYWN0aW9uID09PSBcImJhc2ljXCI7XG4gICAgbGV0IHNraWxsTXVsdCA9IDE7XG4gICAgbGV0IHNwZWxsTXVsdCA9IDA7XG4gICAgbGV0IGFiaWxpdHk6IEFiaWxpdHlEZWYgfCB1bmRlZmluZWQ7XG4gICAgbGV0IGNyaXRCb251cyA9IDA7XG4gICAgbGV0IGFybW9yQnJlYWtBcHBsaWVkID0gMDtcbiAgICBsZXQgc3RhdHVzVG9BcHBseTogeyBjaGFuY2U6IG51bWJlcjsgZHVyYXRpb246IG51bWJlcjsgdHlwZTogc3RyaW5nIH0gfCB1bmRlZmluZWQ7XG5cbiAgICBsZXQgZWZmZWN0aXZlQWN0aW9uOiBzdHJpbmcgPSBhY3Rpb247XG5cbiAgICBpZiAoIWlzQmFzaWMpIHtcbiAgICAgIGFiaWxpdHkgPSBnZXRBYmlsaXR5QnlJZChhdHRhY2tlci5jbGFzcywgYWN0aW9uKTtcbiAgICAgIGlmIChhYmlsaXR5ICYmIChhdHRhY2tlci5hYmlsaXR5Q29vbGRvd25zW2FiaWxpdHkuaWRdID8/IDApIDw9IDApIHtcbiAgICAgICAgLy8gRklYOiBmaXJzdFN0cmlrZU9ubHkg4oCUIGFiaWxpdHkgb25seSB3b3JrcyBpZiB0aGlzIGlzIGF0dGFja2VyJ3MgZmlyc3Qgc3RyaWtlXG4gICAgICAgIGlmIChhYmlsaXR5LmZpcnN0U3RyaWtlT25seSAmJiAhYXR0YWNrZXIuaXNGaXJzdFN0cmlrZSkge1xuICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIGJhc2ljIGF0dGFja1xuICAgICAgICAgIHNraWxsTXVsdCA9IDE7XG4gICAgICAgICAgYWJpbGl0eSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBlZmZlY3RpdmVBY3Rpb24gPSBcImJhc2ljXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoYWJpbGl0eS50eXBlID09PSBcImJ1ZmZcIikge1xuICAgICAgICAgIC8vIEZJWDogQnVmZiBhYmlsaXRpZXMgZG9uJ3QgZGVhbCBkYW1hZ2Ug4oCUIGFwcGx5IHNlbGYgYnVmZiBhbmQgcmV0dXJuXG4gICAgICAgICAgYXR0YWNrZXIuYWJpbGl0eUNvb2xkb3duc1thYmlsaXR5LmlkXSA9IGFiaWxpdHkuY29vbGRvd247XG4gICAgICAgICAgYXBwbHlTZWxmQnVmZihhdHRhY2tlciwgYWJpbGl0eSwgbG9nLCB0dXJuTnVtKTtcbiAgICAgICAgICBzdGFtcEhwKGF0dGFja2VyLCB0YXJnZXQpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoYWJpbGl0eS50eXBlID09PSBcInBoeXNpY2FsXCIpIHNraWxsTXVsdCA9IGFiaWxpdHkubXVsdGlwbGllcjtcbiAgICAgICAgICBpZiAoYWJpbGl0eS50eXBlID09PSBcIm1hZ2ljXCIpIHNwZWxsTXVsdCA9IGFiaWxpdHkubXVsdGlwbGllcjtcbiAgICAgICAgICBjcml0Qm9udXMgPSBhYmlsaXR5LmNyaXRCb251cyA/PyAwO1xuICAgICAgICAgIGFiaWxpdHkuYXJtb3JCcmVhayAmJiAoYXJtb3JCcmVha0FwcGxpZWQgPSBhYmlsaXR5LmFybW9yQnJlYWspO1xuICAgICAgICAgIGFiaWxpdHkuc3RhdHVzICYmIChzdGF0dXNUb0FwcGx5ID0gYWJpbGl0eS5zdGF0dXMpO1xuICAgICAgICAgIGF0dGFja2VyLmFiaWxpdHlDb29sZG93bnNbYWJpbGl0eS5pZF0gPSBhYmlsaXR5LmNvb2xkb3duO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBYmlsaXR5IG9uIGNvb2xkb3duIOKAlCBmYWxsYmFjayB0byBiYXNpY1xuICAgICAgICBza2lsbE11bHQgPSAxO1xuICAgICAgICBlZmZlY3RpdmVBY3Rpb24gPSBcImJhc2ljXCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXNlIGVmZmVjdGl2ZSBkb2RnZSAoaW5jbHVkZXMgZG9kZ2UgYnVmZilcbiAgICBjb25zdCBkb2RnZUNoYW5jZSA9IGdldEVmZmVjdGl2ZURvZGdlKHRhcmdldCk7XG4gICAgY29uc3QgZGlkRG9kZ2UgPSByb2xsRG9kZ2UoZG9kZ2VDaGFuY2UpO1xuICAgIGlmIChkaWREb2RnZSkge1xuICAgICAgbG9nLnB1c2goe1xuICAgICAgICB0dXJuOiB0dXJuTnVtLFxuICAgICAgICBhY3RvcklkOiBhdHRhY2tlci5pZCxcbiAgICAgICAgdGFyZ2V0SWQ6IHRhcmdldC5pZCxcbiAgICAgICAgYWN0aW9uOiBlZmZlY3RpdmVBY3Rpb24sXG4gICAgICAgIGRvZGdlOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIkRPREdFIVwiLFxuICAgICAgfSk7XG4gICAgICBzdGFtcEhwKGF0dGFja2VyLCB0YXJnZXQpO1xuICAgICAgLy8gTWFyayBmaXJzdCBzdHJpa2UgY29uc3VtZWRcbiAgICAgIGF0dGFja2VyLmlzRmlyc3RTdHJpa2UgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgZGFtYWdlID0gMDtcbiAgICBjb25zdCBpc1BoeXNpY2FsID0gIXNwZWxsTXVsdCB8fCBzcGVsbE11bHQgPT09IDA7XG4gICAgY29uc3QgY3JpdENoYW5jZSA9IE1hdGgubWluKDUwLCBhdHRhY2tlci5kZXJpdmVkLmNyaXRDaGFuY2UgKyBjcml0Qm9udXMpO1xuICAgIGNvbnN0IGlzQ3JpdCA9IHJvbGxDcml0KGNyaXRDaGFuY2UpO1xuXG4gICAgLy8gVXNlIGVmZmVjdGl2ZSBhcm1vciAoY29uc2lkZXJpbmcgYXJtb3JfYnJlYWspXG4gICAgY29uc3QgZWZmZWN0aXZlQXJtb3IgPSBnZXRFZmZlY3RpdmVBcm1vcih0YXJnZXQpO1xuXG4gICAgaWYgKGlzUGh5c2ljYWwgJiYgc2tpbGxNdWx0ID4gMCkge1xuICAgICAgZGFtYWdlID0gY2FsY1BoeXNpY2FsRGFtYWdlKHtcbiAgICAgICAgYXR0YWNrZXJTdHI6IGF0dGFja2VyLmJhc2VTdGF0cy5zdHJlbmd0aCxcbiAgICAgICAgZGVmZW5kZXJFbmQ6IHRhcmdldC5iYXNlU3RhdHMuZW5kdXJhbmNlLFxuICAgICAgICBkZWZlbmRlckFybW9yOiBlZmZlY3RpdmVBcm1vcixcbiAgICAgICAgc2tpbGxNdWx0aXBsaWVyOiBza2lsbE11bHQsXG4gICAgICAgIGlzQ3JpdCxcbiAgICAgICAgY3JpdERhbWFnZU11bHQ6IGF0dGFja2VyLmRlcml2ZWQuY3JpdERhbWFnZU11bHQsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHNwZWxsTXVsdCA+IDApIHtcbiAgICAgIGRhbWFnZSA9IGNhbGNNYWdpY0RhbWFnZSh7XG4gICAgICAgIGF0dGFja2VySW50OiBhdHRhY2tlci5iYXNlU3RhdHMuaW50ZWxsaWdlbmNlLFxuICAgICAgICBkZWZlbmRlcldpczogdGFyZ2V0LmJhc2VTdGF0cy53aXNkb20sXG4gICAgICAgIHNwZWxsTXVsdGlwbGllcjogc3BlbGxNdWx0LFxuICAgICAgICBpc0NyaXQsXG4gICAgICAgIGNyaXREYW1hZ2VNdWx0OiBhdHRhY2tlci5kZXJpdmVkLmNyaXREYW1hZ2VNdWx0LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGFiaWxpdHk/LmhpdHMpIGRhbWFnZSAqPSBhYmlsaXR5LmhpdHM7XG5cbiAgICAvLyBGSVg6IEV4ZWN1dGUgdGhyZXNob2xkIOKAlCBvbmx5IGFwcGx5IGV4dHJhIG11bHRpcGxpZXIgaWYgTk9UIGFscmVhZHkgYSBjcml0IChubyBkb3VibGUgY3JpdClcbiAgICBpZiAoYWJpbGl0eT8uZXhlY3V0ZVRocmVzaG9sZCAmJiB0YXJnZXQuY3VycmVudEhwIC8gdGFyZ2V0Lm1heEhwIDwgYWJpbGl0eS5leGVjdXRlVGhyZXNob2xkKSB7XG4gICAgICBpZiAoIWlzQ3JpdCkge1xuICAgICAgICBkYW1hZ2UgPSBNYXRoLmZsb29yKGRhbWFnZSAqIGF0dGFja2VyLmRlcml2ZWQuY3JpdERhbWFnZU11bHQpO1xuICAgICAgfVxuICAgICAgLy8gSWYgYWxyZWFkeSBjcml0LCBleGVjdXRlIGRvZXNuJ3Qgc3RhY2sg4oCUIGRhbWFnZSBhbHJlYWR5IGluY2x1ZGVzIGNyaXQgbXVsdFxuICAgIH1cblxuICAgIGNvbnN0IHsgYWN0dWFsLCBjaGVhdGVkRGVhdGggfSA9IGFwcGx5RGFtYWdlKHRhcmdldCwgZGFtYWdlKTtcblxuICAgIGxldCBtZXNzYWdlID0gYCR7YXR0YWNrZXIubmFtZX0gJHtlZmZlY3RpdmVBY3Rpb24gPT09IFwiYmFzaWNcIiA/IFwiYXR0YWNrc1wiIDogZWZmZWN0aXZlQWN0aW9ufTogJHthY3R1YWx9IGRhbWFnZSR7aXNDcml0ID8gXCIgKGNyaXQpXCIgOiBcIlwifS5gO1xuICAgIGlmIChjaGVhdGVkRGVhdGgpIHtcbiAgICAgIG1lc3NhZ2UgKz0gYCAke3RhcmdldC5uYW1lfSBjaGVhdGVkIGRlYXRoISAoMSBIUClgO1xuICAgIH1cblxuICAgIGxvZy5wdXNoKHtcbiAgICAgIHR1cm46IHR1cm5OdW0sXG4gICAgICBhY3RvcklkOiBhdHRhY2tlci5pZCxcbiAgICAgIHRhcmdldElkOiB0YXJnZXQuaWQsXG4gICAgICBhY3Rpb246IGVmZmVjdGl2ZUFjdGlvbixcbiAgICAgIGRhbWFnZTogYWN0dWFsLFxuICAgICAgY3JpdDogaXNDcml0LFxuICAgICAgbWVzc2FnZSxcbiAgICB9KTtcbiAgICBzdGFtcEhwKGF0dGFja2VyLCB0YXJnZXQpO1xuXG4gICAgLy8gTWFyayBmaXJzdCBzdHJpa2UgY29uc3VtZWQgYWZ0ZXIgZmlyc3QgYXR0YWNrXG4gICAgYXR0YWNrZXIuaXNGaXJzdFN0cmlrZSA9IGZhbHNlO1xuXG4gICAgaWYgKGFybW9yQnJlYWtBcHBsaWVkID4gMCkge1xuICAgICAgY29uc3QgcmVkdWN0aW9uID0gdGFyZ2V0LmFybW9yICogYXJtb3JCcmVha0FwcGxpZWQ7XG4gICAgICB0YXJnZXQuYXJtb3IgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHRhcmdldC5hcm1vciAtIHJlZHVjdGlvbikpO1xuICAgICAgLy8gRklYOiBQYXNzIHJlc2lzdCBjaGFuY2UgZGlyZWN0bHkgKGhpZ2hlciByZXNpc3QgPSBtb3JlIGNoYW5jZSB0byByZXNpc3QpXG4gICAgICB0cnlBcHBseVN0YXR1cyhcbiAgICAgICAgdGFyZ2V0LFxuICAgICAgICBcImFybW9yX2JyZWFrXCIsXG4gICAgICAgIDIsXG4gICAgICAgIGdldFJlc2lzdENoYW5jZSh0YXJnZXQuYmFzZVN0YXRzLmVuZHVyYW5jZSwgdGFyZ2V0LmJhc2VTdGF0cy53aXNkb20pXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoc3RhdHVzVG9BcHBseSAmJiBNYXRoLnJhbmRvbSgpIDwgc3RhdHVzVG9BcHBseS5jaGFuY2UpIHtcbiAgICAgIC8vIEZJWDogUGFzcyByZXNpc3QgY2hhbmNlIGRpcmVjdGx5IChoaWdoZXIgcmVzaXN0ID0gbW9yZSBjaGFuY2UgdG8gcmVzaXN0KVxuICAgICAgdHJ5QXBwbHlTdGF0dXMoXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgc3RhdHVzVG9BcHBseS50eXBlIGFzIFN0YXR1c0VmZmVjdFR5cGUsXG4gICAgICAgIHN0YXR1c1RvQXBwbHkuZHVyYXRpb24sXG4gICAgICAgIGdldFJlc2lzdENoYW5jZSh0YXJnZXQuYmFzZVN0YXRzLmVuZHVyYW5jZSwgdGFyZ2V0LmJhc2VTdGF0cy53aXNkb20pXG4gICAgICApO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBkZWNyZW1lbnRDb29sZG93bnMgPSAoc3RhdGU6IENvbWJhdGFudFN0YXRlKTogdm9pZCA9PiB7XG4gICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoc3RhdGUuYWJpbGl0eUNvb2xkb3ducykpIHtcbiAgICAgIHN0YXRlLmFiaWxpdHlDb29sZG93bnNba2V5XSA9IE1hdGgubWF4KDAsIHN0YXRlLmFiaWxpdHlDb29sZG93bnNba2V5XSAtIDEpO1xuICAgIH1cbiAgfTtcblxuICB3aGlsZSAodHVybiA8IE1BWF9UVVJOUyAmJiBwbGF5ZXIuY3VycmVudEhwID4gMCAmJiBlbmVteS5jdXJyZW50SHAgPiAwKSB7XG4gICAgdHVybisrO1xuICAgIGNvbnN0IGxlbkJlZm9yZVBsYXllclRpY2sgPSBsb2cubGVuZ3RoO1xuICAgIHRpY2tTdGF0dXNFZmZlY3RzKHBsYXllciwgbG9nLCB0dXJuKTtcbiAgICBzdGFtcEhwU2luY2UobGVuQmVmb3JlUGxheWVyVGljaywgcGxheWVyLCBlbmVteSk7XG4gICAgY29uc3QgbGVuQmVmb3JlRW5lbXlUaWNrID0gbG9nLmxlbmd0aDtcbiAgICB0aWNrU3RhdHVzRWZmZWN0cyhlbmVteSwgbG9nLCB0dXJuKTtcbiAgICBzdGFtcEhwU2luY2UobGVuQmVmb3JlRW5lbXlUaWNrLCBlbmVteSwgcGxheWVyKTtcbiAgICBpZiAocGxheWVyLmN1cnJlbnRIcCA8PSAwIHx8IGVuZW15LmN1cnJlbnRIcCA8PSAwKSBicmVhaztcblxuICAgIGNvbnN0IHBsYXllckZpcnN0ID0gcGxheWVyLmJhc2VTdGF0cy5hZ2lsaXR5ID49IGVuZW15LmJhc2VTdGF0cy5hZ2lsaXR5O1xuICAgIGNvbnN0IGZpcnN0ID0gcGxheWVyRmlyc3QgPyBwbGF5ZXIgOiBlbmVteTtcbiAgICBjb25zdCBzZWNvbmQgPSBwbGF5ZXJGaXJzdCA/IGVuZW15IDogcGxheWVyO1xuXG4gICAgZGVjcmVtZW50Q29vbGRvd25zKHBsYXllcik7XG4gICAgZGVjcmVtZW50Q29vbGRvd25zKGVuZW15KTtcblxuICAgIGlmICghaXNTdHVubmVkKGZpcnN0KSkge1xuICAgICAgY29uc3QgYWN0aW9uID0gZmlyc3QuaWQgPT09IHBsYXllci5pZCA/IGdldFBsYXllckFjdGlvbigpIDogXCJiYXNpY1wiO1xuICAgICAgcmVzb2x2ZUF0dGFjayhmaXJzdCwgc2Vjb25kLCBhY3Rpb24sIHR1cm4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaXJzdC5zdGF0dXNFZmZlY3RzID0gZmlyc3Quc3RhdHVzRWZmZWN0cy5maWx0ZXIoKHMpID0+IHMudHlwZSAhPT0gXCJzdHVuXCIgfHwgcy5kdXJhdGlvbiA+IDEpO1xuICAgICAgbG9nLnB1c2goe1xuICAgICAgICB0dXJuLFxuICAgICAgICBhY3RvcklkOiBmaXJzdC5pZCxcbiAgICAgICAgdGFyZ2V0SWQ6IGZpcnN0LmlkLFxuICAgICAgICBhY3Rpb246IFwic3R1blwiLFxuICAgICAgICBtZXNzYWdlOiBgJHtmaXJzdC5uYW1lfSBpcyBzdHVubmVkLmAsXG4gICAgICB9KTtcbiAgICAgIHN0YW1wSHAoZmlyc3QsIHNlY29uZCk7XG4gICAgfVxuICAgIGlmIChzZWNvbmQuY3VycmVudEhwIDw9IDApIGJyZWFrO1xuXG4gICAgaWYgKCFpc1N0dW5uZWQoc2Vjb25kKSkge1xuICAgICAgY29uc3QgYWN0aW9uID0gc2Vjb25kLmlkID09PSBwbGF5ZXIuaWQgPyBnZXRQbGF5ZXJBY3Rpb24oKSA6IFwiYmFzaWNcIjtcbiAgICAgIHJlc29sdmVBdHRhY2soc2Vjb25kLCBmaXJzdCwgYWN0aW9uLCB0dXJuKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2Vjb25kLnN0YXR1c0VmZmVjdHMgPSBzZWNvbmQuc3RhdHVzRWZmZWN0cy5maWx0ZXIoKHMpID0+IHMudHlwZSAhPT0gXCJzdHVuXCIgfHwgcy5kdXJhdGlvbiA+IDEpO1xuICAgICAgbG9nLnB1c2goe1xuICAgICAgICB0dXJuLFxuICAgICAgICBhY3RvcklkOiBzZWNvbmQuaWQsXG4gICAgICAgIHRhcmdldElkOiBzZWNvbmQuaWQsXG4gICAgICAgIGFjdGlvbjogXCJzdHVuXCIsXG4gICAgICAgIG1lc3NhZ2U6IGAke3NlY29uZC5uYW1lfSBpcyBzdHVubmVkLmAsXG4gICAgICB9KTtcbiAgICAgIHN0YW1wSHAoc2Vjb25kLCBmaXJzdCk7XG4gICAgfVxuICB9XG5cbiAgbGV0IHdpbm5lcklkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgbGV0IGxvc2VySWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBsZXQgZHJhdyA9IGZhbHNlO1xuICBpZiAocGxheWVyLmN1cnJlbnRIcCA8PSAwICYmIGVuZW15LmN1cnJlbnRIcCA8PSAwKSB7XG4gICAgZHJhdyA9IHRydWU7XG4gIH0gZWxzZSBpZiAocGxheWVyLmN1cnJlbnRIcCA8PSAwKSB7XG4gICAgd2lubmVySWQgPSBlbmVteS5pZDtcbiAgICBsb3NlcklkID0gcGxheWVyLmlkO1xuICB9IGVsc2UgaWYgKGVuZW15LmN1cnJlbnRIcCA8PSAwKSB7XG4gICAgd2lubmVySWQgPSBwbGF5ZXIuaWQ7XG4gICAgbG9zZXJJZCA9IGVuZW15LmlkO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHBsYXllckhwUGN0ID0gcGxheWVyLmN1cnJlbnRIcCAvIHBsYXllci5tYXhIcDtcbiAgICBjb25zdCBlbmVteUhwUGN0ID0gZW5lbXkuY3VycmVudEhwIC8gZW5lbXkubWF4SHA7XG4gICAgaWYgKHBsYXllckhwUGN0ID4gZW5lbXlIcFBjdCkge1xuICAgICAgd2lubmVySWQgPSBwbGF5ZXIuaWQ7XG4gICAgICBsb3NlcklkID0gZW5lbXkuaWQ7XG4gICAgfSBlbHNlIGlmIChlbmVteUhwUGN0ID4gcGxheWVySHBQY3QpIHtcbiAgICAgIHdpbm5lcklkID0gZW5lbXkuaWQ7XG4gICAgICBsb3NlcklkID0gcGxheWVyLmlkO1xuICAgIH0gZWxzZSB7XG4gICAgICBkcmF3ID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpbm5lcklkLFxuICAgIGxvc2VySWQsXG4gICAgZHJhdyxcbiAgICB0dXJuczogdHVybixcbiAgICBsb2csXG4gICAgcGxheWVyU25hcHNob3Q6IHRvU25hcHNob3QocGxheWVyKSxcbiAgICBlbmVteVNuYXBzaG90OiB0b1NuYXBzaG90KGVuZW15KSxcbiAgfTtcbn07XG5cbi8qKiBCdWlsZCBDb21iYXRhbnRTdGF0ZSBmcm9tIGNoYXJhY3Rlci1saWtlIG9iamVjdCBhbmQgb3B0aW9uYWwgZGlzcGxheSBuYW1lICovXG5leHBvcnQgY29uc3QgYnVpbGRDb21iYXRhbnRTdGF0ZSA9IChwYXJhbXM6IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBjbGFzczogXCJ3YXJyaW9yXCIgfCBcInJvZ3VlXCIgfCBcIm1hZ2VcIiB8IFwidGFua1wiO1xuICBvcmlnaW4/OiBDaGFyYWN0ZXJPcmlnaW47XG4gIGxldmVsOiBudW1iZXI7XG4gIHN0cmVuZ3RoOiBudW1iZXI7XG4gIGFnaWxpdHk6IG51bWJlcjtcbiAgdml0YWxpdHk6IG51bWJlcjtcbiAgZW5kdXJhbmNlOiBudW1iZXI7XG4gIGludGVsbGlnZW5jZTogbnVtYmVyO1xuICB3aXNkb206IG51bWJlcjtcbiAgbHVjazogbnVtYmVyO1xuICBjaGFyaXNtYTogbnVtYmVyO1xuICBhcm1vcj86IG51bWJlcjtcbn0pOiBDb21iYXRhbnRTdGF0ZSA9PiB7XG4gIGNvbnN0IHtcbiAgICBpZCxcbiAgICBuYW1lLFxuICAgIGNsYXNzOiBjbHMsXG4gICAgb3JpZ2luLFxuICAgIGxldmVsLFxuICAgIHN0cmVuZ3RoLFxuICAgIGFnaWxpdHksXG4gICAgdml0YWxpdHksXG4gICAgZW5kdXJhbmNlLFxuICAgIGludGVsbGlnZW5jZSxcbiAgICB3aXNkb20sXG4gICAgbHVjayxcbiAgICBjaGFyaXNtYSxcbiAgICBhcm1vciA9IDAsXG4gIH0gPSBwYXJhbXM7XG5cbiAgY29uc3QgYmFzZVN0YXRzID0gZ2V0RWZmZWN0aXZlU3RhdHMoXG4gICAgeyBzdHJlbmd0aCwgYWdpbGl0eSwgdml0YWxpdHksIGVuZHVyYW5jZSwgaW50ZWxsaWdlbmNlLCB3aXNkb20sIGx1Y2ssIGNoYXJpc21hIH0sXG4gICAgb3JpZ2luXG4gICk7XG5cbiAgY29uc3QgZGVyaXZlZCA9IGNvbXB1dGVEZXJpdmVkU3RhdHMoYmFzZVN0YXRzLCBhcm1vciwgMCk7XG4gIGNvbnN0IG1heEhwID0gZGVyaXZlZC5tYXhIcDtcbiAgcmV0dXJuIHtcbiAgICBpZCxcbiAgICBuYW1lLFxuICAgIGNsYXNzOiBjbHMsXG4gICAgb3JpZ2luLFxuICAgIGxldmVsLFxuICAgIGJhc2VTdGF0cyxcbiAgICBkZXJpdmVkLFxuICAgIGN1cnJlbnRIcDogbWF4SHAsXG4gICAgbWF4SHAsXG4gICAgYXJtb3IsXG4gICAgbWFnaWNSZXNpc3Q6IGRlcml2ZWQubWFnaWNSZXNpc3QsXG4gICAgc3RhdHVzRWZmZWN0czogW10sXG4gICAgYWJpbGl0eUNvb2xkb3duczoge30sXG4gIH07XG59O1xuIl0sIm5hbWVzIjpbImdldEFiaWxpdGllc0ZvckNsYXNzIiwiZ2V0QWJpbGl0eUJ5SWQiLCJjb21wdXRlRGVyaXZlZFN0YXRzIiwiZ2V0RWZmZWN0aXZlU3RhdHMiLCJjYWxjUGh5c2ljYWxEYW1hZ2UiLCJjYWxjTWFnaWNEYW1hZ2UiLCJyb2xsQ3JpdCIsInJvbGxEb2RnZSIsIk1BWF9UVVJOUyIsImhhc0NoZWF0RGVhdGgiLCJnZXRDaGVhdERlYXRoQ2hhbmNlIiwiYXBwbHlEYW1hZ2UiLCJzdGF0ZSIsImFtb3VudCIsImFjdHVhbCIsImNoZWF0ZWREZWF0aCIsIk1hdGgiLCJtYXgiLCJmbG9vciIsIm5ld0hwIiwiY3VycmVudEhwIiwib3JpZ2luIiwiY2hhbmNlIiwicmFuZG9tIiwidG9TbmFwc2hvdCIsInMiLCJpZCIsIm5hbWUiLCJjbGFzcyIsImxldmVsIiwibWF4SHAiLCJiYXNlU3RhdHMiLCJnZXRFZmZlY3RpdmVBcm1vciIsImhhc0FybW9yQnJlYWsiLCJzdGF0dXNFZmZlY3RzIiwic29tZSIsInR5cGUiLCJhcm1vciIsImdldEVmZmVjdGl2ZURvZGdlIiwiZG9kZ2VCdWZmIiwiZmluZCIsImRlcml2ZWQiLCJkb2RnZUNoYW5jZSIsInZhbHVlIiwidGlja1N0YXR1c0VmZmVjdHMiLCJsb2ciLCJ0dXJuIiwidGlja3MiLCJmaWx0ZXIiLCJkdXJhdGlvbiIsImRtZyIsInB1c2giLCJkYW1hZ2UiLCJoZWFsIiwibWluIiwiaGVhbGVkIiwibGVuZ3RoIiwiYWN0b3JJZCIsInRhcmdldElkIiwiYWN0aW9uIiwic3RhdHVzVGlja3MiLCJtZXNzYWdlIiwibWFwIiwidCIsImpvaW4iLCJ0cnlBcHBseVN0YXR1cyIsInRhcmdldCIsInJlc2lzdENoYW5jZSIsImV4aXN0aW5nIiwiZ2V0UmVzaXN0Q2hhbmNlIiwiZW5kIiwid2lzIiwiaXNTdHVubmVkIiwiYXBwbHlTZWxmQnVmZiIsImNhc3RlciIsImFiaWxpdHkiLCJ0dXJuTnVtIiwic2VsZkJ1ZmYiLCJidWZmTWVzc2FnZXMiLCJzdGF0IiwicGN0IiwiT2JqZWN0IiwiZW50cmllcyIsInN0cmVuZ3RoIiwicm91bmQiLCJkb2RnZUJvbnVzIiwidHVybnMiLCJkb2RnZUJvbnVzVHVybnMiLCJydW5Db21iYXQiLCJwbGF5ZXIiLCJlbmVteSIsInBsYXllckNob2ljZXMiLCJpc0ZpcnN0U3RyaWtlIiwic3RhbXBIcCIsImFjdG9yIiwiZW50cnkiLCJlIiwiYWN0b3JIcEFmdGVyIiwidGFyZ2V0SHBBZnRlciIsInN0YW1wSHBTaW5jZSIsInNpbmNlTGVuZ3RoIiwiaSIsImNob2ljZUluZGV4IiwiZ2V0UGxheWVyQWN0aW9uIiwiYWJpbGl0aWVzIiwiYXZhaWxhYmxlIiwiYSIsImFiaWxpdHlDb29sZG93bnMiLCJwaWNrIiwicmVzb2x2ZUF0dGFjayIsImF0dGFja2VyIiwiaXNCYXNpYyIsInNraWxsTXVsdCIsInNwZWxsTXVsdCIsImNyaXRCb251cyIsImFybW9yQnJlYWtBcHBsaWVkIiwic3RhdHVzVG9BcHBseSIsImVmZmVjdGl2ZUFjdGlvbiIsImZpcnN0U3RyaWtlT25seSIsInVuZGVmaW5lZCIsImNvb2xkb3duIiwibXVsdGlwbGllciIsImFybW9yQnJlYWsiLCJzdGF0dXMiLCJkaWREb2RnZSIsImRvZGdlIiwiaXNQaHlzaWNhbCIsImNyaXRDaGFuY2UiLCJpc0NyaXQiLCJlZmZlY3RpdmVBcm1vciIsImF0dGFja2VyU3RyIiwiZGVmZW5kZXJFbmQiLCJlbmR1cmFuY2UiLCJkZWZlbmRlckFybW9yIiwic2tpbGxNdWx0aXBsaWVyIiwiY3JpdERhbWFnZU11bHQiLCJhdHRhY2tlckludCIsImludGVsbGlnZW5jZSIsImRlZmVuZGVyV2lzIiwid2lzZG9tIiwic3BlbGxNdWx0aXBsaWVyIiwiaGl0cyIsImV4ZWN1dGVUaHJlc2hvbGQiLCJjcml0IiwicmVkdWN0aW9uIiwiZGVjcmVtZW50Q29vbGRvd25zIiwia2V5Iiwia2V5cyIsImxlbkJlZm9yZVBsYXllclRpY2siLCJsZW5CZWZvcmVFbmVteVRpY2siLCJwbGF5ZXJGaXJzdCIsImFnaWxpdHkiLCJmaXJzdCIsInNlY29uZCIsIndpbm5lcklkIiwibG9zZXJJZCIsImRyYXciLCJwbGF5ZXJIcFBjdCIsImVuZW15SHBQY3QiLCJwbGF5ZXJTbmFwc2hvdCIsImVuZW15U25hcHNob3QiLCJidWlsZENvbWJhdGFudFN0YXRlIiwicGFyYW1zIiwiY2xzIiwidml0YWxpdHkiLCJsdWNrIiwiY2hhcmlzbWEiLCJtYWdpY1Jlc2lzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/combat.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/constants.ts":
/*!*******************************!*\
  !*** ./lib/game/constants.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ARMOR_DENOMINATOR: () => (/* binding */ ARMOR_DENOMINATOR),\n/* harmony export */   ARMOR_REDUCTION_CAP: () => (/* binding */ ARMOR_REDUCTION_CAP),\n/* harmony export */   BASE_CRIT_CHANCE: () => (/* binding */ BASE_CRIT_CHANCE),\n/* harmony export */   BASE_CRIT_DAMAGE: () => (/* binding */ BASE_CRIT_DAMAGE),\n/* harmony export */   BASE_DODGE: () => (/* binding */ BASE_DODGE),\n/* harmony export */   DAMAGE_VARIANCE_MAX: () => (/* binding */ DAMAGE_VARIANCE_MAX),\n/* harmony export */   DAMAGE_VARIANCE_MIN: () => (/* binding */ DAMAGE_VARIANCE_MIN),\n/* harmony export */   END_DEFENSE_FACTOR: () => (/* binding */ END_DEFENSE_FACTOR),\n/* harmony export */   HP_PER_VIT: () => (/* binding */ HP_PER_VIT),\n/* harmony export */   MAGIC_RESIST_CAP: () => (/* binding */ MAGIC_RESIST_CAP),\n/* harmony export */   MAGIC_RESIST_DENOM: () => (/* binding */ MAGIC_RESIST_DENOM),\n/* harmony export */   MAX_CRIT_CHANCE: () => (/* binding */ MAX_CRIT_CHANCE),\n/* harmony export */   MAX_CRIT_DAMAGE_MULT: () => (/* binding */ MAX_CRIT_DAMAGE_MULT),\n/* harmony export */   MAX_DODGE: () => (/* binding */ MAX_DODGE),\n/* harmony export */   MAX_TURNS: () => (/* binding */ MAX_TURNS),\n/* harmony export */   WIS_DEFENSE_FACTOR: () => (/* binding */ WIS_DEFENSE_FACTOR)\n/* harmony export */ });\n/** GDD §2.1 - Combat constants */ const BASE_CRIT_CHANCE = 5;\nconst MAX_CRIT_CHANCE = 50;\nconst BASE_DODGE = 3;\nconst MAX_DODGE = 40;\nconst MAX_CRIT_DAMAGE_MULT = 2.8;\nconst BASE_CRIT_DAMAGE = 1.5;\nconst ARMOR_REDUCTION_CAP = 0.75;\nconst MAGIC_RESIST_CAP = 0.7;\nconst MAX_TURNS = 15;\nconst HP_PER_VIT = 10;\nconst ARMOR_DENOMINATOR = 100;\nconst MAGIC_RESIST_DENOM = 150;\nconst WIS_DEFENSE_FACTOR = 0.4;\nconst END_DEFENSE_FACTOR = 0.5;\nconst DAMAGE_VARIANCE_MIN = 0.95;\nconst DAMAGE_VARIANCE_MAX = 1.05;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9jb25zdGFudHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGdDQUFnQyxHQUV6QixNQUFNQSxtQkFBbUIsRUFBRTtBQUMzQixNQUFNQyxrQkFBa0IsR0FBRztBQUMzQixNQUFNQyxhQUFhLEVBQUU7QUFDckIsTUFBTUMsWUFBWSxHQUFHO0FBQ3JCLE1BQU1DLHVCQUF1QixJQUFJO0FBQ2pDLE1BQU1DLG1CQUFtQixJQUFJO0FBQzdCLE1BQU1DLHNCQUFzQixLQUFLO0FBQ2pDLE1BQU1DLG1CQUFtQixJQUFJO0FBQzdCLE1BQU1DLFlBQVksR0FBRztBQUVyQixNQUFNQyxhQUFhLEdBQUc7QUFDdEIsTUFBTUMsb0JBQW9CLElBQUk7QUFDOUIsTUFBTUMscUJBQXFCLElBQUk7QUFDL0IsTUFBTUMscUJBQXFCLElBQUk7QUFDL0IsTUFBTUMscUJBQXFCLElBQUk7QUFFL0IsTUFBTUMsc0JBQXNCLEtBQUs7QUFDakMsTUFBTUMsc0JBQXNCLEtBQUsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcm9uLWZpc3QtYXJlbmEvLi9saWIvZ2FtZS9jb25zdGFudHMudHM/MGUyZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogR0REIMKnMi4xIC0gQ29tYmF0IGNvbnN0YW50cyAqL1xuXG5leHBvcnQgY29uc3QgQkFTRV9DUklUX0NIQU5DRSA9IDU7XG5leHBvcnQgY29uc3QgTUFYX0NSSVRfQ0hBTkNFID0gNTA7XG5leHBvcnQgY29uc3QgQkFTRV9ET0RHRSA9IDM7XG5leHBvcnQgY29uc3QgTUFYX0RPREdFID0gNDA7XG5leHBvcnQgY29uc3QgTUFYX0NSSVRfREFNQUdFX01VTFQgPSAyLjg7XG5leHBvcnQgY29uc3QgQkFTRV9DUklUX0RBTUFHRSA9IDEuNTtcbmV4cG9ydCBjb25zdCBBUk1PUl9SRURVQ1RJT05fQ0FQID0gMC43NTtcbmV4cG9ydCBjb25zdCBNQUdJQ19SRVNJU1RfQ0FQID0gMC43O1xuZXhwb3J0IGNvbnN0IE1BWF9UVVJOUyA9IDE1O1xuXG5leHBvcnQgY29uc3QgSFBfUEVSX1ZJVCA9IDEwO1xuZXhwb3J0IGNvbnN0IEFSTU9SX0RFTk9NSU5BVE9SID0gMTAwO1xuZXhwb3J0IGNvbnN0IE1BR0lDX1JFU0lTVF9ERU5PTSA9IDE1MDtcbmV4cG9ydCBjb25zdCBXSVNfREVGRU5TRV9GQUNUT1IgPSAwLjQ7XG5leHBvcnQgY29uc3QgRU5EX0RFRkVOU0VfRkFDVE9SID0gMC41O1xuXG5leHBvcnQgY29uc3QgREFNQUdFX1ZBUklBTkNFX01JTiA9IDAuOTU7XG5leHBvcnQgY29uc3QgREFNQUdFX1ZBUklBTkNFX01BWCA9IDEuMDU7XG4iXSwibmFtZXMiOlsiQkFTRV9DUklUX0NIQU5DRSIsIk1BWF9DUklUX0NIQU5DRSIsIkJBU0VfRE9ER0UiLCJNQVhfRE9ER0UiLCJNQVhfQ1JJVF9EQU1BR0VfTVVMVCIsIkJBU0VfQ1JJVF9EQU1BR0UiLCJBUk1PUl9SRURVQ1RJT05fQ0FQIiwiTUFHSUNfUkVTSVNUX0NBUCIsIk1BWF9UVVJOUyIsIkhQX1BFUl9WSVQiLCJBUk1PUl9ERU5PTUlOQVRPUiIsIk1BR0lDX1JFU0lTVF9ERU5PTSIsIldJU19ERUZFTlNFX0ZBQ1RPUiIsIkVORF9ERUZFTlNFX0ZBQ1RPUiIsIkRBTUFHRV9WQVJJQU5DRV9NSU4iLCJEQU1BR0VfVkFSSUFOQ0VfTUFYIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/constants.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/damage.ts":
/*!****************************!*\
  !*** ./lib/game/damage.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calcMagicDamage: () => (/* binding */ calcMagicDamage),\n/* harmony export */   calcPhysicalDamage: () => (/* binding */ calcPhysicalDamage),\n/* harmony export */   rollCrit: () => (/* binding */ rollCrit),\n/* harmony export */   rollDodge: () => (/* binding */ rollDodge)\n/* harmony export */ });\n/* harmony import */ var _stats__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stats */ \"(rsc)/./lib/game/stats.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ \"(rsc)/./lib/game/constants.ts\");\n\n\n/** Random variance 0.95 - 1.05 */ const randomVariance = ()=>_constants__WEBPACK_IMPORTED_MODULE_1__.DAMAGE_VARIANCE_MIN + Math.random() * (_constants__WEBPACK_IMPORTED_MODULE_1__.DAMAGE_VARIANCE_MAX - _constants__WEBPACK_IMPORTED_MODULE_1__.DAMAGE_VARIANCE_MIN);\n/**\n * GDD §2.1 Physical damage:\n * Base = (STR * skillMult) - (DefENDER_END * 0.5)\n * Effective = Base * (1 - armorReduction) * critMult * variance\n */ const calcPhysicalDamage = (params)=>{\n    const { attackerStr, defenderEnd, defenderArmor, skillMultiplier, isCrit, critDamageMult } = params;\n    const base = Math.max(1, attackerStr * skillMultiplier - defenderEnd * _constants__WEBPACK_IMPORTED_MODULE_1__.END_DEFENSE_FACTOR);\n    const armorReduction = (0,_stats__WEBPACK_IMPORTED_MODULE_0__.getArmorReduction)(defenderArmor);\n    const critMult = isCrit ? critDamageMult : 1;\n    const variance = randomVariance();\n    return Math.max(1, Math.floor(base * (1 - armorReduction) * critMult * variance));\n};\n/**\n * GDD §2.1 Magic damage:\n * Base = (INT * spellMult) - (WIS * 0.4)\n * Effective = Base * (1 - magicResist) * critMult * elementMod\n */ const calcMagicDamage = (params)=>{\n    const { attackerInt, defenderWis, spellMultiplier, isCrit, critDamageMult, elementMod = 1 } = params;\n    const base = Math.max(1, attackerInt * spellMultiplier - defenderWis * _constants__WEBPACK_IMPORTED_MODULE_1__.WIS_DEFENSE_FACTOR);\n    const magicResist = (0,_stats__WEBPACK_IMPORTED_MODULE_0__.getMagicResistPercent)(defenderWis);\n    const critMult = isCrit ? critDamageMult : 1;\n    const variance = randomVariance();\n    return Math.max(1, Math.floor(base * (1 - magicResist) * critMult * elementMod * variance));\n};\n/** Roll crit: true if random 0-100 < critChance */ const rollCrit = (critChance)=>Math.random() * 100 < critChance;\n/** Roll dodge: true if random 0-100 < dodgeChance */ const rollDodge = (dodgeChance)=>Math.random() * 100 < dodgeChance;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9kYW1hZ2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQW1FO0FBTTlDO0FBRXJCLGdDQUFnQyxHQUNoQyxNQUFNTSxpQkFBaUIsSUFDckJKLDJEQUFtQkEsR0FDbkJLLEtBQUtDLE1BQU0sS0FBTUwsQ0FBQUEsMkRBQW1CQSxHQUFHRCwyREFBa0I7QUFFM0Q7Ozs7Q0FJQyxHQUNNLE1BQU1PLHFCQUFxQixDQUFDQztJQVFqQyxNQUFNLEVBQ0pDLFdBQVcsRUFDWEMsV0FBVyxFQUNYQyxhQUFhLEVBQ2JDLGVBQWUsRUFDZkMsTUFBTSxFQUNOQyxjQUFjLEVBQ2YsR0FBR047SUFDSixNQUFNTyxPQUFPVixLQUFLVyxHQUFHLENBQ25CLEdBQ0FQLGNBQWNHLGtCQUFrQkYsY0FBY1AsMERBQWtCQTtJQUVsRSxNQUFNYyxpQkFBaUJuQix5REFBaUJBLENBQUNhO0lBQ3pDLE1BQU1PLFdBQVdMLFNBQVNDLGlCQUFpQjtJQUMzQyxNQUFNSyxXQUFXZjtJQUNqQixPQUFPQyxLQUFLVyxHQUFHLENBQUMsR0FBR1gsS0FBS2UsS0FBSyxDQUFDTCxPQUFRLEtBQUlFLGNBQWEsSUFBS0MsV0FBV0M7QUFDekUsRUFBRTtBQUVGOzs7O0NBSUMsR0FDTSxNQUFNRSxrQkFBa0IsQ0FBQ2I7SUFROUIsTUFBTSxFQUNKYyxXQUFXLEVBQ1hDLFdBQVcsRUFDWEMsZUFBZSxFQUNmWCxNQUFNLEVBQ05DLGNBQWMsRUFDZFcsYUFBYSxDQUFDLEVBQ2YsR0FBR2pCO0lBQ0osTUFBTU8sT0FBT1YsS0FBS1csR0FBRyxDQUNuQixHQUNBTSxjQUFjRSxrQkFBa0JELGNBQWNyQiwwREFBa0JBO0lBRWxFLE1BQU13QixjQUFjM0IsNkRBQXFCQSxDQUFDd0I7SUFDMUMsTUFBTUwsV0FBV0wsU0FBU0MsaUJBQWlCO0lBQzNDLE1BQU1LLFdBQVdmO0lBQ2pCLE9BQU9DLEtBQUtXLEdBQUcsQ0FDYixHQUNBWCxLQUFLZSxLQUFLLENBQUNMLE9BQVEsS0FBSVcsV0FBVSxJQUFLUixXQUFXTyxhQUFhTjtBQUVsRSxFQUFFO0FBRUYsaURBQWlELEdBQzFDLE1BQU1RLFdBQVcsQ0FBQ0MsYUFDdkJ2QixLQUFLQyxNQUFNLEtBQUssTUFBTXNCLFdBQVc7QUFFbkMsbURBQW1ELEdBQzVDLE1BQU1DLFlBQVksQ0FBQ0MsY0FDeEJ6QixLQUFLQyxNQUFNLEtBQUssTUFBTXdCLFlBQVkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcm9uLWZpc3QtYXJlbmEvLi9saWIvZ2FtZS9kYW1hZ2UudHM/MzU5YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRBcm1vclJlZHVjdGlvbiwgZ2V0TWFnaWNSZXNpc3RQZXJjZW50IH0gZnJvbSBcIi4vc3RhdHNcIjtcbmltcG9ydCB7XG4gIERBTUFHRV9WQVJJQU5DRV9NSU4sXG4gIERBTUFHRV9WQVJJQU5DRV9NQVgsXG4gIFdJU19ERUZFTlNFX0ZBQ1RPUixcbiAgRU5EX0RFRkVOU0VfRkFDVE9SLFxufSBmcm9tIFwiLi9jb25zdGFudHNcIjtcblxuLyoqIFJhbmRvbSB2YXJpYW5jZSAwLjk1IC0gMS4wNSAqL1xuY29uc3QgcmFuZG9tVmFyaWFuY2UgPSAoKTogbnVtYmVyID0+XG4gIERBTUFHRV9WQVJJQU5DRV9NSU4gK1xuICBNYXRoLnJhbmRvbSgpICogKERBTUFHRV9WQVJJQU5DRV9NQVggLSBEQU1BR0VfVkFSSUFOQ0VfTUlOKTtcblxuLyoqXG4gKiBHREQgwqcyLjEgUGh5c2ljYWwgZGFtYWdlOlxuICogQmFzZSA9IChTVFIgKiBza2lsbE11bHQpIC0gKERlZkVOREVSX0VORCAqIDAuNSlcbiAqIEVmZmVjdGl2ZSA9IEJhc2UgKiAoMSAtIGFybW9yUmVkdWN0aW9uKSAqIGNyaXRNdWx0ICogdmFyaWFuY2VcbiAqL1xuZXhwb3J0IGNvbnN0IGNhbGNQaHlzaWNhbERhbWFnZSA9IChwYXJhbXM6IHtcbiAgYXR0YWNrZXJTdHI6IG51bWJlcjtcbiAgZGVmZW5kZXJFbmQ6IG51bWJlcjtcbiAgZGVmZW5kZXJBcm1vcjogbnVtYmVyO1xuICBza2lsbE11bHRpcGxpZXI6IG51bWJlcjtcbiAgaXNDcml0OiBib29sZWFuO1xuICBjcml0RGFtYWdlTXVsdDogbnVtYmVyO1xufSk6IG51bWJlciA9PiB7XG4gIGNvbnN0IHtcbiAgICBhdHRhY2tlclN0cixcbiAgICBkZWZlbmRlckVuZCxcbiAgICBkZWZlbmRlckFybW9yLFxuICAgIHNraWxsTXVsdGlwbGllcixcbiAgICBpc0NyaXQsXG4gICAgY3JpdERhbWFnZU11bHQsXG4gIH0gPSBwYXJhbXM7XG4gIGNvbnN0IGJhc2UgPSBNYXRoLm1heChcbiAgICAxLFxuICAgIGF0dGFja2VyU3RyICogc2tpbGxNdWx0aXBsaWVyIC0gZGVmZW5kZXJFbmQgKiBFTkRfREVGRU5TRV9GQUNUT1JcbiAgKTtcbiAgY29uc3QgYXJtb3JSZWR1Y3Rpb24gPSBnZXRBcm1vclJlZHVjdGlvbihkZWZlbmRlckFybW9yKTtcbiAgY29uc3QgY3JpdE11bHQgPSBpc0NyaXQgPyBjcml0RGFtYWdlTXVsdCA6IDE7XG4gIGNvbnN0IHZhcmlhbmNlID0gcmFuZG9tVmFyaWFuY2UoKTtcbiAgcmV0dXJuIE1hdGgubWF4KDEsIE1hdGguZmxvb3IoYmFzZSAqICgxIC0gYXJtb3JSZWR1Y3Rpb24pICogY3JpdE11bHQgKiB2YXJpYW5jZSkpO1xufTtcblxuLyoqXG4gKiBHREQgwqcyLjEgTWFnaWMgZGFtYWdlOlxuICogQmFzZSA9IChJTlQgKiBzcGVsbE11bHQpIC0gKFdJUyAqIDAuNClcbiAqIEVmZmVjdGl2ZSA9IEJhc2UgKiAoMSAtIG1hZ2ljUmVzaXN0KSAqIGNyaXRNdWx0ICogZWxlbWVudE1vZFxuICovXG5leHBvcnQgY29uc3QgY2FsY01hZ2ljRGFtYWdlID0gKHBhcmFtczoge1xuICBhdHRhY2tlckludDogbnVtYmVyO1xuICBkZWZlbmRlcldpczogbnVtYmVyO1xuICBzcGVsbE11bHRpcGxpZXI6IG51bWJlcjtcbiAgaXNDcml0OiBib29sZWFuO1xuICBjcml0RGFtYWdlTXVsdDogbnVtYmVyO1xuICBlbGVtZW50TW9kPzogbnVtYmVyO1xufSk6IG51bWJlciA9PiB7XG4gIGNvbnN0IHtcbiAgICBhdHRhY2tlckludCxcbiAgICBkZWZlbmRlcldpcyxcbiAgICBzcGVsbE11bHRpcGxpZXIsXG4gICAgaXNDcml0LFxuICAgIGNyaXREYW1hZ2VNdWx0LFxuICAgIGVsZW1lbnRNb2QgPSAxLFxuICB9ID0gcGFyYW1zO1xuICBjb25zdCBiYXNlID0gTWF0aC5tYXgoXG4gICAgMSxcbiAgICBhdHRhY2tlckludCAqIHNwZWxsTXVsdGlwbGllciAtIGRlZmVuZGVyV2lzICogV0lTX0RFRkVOU0VfRkFDVE9SXG4gICk7XG4gIGNvbnN0IG1hZ2ljUmVzaXN0ID0gZ2V0TWFnaWNSZXNpc3RQZXJjZW50KGRlZmVuZGVyV2lzKTtcbiAgY29uc3QgY3JpdE11bHQgPSBpc0NyaXQgPyBjcml0RGFtYWdlTXVsdCA6IDE7XG4gIGNvbnN0IHZhcmlhbmNlID0gcmFuZG9tVmFyaWFuY2UoKTtcbiAgcmV0dXJuIE1hdGgubWF4KFxuICAgIDEsXG4gICAgTWF0aC5mbG9vcihiYXNlICogKDEgLSBtYWdpY1Jlc2lzdCkgKiBjcml0TXVsdCAqIGVsZW1lbnRNb2QgKiB2YXJpYW5jZSlcbiAgKTtcbn07XG5cbi8qKiBSb2xsIGNyaXQ6IHRydWUgaWYgcmFuZG9tIDAtMTAwIDwgY3JpdENoYW5jZSAqL1xuZXhwb3J0IGNvbnN0IHJvbGxDcml0ID0gKGNyaXRDaGFuY2U6IG51bWJlcik6IGJvb2xlYW4gPT5cbiAgTWF0aC5yYW5kb20oKSAqIDEwMCA8IGNyaXRDaGFuY2U7XG5cbi8qKiBSb2xsIGRvZGdlOiB0cnVlIGlmIHJhbmRvbSAwLTEwMCA8IGRvZGdlQ2hhbmNlICovXG5leHBvcnQgY29uc3Qgcm9sbERvZGdlID0gKGRvZGdlQ2hhbmNlOiBudW1iZXIpOiBib29sZWFuID0+XG4gIE1hdGgucmFuZG9tKCkgKiAxMDAgPCBkb2RnZUNoYW5jZTtcbiJdLCJuYW1lcyI6WyJnZXRBcm1vclJlZHVjdGlvbiIsImdldE1hZ2ljUmVzaXN0UGVyY2VudCIsIkRBTUFHRV9WQVJJQU5DRV9NSU4iLCJEQU1BR0VfVkFSSUFOQ0VfTUFYIiwiV0lTX0RFRkVOU0VfRkFDVE9SIiwiRU5EX0RFRkVOU0VfRkFDVE9SIiwicmFuZG9tVmFyaWFuY2UiLCJNYXRoIiwicmFuZG9tIiwiY2FsY1BoeXNpY2FsRGFtYWdlIiwicGFyYW1zIiwiYXR0YWNrZXJTdHIiLCJkZWZlbmRlckVuZCIsImRlZmVuZGVyQXJtb3IiLCJza2lsbE11bHRpcGxpZXIiLCJpc0NyaXQiLCJjcml0RGFtYWdlTXVsdCIsImJhc2UiLCJtYXgiLCJhcm1vclJlZHVjdGlvbiIsImNyaXRNdWx0IiwidmFyaWFuY2UiLCJmbG9vciIsImNhbGNNYWdpY0RhbWFnZSIsImF0dGFja2VySW50IiwiZGVmZW5kZXJXaXMiLCJzcGVsbE11bHRpcGxpZXIiLCJlbGVtZW50TW9kIiwibWFnaWNSZXNpc3QiLCJyb2xsQ3JpdCIsImNyaXRDaGFuY2UiLCJyb2xsRG9kZ2UiLCJkb2RnZUNoYW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/damage.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/dungeon-data.ts":
/*!**********************************!*\
  !*** ./lib/game/dungeon-data.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BOSSES_PER_DUNGEON: () => (/* binding */ BOSSES_PER_DUNGEON),\n/* harmony export */   DUNGEONS: () => (/* binding */ DUNGEONS),\n/* harmony export */   getDungeonById: () => (/* binding */ getDungeonById)\n/* harmony export */ });\n/** Static dungeon & boss definitions.\n *  Each dungeon has 10 bosses beaten sequentially.\n *  Unlock chain: prevDungeonId must be completed (10/10) to unlock next. */ /* ─── Types ─── */ /* ─── Boss helper ─── */ const boss = (index, name, description, baseLevel, mult)=>({\n        index,\n        name,\n        description,\n        level: baseLevel + index,\n        statMultiplier: mult + index * 0.15\n    });\n/* ─── Dungeon catalogue ─── */ const DUNGEONS = [\n    /* 1. Training Camp ─────────────────────── */ {\n        id: \"training_camp\",\n        name: \"Training Camp\",\n        subtitle: \"Where pups become warriors\",\n        minLevel: 1,\n        staminaCost: 10,\n        prevDungeonId: null,\n        theme: {\n            gradient: \"from-green-900 via-emerald-800 to-green-950\",\n            cardBg: \"from-green-950/90 via-emerald-950/80 to-slate-950/90\",\n            accent: \"border-green-500/70 shadow-green-500/30\",\n            glowColor: \"ring-green-400/50\",\n            borderGlow: \"hover:shadow-green-500/20\",\n            icon: \"\\uD83C\\uDFD5️\"\n        },\n        bosses: [\n            boss(0, \"Straw Dummy\", \"A lifeless target — until the wind picks up.\", 1, 0.5),\n            boss(1, \"Rusty Automaton\", \"Gears creak. Blades spin. Slowly.\", 2, 0.55),\n            boss(2, \"Barrel Golem\", \"Assembled from old casks and spite.\", 3, 0.6),\n            boss(3, \"Plank Knight\", \"Held together by rusty nails and determination.\", 3, 0.65),\n            boss(4, \"Flying Francis\", \"Buzzes and staggers through the air. A crash landing is unavoidable.\", 4, 0.7),\n            boss(5, \"Scarecrow Mage\", \"Waves a stick. Sparks occasionally fly.\", 4, 0.75),\n            boss(6, \"Mud Troll\", \"Slow, sticky, surprisingly aggressive.\", 5, 0.8),\n            boss(7, \"Possessed Mannequin\", \"They say it blinks when you look away.\", 5, 0.85),\n            boss(8, \"Iron Dummy\", \"Upgraded. Dangerous. Still has straw hair.\", 6, 0.9),\n            boss(9, \"Drill Sergeant Grizzle\", \"The real boss. Retired from the arena. Still terrifying.\", 7, 1.0)\n        ]\n    },\n    /* 2. Desecrated Catacombs ───────────── */ {\n        id: \"desecrated_catacombs\",\n        name: \"Desecrated Catacombs\",\n        subtitle: \"Where the dead refuse to rest\",\n        minLevel: 5,\n        staminaCost: 12,\n        prevDungeonId: \"training_camp\",\n        theme: {\n            gradient: \"from-cyan-900 via-teal-800 to-cyan-950\",\n            cardBg: \"from-cyan-950/90 via-teal-950/80 to-slate-950/90\",\n            accent: \"border-cyan-500/70 shadow-cyan-500/30\",\n            glowColor: \"ring-cyan-400/50\",\n            borderGlow: \"hover:shadow-cyan-500/20\",\n            icon: \"\\uD83D\\uDC80\"\n        },\n        bosses: [\n            boss(0, \"Ghost\", \"A wailing ghost trying fiercely to scare you away.\", 5, 0.7),\n            boss(1, \"Skeleton Archer\", \"Rattling bones, deadly aim.\", 6, 0.75),\n            boss(2, \"Shambling Zombie\", \"Slow but impossible to put down.\", 7, 0.8),\n            boss(3, \"Tomb Spider\", \"Spins webs between coffins.\", 7, 0.85),\n            boss(4, \"Bone Golem\", \"Assembled from the remains of fallen warriors.\", 8, 0.9),\n            boss(5, \"Banshee\", \"Her scream can freeze blood.\", 8, 0.95),\n            boss(6, \"Crypt Knight\", \"Still guards his king's tomb. In full plate.\", 9, 1.0),\n            boss(7, \"Wraith\", \"Phases through walls. Ignores armor.\", 10, 1.05),\n            boss(8, \"Lich Apprentice\", \"Learning dark magic. Already dangerous.\", 10, 1.1),\n            boss(9, \"Necromancer Voss\", \"He raised the dead. Now they serve.\", 12, 1.2)\n        ]\n    },\n    /* 3. Fungal Grotto ──────────────────── */ {\n        id: \"fungal_grotto\",\n        name: \"Fungal Grotto\",\n        subtitle: \"The spores whisper secrets\",\n        minLevel: 10,\n        staminaCost: 14,\n        prevDungeonId: \"desecrated_catacombs\",\n        theme: {\n            gradient: \"from-lime-900 via-green-800 to-lime-950\",\n            cardBg: \"from-lime-950/90 via-green-950/80 to-slate-950/90\",\n            accent: \"border-lime-500/70 shadow-lime-500/30\",\n            glowColor: \"ring-lime-400/50\",\n            borderGlow: \"hover:shadow-lime-500/20\",\n            icon: \"\\uD83C\\uDF44\"\n        },\n        bosses: [\n            boss(0, \"Spore Sprite\", \"Tiny, glowing, toxic.\", 10, 0.8),\n            boss(1, \"Mushroom Brute\", \"Thick cap. Thicker skull.\", 11, 0.85),\n            boss(2, \"Vine Strangler\", \"Wraps around legs. Squeezes.\", 12, 0.9),\n            boss(3, \"Poison Toad\", \"One lick and you see colors.\", 12, 0.95),\n            boss(4, \"Mycelium Golem\", \"A walking ecosystem.\", 13, 1.0),\n            boss(5, \"Rot Witch\", \"Brews potions from decay.\", 13, 1.05),\n            boss(6, \"Fungal Hydra\", \"Cut one head — two sprout. Covered in mold.\", 14, 1.1),\n            boss(7, \"Sporeling Hive Mind\", \"Thousands of tiny spores, one terrible will.\", 15, 1.15),\n            boss(8, \"Blight Treant\", \"The ancient tree fell to corruption.\", 15, 1.2),\n            boss(9, \"The Overgrowth\", \"The grotto itself fights back.\", 17, 1.35)\n        ]\n    },\n    /* 4. Scorched Mines ─────────────────── */ {\n        id: \"scorched_mines\",\n        name: \"Scorched Mines\",\n        subtitle: \"Heat rises from below\",\n        minLevel: 15,\n        staminaCost: 16,\n        prevDungeonId: \"fungal_grotto\",\n        theme: {\n            gradient: \"from-orange-900 via-red-800 to-orange-950\",\n            cardBg: \"from-orange-950/90 via-red-950/80 to-slate-950/90\",\n            accent: \"border-orange-500/70 shadow-orange-500/30\",\n            glowColor: \"ring-orange-400/50\",\n            borderGlow: \"hover:shadow-orange-500/20\",\n            icon: \"\\uD83D\\uDD25\"\n        },\n        bosses: [\n            boss(0, \"Ember Rat\", \"Fast, burning, bites.\", 15, 0.9),\n            boss(1, \"Magma Slime\", \"Bubbles and burns everything it touches.\", 16, 0.95),\n            boss(2, \"Mine Foreman\", \"Swings a red-hot pickaxe.\", 17, 1.0),\n            boss(3, \"Lava Beetle\", \"Its shell is molten rock.\", 17, 1.05),\n            boss(4, \"Cinder Elemental\", \"Pure fire given hateful form.\", 18, 1.1),\n            boss(5, \"Soot Dragon Whelp\", \"Not full-grown. Still very hot.\", 18, 1.15),\n            boss(6, \"Obsidian Guardian\", \"Ancient golem fused from volcanic glass.\", 19, 1.2),\n            boss(7, \"Flame Witch\", \"Dances through fire. Controls it.\", 20, 1.25),\n            boss(8, \"Infernal Siege Engine\", \"A mining machine possessed by fire spirits.\", 20, 1.3),\n            boss(9, \"Pyrax the Molten King\", \"The mines bow to him. So does the lava.\", 22, 1.45)\n        ]\n    },\n    /* 5. Frozen Abyss ───────────────────── */ {\n        id: \"frozen_abyss\",\n        name: \"Frozen Abyss\",\n        subtitle: \"Where even fire freezes\",\n        minLevel: 20,\n        staminaCost: 18,\n        prevDungeonId: \"scorched_mines\",\n        theme: {\n            gradient: \"from-blue-900 via-sky-800 to-blue-950\",\n            cardBg: \"from-blue-950/90 via-sky-950/80 to-slate-950/90\",\n            accent: \"border-blue-500/70 shadow-blue-500/30\",\n            glowColor: \"ring-blue-400/50\",\n            borderGlow: \"hover:shadow-blue-500/20\",\n            icon: \"❄️\"\n        },\n        bosses: [\n            boss(0, \"Frost Wisp\", \"A floating shard of cold.\", 20, 1.0),\n            boss(1, \"Ice Wolf\", \"Hunts in frozen packs.\", 21, 1.05),\n            boss(2, \"Glacier Troll\", \"Covered in ice. Hits like an avalanche.\", 22, 1.1),\n            boss(3, \"Frozen Sentinel\", \"A soldier trapped in ice, still fighting.\", 22, 1.15),\n            boss(4, \"Blizzard Harpy\", \"Shrieks bring hail.\", 23, 1.2),\n            boss(5, \"Crystal Golem\", \"Each facet reflects a different death.\", 23, 1.25),\n            boss(6, \"Frost Wyvern\", \"Breathes freezing fog.\", 24, 1.3),\n            boss(7, \"Ice Lich\", \"Master of cold magic.\", 25, 1.35),\n            boss(8, \"Permafrost Colossus\", \"Hasn't moved in centuries. Until now.\", 25, 1.4),\n            boss(9, \"Glacius the Eternal\", \"Winter incarnate. The abyss itself.\", 27, 1.55)\n        ]\n    },\n    /* 6. Realm of Light ─────────────────── */ {\n        id: \"realm_of_light\",\n        name: \"Realm of Light\",\n        subtitle: \"Where light burns brighter than fire\",\n        minLevel: 25,\n        staminaCost: 20,\n        prevDungeonId: \"frozen_abyss\",\n        theme: {\n            gradient: \"from-amber-900 via-yellow-800 to-amber-950\",\n            cardBg: \"from-amber-950/90 via-yellow-950/80 to-slate-950/90\",\n            accent: \"border-amber-500/70 shadow-amber-500/30\",\n            glowColor: \"ring-amber-400/50\",\n            borderGlow: \"hover:shadow-amber-500/20\",\n            icon: \"✨\"\n        },\n        bosses: [\n            boss(0, \"Light Sprite\", \"Blindingly fast, blindingly bright.\", 25, 1.1),\n            boss(1, \"Radiant Archer\", \"Arrows of pure light.\", 26, 1.15),\n            boss(2, \"Crystal Beast\", \"Reflects attacks as beams.\", 27, 1.2),\n            boss(3, \"Solar Monk\", \"Channels the sun through fists.\", 27, 1.25),\n            boss(4, \"Golden Golem\", \"Forged from holy metal.\", 28, 1.3),\n            boss(5, \"Seraph Guardian\", \"An angel that asks no questions.\", 28, 1.35),\n            boss(6, \"Prism Dragon\", \"Each scale bends light into weapons.\", 29, 1.4),\n            boss(7, \"Light Weaver\", \"Stitches reality with radiance.\", 30, 1.45),\n            boss(8, \"Solar Colossus\", \"The temple's last defender.\", 30, 1.5),\n            boss(9, \"The Heart of the Ray\", \"An artifact given life. Burning judgment.\", 32, 1.65)\n        ]\n    },\n    /* 7. Shadow Realm ───────────────────── */ {\n        id: \"shadow_realm\",\n        name: \"Shadow Realm\",\n        subtitle: \"Where the darkness stares back\",\n        minLevel: 30,\n        staminaCost: 22,\n        prevDungeonId: \"realm_of_light\",\n        theme: {\n            gradient: \"from-purple-900 via-violet-800 to-purple-950\",\n            cardBg: \"from-purple-950/90 via-violet-950/80 to-slate-950/90\",\n            accent: \"border-purple-500/70 shadow-purple-500/30\",\n            glowColor: \"ring-purple-400/50\",\n            borderGlow: \"hover:shadow-purple-500/20\",\n            icon: \"\\uD83C\\uDF11\"\n        },\n        bosses: [\n            boss(0, \"Shadow Wisp\", \"A fragment of a nightmare.\", 30, 1.2),\n            boss(1, \"Dark Stalker\", \"Hunts by sound. Silent footsteps.\", 31, 1.25),\n            boss(2, \"Void Spider\", \"Webs that devour light.\", 32, 1.3),\n            boss(3, \"Shade Knight\", \"Your own silhouette, armored.\", 32, 1.35),\n            boss(4, \"Eclipse Wolf\", \"Born from a sunless sky.\", 33, 1.4),\n            boss(5, \"Nightborne Mage\", \"Spells woven from absolute darkness.\", 33, 1.45),\n            boss(6, \"Abyss Hydra\", \"Each head a different fear.\", 34, 1.5),\n            boss(7, \"Shadow Dragon\", \"Breathes oblivion.\", 35, 1.55),\n            boss(8, \"Void Colossus\", \"Where it steps, nothing remains.\", 35, 1.6),\n            boss(9, \"The Whispering Dark\", \"Not a creature. A place. That hates.\", 37, 1.75)\n        ]\n    },\n    /* 8. Clockwork Citadel ──────────────── */ {\n        id: \"clockwork_citadel\",\n        name: \"Clockwork Citadel\",\n        subtitle: \"Gears never stop turning\",\n        minLevel: 35,\n        staminaCost: 24,\n        prevDungeonId: \"shadow_realm\",\n        theme: {\n            gradient: \"from-zinc-800 via-neutral-700 to-zinc-900\",\n            cardBg: \"from-zinc-900/90 via-neutral-900/80 to-slate-950/90\",\n            accent: \"border-zinc-400/70 shadow-zinc-400/30\",\n            glowColor: \"ring-zinc-300/50\",\n            borderGlow: \"hover:shadow-zinc-400/20\",\n            icon: \"⚙️\"\n        },\n        bosses: [\n            boss(0, \"Gear Sprite\", \"Tiny, fast, sparking.\", 35, 1.3),\n            boss(1, \"Clockwork Hound\", \"Metal teeth, spring-loaded jaws.\", 36, 1.35),\n            boss(2, \"Piston Golem\", \"Each punch backed by steam pressure.\", 37, 1.4),\n            boss(3, \"Sawblade Dancer\", \"Spinning blades, deadly rhythm.\", 37, 1.45),\n            boss(4, \"Tesla Turret\", \"Zaps anything that moves.\", 38, 1.5),\n            boss(5, \"Steam Knight\", \"Hisses, clanks, annihilates.\", 38, 1.55),\n            boss(6, \"Gear Dragon\", \"Wings of interlocking cogs.\", 39, 1.6),\n            boss(7, \"Grand Mechanist\", \"Builder of nightmares.\", 40, 1.65),\n            boss(8, \"Siege Automaton\", \"A walking fortress of brass and fury.\", 40, 1.7),\n            boss(9, \"The Grand Engine\", \"The citadel's heart. Infinite gears. One mind.\", 42, 1.85)\n        ]\n    },\n    /* 9. Abyssal Depths ─────────────────── */ {\n        id: \"abyssal_depths\",\n        name: \"Abyssal Depths\",\n        subtitle: \"Beneath the world, something waits\",\n        minLevel: 40,\n        staminaCost: 26,\n        prevDungeonId: \"clockwork_citadel\",\n        theme: {\n            gradient: \"from-indigo-900 via-blue-900 to-indigo-950\",\n            cardBg: \"from-indigo-950/90 via-blue-950/80 to-slate-950/90\",\n            accent: \"border-indigo-500/70 shadow-indigo-500/30\",\n            glowColor: \"ring-indigo-400/50\",\n            borderGlow: \"hover:shadow-indigo-500/20\",\n            icon: \"\\uD83C\\uDF0A\"\n        },\n        bosses: [\n            boss(0, \"Depth Crawler\", \"Skitters across the ocean floor.\", 40, 1.4),\n            boss(1, \"Angler Horror\", \"Its light lures. Its jaws close.\", 41, 1.45),\n            boss(2, \"Coral Golem\", \"Living reef with a grudge.\", 42, 1.5),\n            boss(3, \"Siren\", \"Her song drowns reason.\", 42, 1.55),\n            boss(4, \"Kraken Spawn\", \"One tentacle from something much larger.\", 43, 1.6),\n            boss(5, \"Abyssal Leviathan\", \"A whale-sized predator with a temper.\", 43, 1.65),\n            boss(6, \"Deep Sea Dragon\", \"Scales covered in barnacles and fury.\", 44, 1.7),\n            boss(7, \"Drowned Admiral\", \"Still commands a ghost fleet.\", 45, 1.75),\n            boss(8, \"Tidal Colossus\", \"The ocean given legs.\", 45, 1.8),\n            boss(9, \"Charybdis the Devourer\", \"The abyss opens. Everything falls in.\", 47, 1.95)\n        ]\n    },\n    /* 10. Infernal Throne ───────────────── */ {\n        id: \"infernal_throne\",\n        name: \"Infernal Throne\",\n        subtitle: \"The final descent into madness\",\n        minLevel: 45,\n        staminaCost: 30,\n        prevDungeonId: \"abyssal_depths\",\n        theme: {\n            gradient: \"from-red-900 via-rose-800 to-red-950\",\n            cardBg: \"from-red-950/90 via-rose-950/80 to-slate-950/90\",\n            accent: \"border-red-500/70 shadow-red-500/30\",\n            glowColor: \"ring-red-400/50\",\n            borderGlow: \"hover:shadow-red-500/20\",\n            icon: \"\\uD83D\\uDC51\"\n        },\n        bosses: [\n            boss(0, \"Imp Swarm\", \"Small, vicious, everywhere.\", 45, 1.5),\n            boss(1, \"Hellhound Alpha\", \"Three heads, triple the fury.\", 46, 1.55),\n            boss(2, \"Flame Demoness\", \"Beauty and annihilation.\", 47, 1.6),\n            boss(3, \"Iron Demon\", \"Forged in infernal pits.\", 47, 1.65),\n            boss(4, \"Pit Fiend\", \"Commander of lesser demons.\", 48, 1.7),\n            boss(5, \"Soul Reaver\", \"Steals strength from the fallen.\", 48, 1.75),\n            boss(6, \"Infernal Dragon\", \"Fire made flesh, fury made scale.\", 49, 1.8),\n            boss(7, \"Dark Seraph\", \"An angel that chose the wrong side.\", 50, 1.85),\n            boss(8, \"The Throne Guardian\", \"The last line of defense. Absolute.\", 50, 1.9),\n            boss(9, \"Archfiend Malachar\", \"He sits on the throne. He waits. He wins.\", 52, 2.1)\n        ]\n    }\n];\n/* ─── Lookup helpers ─── */ const getDungeonById = (id)=>DUNGEONS.find((d)=>d.id === id);\nconst BOSSES_PER_DUNGEON = 10;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxLQUFLLEdBQUcsa0JBQWtCLDRCQUE0QixJQUFJO1lBQzFEQSxLQUFLLEdBQUcsY0FBYyw0QkFBNEIsSUFBSTtZQUN0REEsS0FBSyxHQUFHLGFBQWEsK0JBQStCLElBQUk7WUFDeERBLEtBQUssR0FBRyxlQUFlLG9DQUFvQyxJQUFJO1lBQy9EQSxLQUFLLEdBQUcsbUJBQW1CLHFDQUFxQyxJQUFJO1lBQ3BFQSxLQUFLLEdBQUcsZUFBZSx1Q0FBdUMsSUFBSTtZQUNsRUEsS0FBSyxHQUFHLHVCQUF1Qix1Q0FBdUMsSUFBSTtZQUMxRUEsS0FBSyxHQUFHLHNCQUFzQiw2Q0FBNkMsSUFBSTtTQUNoRjtJQUNIO0NBQ0QsQ0FBQztBQUVGLDBCQUEwQixHQUVuQixNQUFNc0IsaUJBQWlCLENBQUNiLEtBQzdCRCxTQUFTZSxJQUFJLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRWYsRUFBRSxLQUFLQSxJQUFJO0FBRTdCLE1BQU1nQixxQkFBcUIsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2lyb24tZmlzdC1hcmVuYS8uL2xpYi9nYW1lL2R1bmdlb24tZGF0YS50cz82ZjNlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBTdGF0aWMgZHVuZ2VvbiAmIGJvc3MgZGVmaW5pdGlvbnMuXG4gKiAgRWFjaCBkdW5nZW9uIGhhcyAxMCBib3NzZXMgYmVhdGVuIHNlcXVlbnRpYWxseS5cbiAqICBVbmxvY2sgY2hhaW46IHByZXZEdW5nZW9uSWQgbXVzdCBiZSBjb21wbGV0ZWQgKDEwLzEwKSB0byB1bmxvY2sgbmV4dC4gKi9cblxuLyog4pSA4pSA4pSAIFR5cGVzIOKUgOKUgOKUgCAqL1xuXG5leHBvcnQgdHlwZSBEdW5nZW9uQm9zcyA9IHtcbiAgaW5kZXg6IG51bWJlcjsgLy8gMC05XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgbGV2ZWw6IG51bWJlcjtcbiAgc3RhdE11bHRpcGxpZXI6IG51bWJlcjsgLy8gU2NhbGluZyBmYWN0b3IgZm9yIGJvc3Mgc3RhdHNcbn07XG5cbmV4cG9ydCB0eXBlIER1bmdlb25UaGVtZSA9IHtcbiAgZ3JhZGllbnQ6IHN0cmluZztcbiAgY2FyZEJnOiBzdHJpbmc7XG4gIGFjY2VudDogc3RyaW5nO1xuICBnbG93Q29sb3I6IHN0cmluZztcbiAgYm9yZGVyR2xvdzogc3RyaW5nO1xuICBpY29uOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBEdW5nZW9uRGVmaW5pdGlvbiA9IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzdWJ0aXRsZTogc3RyaW5nO1xuICBtaW5MZXZlbDogbnVtYmVyO1xuICBzdGFtaW5hQ29zdDogbnVtYmVyO1xuICBwcmV2RHVuZ2VvbklkOiBzdHJpbmcgfCBudWxsO1xuICBib3NzZXM6IER1bmdlb25Cb3NzW107XG4gIHRoZW1lOiBEdW5nZW9uVGhlbWU7XG59O1xuXG4vKiDilIDilIDilIAgQm9zcyBoZWxwZXIg4pSA4pSA4pSAICovXG5cbmNvbnN0IGJvc3MgPSAoXG4gIGluZGV4OiBudW1iZXIsXG4gIG5hbWU6IHN0cmluZyxcbiAgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgYmFzZUxldmVsOiBudW1iZXIsXG4gIG11bHQ6IG51bWJlcixcbik6IER1bmdlb25Cb3NzID0+ICh7XG4gIGluZGV4LFxuICBuYW1lLFxuICBkZXNjcmlwdGlvbixcbiAgbGV2ZWw6IGJhc2VMZXZlbCArIGluZGV4LFxuICBzdGF0TXVsdGlwbGllcjogbXVsdCArIGluZGV4ICogMC4xNSxcbn0pO1xuXG4vKiDilIDilIDilIAgRHVuZ2VvbiBjYXRhbG9ndWUg4pSA4pSA4pSAICovXG5cbmV4cG9ydCBjb25zdCBEVU5HRU9OUzogRHVuZ2VvbkRlZmluaXRpb25bXSA9IFtcbiAgLyogMS4gVHJhaW5pbmcgQ2FtcCDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbiAge1xuICAgIGlkOiBcInRyYWluaW5nX2NhbXBcIixcbiAgICBuYW1lOiBcIlRyYWluaW5nIENhbXBcIixcbiAgICBzdWJ0aXRsZTogXCJXaGVyZSBwdXBzIGJlY29tZSB3YXJyaW9yc1wiLFxuICAgIG1pbkxldmVsOiAxLFxuICAgIHN0YW1pbmFDb3N0OiAxMCxcbiAgICBwcmV2RHVuZ2VvbklkOiBudWxsLFxuICAgIHRoZW1lOiB7XG4gICAgICBncmFkaWVudDogXCJmcm9tLWdyZWVuLTkwMCB2aWEtZW1lcmFsZC04MDAgdG8tZ3JlZW4tOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1ncmVlbi05NTAvOTAgdmlhLWVtZXJhbGQtOTUwLzgwIHRvLXNsYXRlLTk1MC85MFwiLFxuICAgICAgYWNjZW50OiBcImJvcmRlci1ncmVlbi01MDAvNzAgc2hhZG93LWdyZWVuLTUwMC8zMFwiLFxuICAgICAgZ2xvd0NvbG9yOiBcInJpbmctZ3JlZW4tNDAwLzUwXCIsXG4gICAgICBib3JkZXJHbG93OiBcImhvdmVyOnNoYWRvdy1ncmVlbi01MDAvMjBcIixcbiAgICAgIGljb246IFwi8J+Ple+4j1wiLFxuICAgIH0sXG4gICAgYm9zc2VzOiBbXG4gICAgICBib3NzKDAsIFwiU3RyYXcgRHVtbXlcIiwgXCJBIGxpZmVsZXNzIHRhcmdldCDigJQgdW50aWwgdGhlIHdpbmQgcGlja3MgdXAuXCIsIDEsIDAuNSksXG4gICAgICBib3NzKDEsIFwiUnVzdHkgQXV0b21hdG9uXCIsIFwiR2VhcnMgY3JlYWsuIEJsYWRlcyBzcGluLiBTbG93bHkuXCIsIDIsIDAuNTUpLFxuICAgICAgYm9zcygyLCBcIkJhcnJlbCBHb2xlbVwiLCBcIkFzc2VtYmxlZCBmcm9tIG9sZCBjYXNrcyBhbmQgc3BpdGUuXCIsIDMsIDAuNiksXG4gICAgICBib3NzKDMsIFwiUGxhbmsgS25pZ2h0XCIsIFwiSGVsZCB0b2dldGhlciBieSBydXN0eSBuYWlscyBhbmQgZGV0ZXJtaW5hdGlvbi5cIiwgMywgMC42NSksXG4gICAgICBib3NzKDQsIFwiRmx5aW5nIEZyYW5jaXNcIiwgXCJCdXp6ZXMgYW5kIHN0YWdnZXJzIHRocm91Z2ggdGhlIGFpci4gQSBjcmFzaCBsYW5kaW5nIGlzIHVuYXZvaWRhYmxlLlwiLCA0LCAwLjcpLFxuICAgICAgYm9zcyg1LCBcIlNjYXJlY3JvdyBNYWdlXCIsIFwiV2F2ZXMgYSBzdGljay4gU3BhcmtzIG9jY2FzaW9uYWxseSBmbHkuXCIsIDQsIDAuNzUpLFxuICAgICAgYm9zcyg2LCBcIk11ZCBUcm9sbFwiLCBcIlNsb3csIHN0aWNreSwgc3VycHJpc2luZ2x5IGFnZ3Jlc3NpdmUuXCIsIDUsIDAuOCksXG4gICAgICBib3NzKDcsIFwiUG9zc2Vzc2VkIE1hbm5lcXVpblwiLCBcIlRoZXkgc2F5IGl0IGJsaW5rcyB3aGVuIHlvdSBsb29rIGF3YXkuXCIsIDUsIDAuODUpLFxuICAgICAgYm9zcyg4LCBcIklyb24gRHVtbXlcIiwgXCJVcGdyYWRlZC4gRGFuZ2Vyb3VzLiBTdGlsbCBoYXMgc3RyYXcgaGFpci5cIiwgNiwgMC45KSxcbiAgICAgIGJvc3MoOSwgXCJEcmlsbCBTZXJnZWFudCBHcml6emxlXCIsIFwiVGhlIHJlYWwgYm9zcy4gUmV0aXJlZCBmcm9tIHRoZSBhcmVuYS4gU3RpbGwgdGVycmlmeWluZy5cIiwgNywgMS4wKSxcbiAgICBdLFxuICB9LFxuXG4gIC8qIDIuIERlc2VjcmF0ZWQgQ2F0YWNvbWJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuICB7XG4gICAgaWQ6IFwiZGVzZWNyYXRlZF9jYXRhY29tYnNcIixcbiAgICBuYW1lOiBcIkRlc2VjcmF0ZWQgQ2F0YWNvbWJzXCIsXG4gICAgc3VidGl0bGU6IFwiV2hlcmUgdGhlIGRlYWQgcmVmdXNlIHRvIHJlc3RcIixcbiAgICBtaW5MZXZlbDogNSxcbiAgICBzdGFtaW5hQ29zdDogMTIsXG4gICAgcHJldkR1bmdlb25JZDogXCJ0cmFpbmluZ19jYW1wXCIsXG4gICAgdGhlbWU6IHtcbiAgICAgIGdyYWRpZW50OiBcImZyb20tY3lhbi05MDAgdmlhLXRlYWwtODAwIHRvLWN5YW4tOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1jeWFuLTk1MC85MCB2aWEtdGVhbC05NTAvODAgdG8tc2xhdGUtOTUwLzkwXCIsXG4gICAgICBhY2NlbnQ6IFwiYm9yZGVyLWN5YW4tNTAwLzcwIHNoYWRvdy1jeWFuLTUwMC8zMFwiLFxuICAgICAgZ2xvd0NvbG9yOiBcInJpbmctY3lhbi00MDAvNTBcIixcbiAgICAgIGJvcmRlckdsb3c6IFwiaG92ZXI6c2hhZG93LWN5YW4tNTAwLzIwXCIsXG4gICAgICBpY29uOiBcIvCfkoBcIixcbiAgICB9LFxuICAgIGJvc3NlczogW1xuICAgICAgYm9zcygwLCBcIkdob3N0XCIsIFwiQSB3YWlsaW5nIGdob3N0IHRyeWluZyBmaWVyY2VseSB0byBzY2FyZSB5b3UgYXdheS5cIiwgNSwgMC43KSxcbiAgICAgIGJvc3MoMSwgXCJTa2VsZXRvbiBBcmNoZXJcIiwgXCJSYXR0bGluZyBib25lcywgZGVhZGx5IGFpbS5cIiwgNiwgMC43NSksXG4gICAgICBib3NzKDIsIFwiU2hhbWJsaW5nIFpvbWJpZVwiLCBcIlNsb3cgYnV0IGltcG9zc2libGUgdG8gcHV0IGRvd24uXCIsIDcsIDAuOCksXG4gICAgICBib3NzKDMsIFwiVG9tYiBTcGlkZXJcIiwgXCJTcGlucyB3ZWJzIGJldHdlZW4gY29mZmlucy5cIiwgNywgMC44NSksXG4gICAgICBib3NzKDQsIFwiQm9uZSBHb2xlbVwiLCBcIkFzc2VtYmxlZCBmcm9tIHRoZSByZW1haW5zIG9mIGZhbGxlbiB3YXJyaW9ycy5cIiwgOCwgMC45KSxcbiAgICAgIGJvc3MoNSwgXCJCYW5zaGVlXCIsIFwiSGVyIHNjcmVhbSBjYW4gZnJlZXplIGJsb29kLlwiLCA4LCAwLjk1KSxcbiAgICAgIGJvc3MoNiwgXCJDcnlwdCBLbmlnaHRcIiwgXCJTdGlsbCBndWFyZHMgaGlzIGtpbmcncyB0b21iLiBJbiBmdWxsIHBsYXRlLlwiLCA5LCAxLjApLFxuICAgICAgYm9zcyg3LCBcIldyYWl0aFwiLCBcIlBoYXNlcyB0aHJvdWdoIHdhbGxzLiBJZ25vcmVzIGFybW9yLlwiLCAxMCwgMS4wNSksXG4gICAgICBib3NzKDgsIFwiTGljaCBBcHByZW50aWNlXCIsIFwiTGVhcm5pbmcgZGFyayBtYWdpYy4gQWxyZWFkeSBkYW5nZXJvdXMuXCIsIDEwLCAxLjEpLFxuICAgICAgYm9zcyg5LCBcIk5lY3JvbWFuY2VyIFZvc3NcIiwgXCJIZSByYWlzZWQgdGhlIGRlYWQuIE5vdyB0aGV5IHNlcnZlLlwiLCAxMiwgMS4yKSxcbiAgICBdLFxuICB9LFxuXG4gIC8qIDMuIEZ1bmdhbCBHcm90dG8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG4gIHtcbiAgICBpZDogXCJmdW5nYWxfZ3JvdHRvXCIsXG4gICAgbmFtZTogXCJGdW5nYWwgR3JvdHRvXCIsXG4gICAgc3VidGl0bGU6IFwiVGhlIHNwb3JlcyB3aGlzcGVyIHNlY3JldHNcIixcbiAgICBtaW5MZXZlbDogMTAsXG4gICAgc3RhbWluYUNvc3Q6IDE0LFxuICAgIHByZXZEdW5nZW9uSWQ6IFwiZGVzZWNyYXRlZF9jYXRhY29tYnNcIixcbiAgICB0aGVtZToge1xuICAgICAgZ3JhZGllbnQ6IFwiZnJvbS1saW1lLTkwMCB2aWEtZ3JlZW4tODAwIHRvLWxpbWUtOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1saW1lLTk1MC85MCB2aWEtZ3JlZW4tOTUwLzgwIHRvLXNsYXRlLTk1MC85MFwiLFxuICAgICAgYWNjZW50OiBcImJvcmRlci1saW1lLTUwMC83MCBzaGFkb3ctbGltZS01MDAvMzBcIixcbiAgICAgIGdsb3dDb2xvcjogXCJyaW5nLWxpbWUtNDAwLzUwXCIsXG4gICAgICBib3JkZXJHbG93OiBcImhvdmVyOnNoYWRvdy1saW1lLTUwMC8yMFwiLFxuICAgICAgaWNvbjogXCLwn42EXCIsXG4gICAgfSxcbiAgICBib3NzZXM6IFtcbiAgICAgIGJvc3MoMCwgXCJTcG9yZSBTcHJpdGVcIiwgXCJUaW55LCBnbG93aW5nLCB0b3hpYy5cIiwgMTAsIDAuOCksXG4gICAgICBib3NzKDEsIFwiTXVzaHJvb20gQnJ1dGVcIiwgXCJUaGljayBjYXAuIFRoaWNrZXIgc2t1bGwuXCIsIDExLCAwLjg1KSxcbiAgICAgIGJvc3MoMiwgXCJWaW5lIFN0cmFuZ2xlclwiLCBcIldyYXBzIGFyb3VuZCBsZWdzLiBTcXVlZXplcy5cIiwgMTIsIDAuOSksXG4gICAgICBib3NzKDMsIFwiUG9pc29uIFRvYWRcIiwgXCJPbmUgbGljayBhbmQgeW91IHNlZSBjb2xvcnMuXCIsIDEyLCAwLjk1KSxcbiAgICAgIGJvc3MoNCwgXCJNeWNlbGl1bSBHb2xlbVwiLCBcIkEgd2Fsa2luZyBlY29zeXN0ZW0uXCIsIDEzLCAxLjApLFxuICAgICAgYm9zcyg1LCBcIlJvdCBXaXRjaFwiLCBcIkJyZXdzIHBvdGlvbnMgZnJvbSBkZWNheS5cIiwgMTMsIDEuMDUpLFxuICAgICAgYm9zcyg2LCBcIkZ1bmdhbCBIeWRyYVwiLCBcIkN1dCBvbmUgaGVhZCDigJQgdHdvIHNwcm91dC4gQ292ZXJlZCBpbiBtb2xkLlwiLCAxNCwgMS4xKSxcbiAgICAgIGJvc3MoNywgXCJTcG9yZWxpbmcgSGl2ZSBNaW5kXCIsIFwiVGhvdXNhbmRzIG9mIHRpbnkgc3BvcmVzLCBvbmUgdGVycmlibGUgd2lsbC5cIiwgMTUsIDEuMTUpLFxuICAgICAgYm9zcyg4LCBcIkJsaWdodCBUcmVhbnRcIiwgXCJUaGUgYW5jaWVudCB0cmVlIGZlbGwgdG8gY29ycnVwdGlvbi5cIiwgMTUsIDEuMiksXG4gICAgICBib3NzKDksIFwiVGhlIE92ZXJncm93dGhcIiwgXCJUaGUgZ3JvdHRvIGl0c2VsZiBmaWdodHMgYmFjay5cIiwgMTcsIDEuMzUpLFxuICAgIF0sXG4gIH0sXG5cbiAgLyogNC4gU2NvcmNoZWQgTWluZXMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG4gIHtcbiAgICBpZDogXCJzY29yY2hlZF9taW5lc1wiLFxuICAgIG5hbWU6IFwiU2NvcmNoZWQgTWluZXNcIixcbiAgICBzdWJ0aXRsZTogXCJIZWF0IHJpc2VzIGZyb20gYmVsb3dcIixcbiAgICBtaW5MZXZlbDogMTUsXG4gICAgc3RhbWluYUNvc3Q6IDE2LFxuICAgIHByZXZEdW5nZW9uSWQ6IFwiZnVuZ2FsX2dyb3R0b1wiLFxuICAgIHRoZW1lOiB7XG4gICAgICBncmFkaWVudDogXCJmcm9tLW9yYW5nZS05MDAgdmlhLXJlZC04MDAgdG8tb3JhbmdlLTk1MFwiLFxuICAgICAgY2FyZEJnOiBcImZyb20tb3JhbmdlLTk1MC85MCB2aWEtcmVkLTk1MC84MCB0by1zbGF0ZS05NTAvOTBcIixcbiAgICAgIGFjY2VudDogXCJib3JkZXItb3JhbmdlLTUwMC83MCBzaGFkb3ctb3JhbmdlLTUwMC8zMFwiLFxuICAgICAgZ2xvd0NvbG9yOiBcInJpbmctb3JhbmdlLTQwMC81MFwiLFxuICAgICAgYm9yZGVyR2xvdzogXCJob3ZlcjpzaGFkb3ctb3JhbmdlLTUwMC8yMFwiLFxuICAgICAgaWNvbjogXCLwn5SlXCIsXG4gICAgfSxcbiAgICBib3NzZXM6IFtcbiAgICAgIGJvc3MoMCwgXCJFbWJlciBSYXRcIiwgXCJGYXN0LCBidXJuaW5nLCBiaXRlcy5cIiwgMTUsIDAuOSksXG4gICAgICBib3NzKDEsIFwiTWFnbWEgU2xpbWVcIiwgXCJCdWJibGVzIGFuZCBidXJucyBldmVyeXRoaW5nIGl0IHRvdWNoZXMuXCIsIDE2LCAwLjk1KSxcbiAgICAgIGJvc3MoMiwgXCJNaW5lIEZvcmVtYW5cIiwgXCJTd2luZ3MgYSByZWQtaG90IHBpY2theGUuXCIsIDE3LCAxLjApLFxuICAgICAgYm9zcygzLCBcIkxhdmEgQmVldGxlXCIsIFwiSXRzIHNoZWxsIGlzIG1vbHRlbiByb2NrLlwiLCAxNywgMS4wNSksXG4gICAgICBib3NzKDQsIFwiQ2luZGVyIEVsZW1lbnRhbFwiLCBcIlB1cmUgZmlyZSBnaXZlbiBoYXRlZnVsIGZvcm0uXCIsIDE4LCAxLjEpLFxuICAgICAgYm9zcyg1LCBcIlNvb3QgRHJhZ29uIFdoZWxwXCIsIFwiTm90IGZ1bGwtZ3Jvd24uIFN0aWxsIHZlcnkgaG90LlwiLCAxOCwgMS4xNSksXG4gICAgICBib3NzKDYsIFwiT2JzaWRpYW4gR3VhcmRpYW5cIiwgXCJBbmNpZW50IGdvbGVtIGZ1c2VkIGZyb20gdm9sY2FuaWMgZ2xhc3MuXCIsIDE5LCAxLjIpLFxuICAgICAgYm9zcyg3LCBcIkZsYW1lIFdpdGNoXCIsIFwiRGFuY2VzIHRocm91Z2ggZmlyZS4gQ29udHJvbHMgaXQuXCIsIDIwLCAxLjI1KSxcbiAgICAgIGJvc3MoOCwgXCJJbmZlcm5hbCBTaWVnZSBFbmdpbmVcIiwgXCJBIG1pbmluZyBtYWNoaW5lIHBvc3Nlc3NlZCBieSBmaXJlIHNwaXJpdHMuXCIsIDIwLCAxLjMpLFxuICAgICAgYm9zcyg5LCBcIlB5cmF4IHRoZSBNb2x0ZW4gS2luZ1wiLCBcIlRoZSBtaW5lcyBib3cgdG8gaGltLiBTbyBkb2VzIHRoZSBsYXZhLlwiLCAyMiwgMS40NSksXG4gICAgXSxcbiAgfSxcblxuICAvKiA1LiBGcm96ZW4gQWJ5c3Mg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG4gIHtcbiAgICBpZDogXCJmcm96ZW5fYWJ5c3NcIixcbiAgICBuYW1lOiBcIkZyb3plbiBBYnlzc1wiLFxuICAgIHN1YnRpdGxlOiBcIldoZXJlIGV2ZW4gZmlyZSBmcmVlemVzXCIsXG4gICAgbWluTGV2ZWw6IDIwLFxuICAgIHN0YW1pbmFDb3N0OiAxOCxcbiAgICBwcmV2RHVuZ2VvbklkOiBcInNjb3JjaGVkX21pbmVzXCIsXG4gICAgdGhlbWU6IHtcbiAgICAgIGdyYWRpZW50OiBcImZyb20tYmx1ZS05MDAgdmlhLXNreS04MDAgdG8tYmx1ZS05NTBcIixcbiAgICAgIGNhcmRCZzogXCJmcm9tLWJsdWUtOTUwLzkwIHZpYS1za3ktOTUwLzgwIHRvLXNsYXRlLTk1MC85MFwiLFxuICAgICAgYWNjZW50OiBcImJvcmRlci1ibHVlLTUwMC83MCBzaGFkb3ctYmx1ZS01MDAvMzBcIixcbiAgICAgIGdsb3dDb2xvcjogXCJyaW5nLWJsdWUtNDAwLzUwXCIsXG4gICAgICBib3JkZXJHbG93OiBcImhvdmVyOnNoYWRvdy1ibHVlLTUwMC8yMFwiLFxuICAgICAgaWNvbjogXCLinYTvuI9cIixcbiAgICB9LFxuICAgIGJvc3NlczogW1xuICAgICAgYm9zcygwLCBcIkZyb3N0IFdpc3BcIiwgXCJBIGZsb2F0aW5nIHNoYXJkIG9mIGNvbGQuXCIsIDIwLCAxLjApLFxuICAgICAgYm9zcygxLCBcIkljZSBXb2xmXCIsIFwiSHVudHMgaW4gZnJvemVuIHBhY2tzLlwiLCAyMSwgMS4wNSksXG4gICAgICBib3NzKDIsIFwiR2xhY2llciBUcm9sbFwiLCBcIkNvdmVyZWQgaW4gaWNlLiBIaXRzIGxpa2UgYW4gYXZhbGFuY2hlLlwiLCAyMiwgMS4xKSxcbiAgICAgIGJvc3MoMywgXCJGcm96ZW4gU2VudGluZWxcIiwgXCJBIHNvbGRpZXIgdHJhcHBlZCBpbiBpY2UsIHN0aWxsIGZpZ2h0aW5nLlwiLCAyMiwgMS4xNSksXG4gICAgICBib3NzKDQsIFwiQmxpenphcmQgSGFycHlcIiwgXCJTaHJpZWtzIGJyaW5nIGhhaWwuXCIsIDIzLCAxLjIpLFxuICAgICAgYm9zcyg1LCBcIkNyeXN0YWwgR29sZW1cIiwgXCJFYWNoIGZhY2V0IHJlZmxlY3RzIGEgZGlmZmVyZW50IGRlYXRoLlwiLCAyMywgMS4yNSksXG4gICAgICBib3NzKDYsIFwiRnJvc3QgV3l2ZXJuXCIsIFwiQnJlYXRoZXMgZnJlZXppbmcgZm9nLlwiLCAyNCwgMS4zKSxcbiAgICAgIGJvc3MoNywgXCJJY2UgTGljaFwiLCBcIk1hc3RlciBvZiBjb2xkIG1hZ2ljLlwiLCAyNSwgMS4zNSksXG4gICAgICBib3NzKDgsIFwiUGVybWFmcm9zdCBDb2xvc3N1c1wiLCBcIkhhc24ndCBtb3ZlZCBpbiBjZW50dXJpZXMuIFVudGlsIG5vdy5cIiwgMjUsIDEuNCksXG4gICAgICBib3NzKDksIFwiR2xhY2l1cyB0aGUgRXRlcm5hbFwiLCBcIldpbnRlciBpbmNhcm5hdGUuIFRoZSBhYnlzcyBpdHNlbGYuXCIsIDI3LCAxLjU1KSxcbiAgICBdLFxuICB9LFxuXG4gIC8qIDYuIFJlYWxtIG9mIExpZ2h0IOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuICB7XG4gICAgaWQ6IFwicmVhbG1fb2ZfbGlnaHRcIixcbiAgICBuYW1lOiBcIlJlYWxtIG9mIExpZ2h0XCIsXG4gICAgc3VidGl0bGU6IFwiV2hlcmUgbGlnaHQgYnVybnMgYnJpZ2h0ZXIgdGhhbiBmaXJlXCIsXG4gICAgbWluTGV2ZWw6IDI1LFxuICAgIHN0YW1pbmFDb3N0OiAyMCxcbiAgICBwcmV2RHVuZ2VvbklkOiBcImZyb3plbl9hYnlzc1wiLFxuICAgIHRoZW1lOiB7XG4gICAgICBncmFkaWVudDogXCJmcm9tLWFtYmVyLTkwMCB2aWEteWVsbG93LTgwMCB0by1hbWJlci05NTBcIixcbiAgICAgIGNhcmRCZzogXCJmcm9tLWFtYmVyLTk1MC85MCB2aWEteWVsbG93LTk1MC84MCB0by1zbGF0ZS05NTAvOTBcIixcbiAgICAgIGFjY2VudDogXCJib3JkZXItYW1iZXItNTAwLzcwIHNoYWRvdy1hbWJlci01MDAvMzBcIixcbiAgICAgIGdsb3dDb2xvcjogXCJyaW5nLWFtYmVyLTQwMC81MFwiLFxuICAgICAgYm9yZGVyR2xvdzogXCJob3ZlcjpzaGFkb3ctYW1iZXItNTAwLzIwXCIsXG4gICAgICBpY29uOiBcIuKcqFwiLFxuICAgIH0sXG4gICAgYm9zc2VzOiBbXG4gICAgICBib3NzKDAsIFwiTGlnaHQgU3ByaXRlXCIsIFwiQmxpbmRpbmdseSBmYXN0LCBibGluZGluZ2x5IGJyaWdodC5cIiwgMjUsIDEuMSksXG4gICAgICBib3NzKDEsIFwiUmFkaWFudCBBcmNoZXJcIiwgXCJBcnJvd3Mgb2YgcHVyZSBsaWdodC5cIiwgMjYsIDEuMTUpLFxuICAgICAgYm9zcygyLCBcIkNyeXN0YWwgQmVhc3RcIiwgXCJSZWZsZWN0cyBhdHRhY2tzIGFzIGJlYW1zLlwiLCAyNywgMS4yKSxcbiAgICAgIGJvc3MoMywgXCJTb2xhciBNb25rXCIsIFwiQ2hhbm5lbHMgdGhlIHN1biB0aHJvdWdoIGZpc3RzLlwiLCAyNywgMS4yNSksXG4gICAgICBib3NzKDQsIFwiR29sZGVuIEdvbGVtXCIsIFwiRm9yZ2VkIGZyb20gaG9seSBtZXRhbC5cIiwgMjgsIDEuMyksXG4gICAgICBib3NzKDUsIFwiU2VyYXBoIEd1YXJkaWFuXCIsIFwiQW4gYW5nZWwgdGhhdCBhc2tzIG5vIHF1ZXN0aW9ucy5cIiwgMjgsIDEuMzUpLFxuICAgICAgYm9zcyg2LCBcIlByaXNtIERyYWdvblwiLCBcIkVhY2ggc2NhbGUgYmVuZHMgbGlnaHQgaW50byB3ZWFwb25zLlwiLCAyOSwgMS40KSxcbiAgICAgIGJvc3MoNywgXCJMaWdodCBXZWF2ZXJcIiwgXCJTdGl0Y2hlcyByZWFsaXR5IHdpdGggcmFkaWFuY2UuXCIsIDMwLCAxLjQ1KSxcbiAgICAgIGJvc3MoOCwgXCJTb2xhciBDb2xvc3N1c1wiLCBcIlRoZSB0ZW1wbGUncyBsYXN0IGRlZmVuZGVyLlwiLCAzMCwgMS41KSxcbiAgICAgIGJvc3MoOSwgXCJUaGUgSGVhcnQgb2YgdGhlIFJheVwiLCBcIkFuIGFydGlmYWN0IGdpdmVuIGxpZmUuIEJ1cm5pbmcganVkZ21lbnQuXCIsIDMyLCAxLjY1KSxcbiAgICBdLFxuICB9LFxuXG4gIC8qIDcuIFNoYWRvdyBSZWFsbSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbiAge1xuICAgIGlkOiBcInNoYWRvd19yZWFsbVwiLFxuICAgIG5hbWU6IFwiU2hhZG93IFJlYWxtXCIsXG4gICAgc3VidGl0bGU6IFwiV2hlcmUgdGhlIGRhcmtuZXNzIHN0YXJlcyBiYWNrXCIsXG4gICAgbWluTGV2ZWw6IDMwLFxuICAgIHN0YW1pbmFDb3N0OiAyMixcbiAgICBwcmV2RHVuZ2VvbklkOiBcInJlYWxtX29mX2xpZ2h0XCIsXG4gICAgdGhlbWU6IHtcbiAgICAgIGdyYWRpZW50OiBcImZyb20tcHVycGxlLTkwMCB2aWEtdmlvbGV0LTgwMCB0by1wdXJwbGUtOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1wdXJwbGUtOTUwLzkwIHZpYS12aW9sZXQtOTUwLzgwIHRvLXNsYXRlLTk1MC85MFwiLFxuICAgICAgYWNjZW50OiBcImJvcmRlci1wdXJwbGUtNTAwLzcwIHNoYWRvdy1wdXJwbGUtNTAwLzMwXCIsXG4gICAgICBnbG93Q29sb3I6IFwicmluZy1wdXJwbGUtNDAwLzUwXCIsXG4gICAgICBib3JkZXJHbG93OiBcImhvdmVyOnNoYWRvdy1wdXJwbGUtNTAwLzIwXCIsXG4gICAgICBpY29uOiBcIvCfjJFcIixcbiAgICB9LFxuICAgIGJvc3NlczogW1xuICAgICAgYm9zcygwLCBcIlNoYWRvdyBXaXNwXCIsIFwiQSBmcmFnbWVudCBvZiBhIG5pZ2h0bWFyZS5cIiwgMzAsIDEuMiksXG4gICAgICBib3NzKDEsIFwiRGFyayBTdGFsa2VyXCIsIFwiSHVudHMgYnkgc291bmQuIFNpbGVudCBmb290c3RlcHMuXCIsIDMxLCAxLjI1KSxcbiAgICAgIGJvc3MoMiwgXCJWb2lkIFNwaWRlclwiLCBcIldlYnMgdGhhdCBkZXZvdXIgbGlnaHQuXCIsIDMyLCAxLjMpLFxuICAgICAgYm9zcygzLCBcIlNoYWRlIEtuaWdodFwiLCBcIllvdXIgb3duIHNpbGhvdWV0dGUsIGFybW9yZWQuXCIsIDMyLCAxLjM1KSxcbiAgICAgIGJvc3MoNCwgXCJFY2xpcHNlIFdvbGZcIiwgXCJCb3JuIGZyb20gYSBzdW5sZXNzIHNreS5cIiwgMzMsIDEuNCksXG4gICAgICBib3NzKDUsIFwiTmlnaHRib3JuZSBNYWdlXCIsIFwiU3BlbGxzIHdvdmVuIGZyb20gYWJzb2x1dGUgZGFya25lc3MuXCIsIDMzLCAxLjQ1KSxcbiAgICAgIGJvc3MoNiwgXCJBYnlzcyBIeWRyYVwiLCBcIkVhY2ggaGVhZCBhIGRpZmZlcmVudCBmZWFyLlwiLCAzNCwgMS41KSxcbiAgICAgIGJvc3MoNywgXCJTaGFkb3cgRHJhZ29uXCIsIFwiQnJlYXRoZXMgb2JsaXZpb24uXCIsIDM1LCAxLjU1KSxcbiAgICAgIGJvc3MoOCwgXCJWb2lkIENvbG9zc3VzXCIsIFwiV2hlcmUgaXQgc3RlcHMsIG5vdGhpbmcgcmVtYWlucy5cIiwgMzUsIDEuNiksXG4gICAgICBib3NzKDksIFwiVGhlIFdoaXNwZXJpbmcgRGFya1wiLCBcIk5vdCBhIGNyZWF0dXJlLiBBIHBsYWNlLiBUaGF0IGhhdGVzLlwiLCAzNywgMS43NSksXG4gICAgXSxcbiAgfSxcblxuICAvKiA4LiBDbG9ja3dvcmsgQ2l0YWRlbCDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbiAge1xuICAgIGlkOiBcImNsb2Nrd29ya19jaXRhZGVsXCIsXG4gICAgbmFtZTogXCJDbG9ja3dvcmsgQ2l0YWRlbFwiLFxuICAgIHN1YnRpdGxlOiBcIkdlYXJzIG5ldmVyIHN0b3AgdHVybmluZ1wiLFxuICAgIG1pbkxldmVsOiAzNSxcbiAgICBzdGFtaW5hQ29zdDogMjQsXG4gICAgcHJldkR1bmdlb25JZDogXCJzaGFkb3dfcmVhbG1cIixcbiAgICB0aGVtZToge1xuICAgICAgZ3JhZGllbnQ6IFwiZnJvbS16aW5jLTgwMCB2aWEtbmV1dHJhbC03MDAgdG8temluYy05MDBcIixcbiAgICAgIGNhcmRCZzogXCJmcm9tLXppbmMtOTAwLzkwIHZpYS1uZXV0cmFsLTkwMC84MCB0by1zbGF0ZS05NTAvOTBcIixcbiAgICAgIGFjY2VudDogXCJib3JkZXItemluYy00MDAvNzAgc2hhZG93LXppbmMtNDAwLzMwXCIsXG4gICAgICBnbG93Q29sb3I6IFwicmluZy16aW5jLTMwMC81MFwiLFxuICAgICAgYm9yZGVyR2xvdzogXCJob3ZlcjpzaGFkb3ctemluYy00MDAvMjBcIixcbiAgICAgIGljb246IFwi4pqZ77iPXCIsXG4gICAgfSxcbiAgICBib3NzZXM6IFtcbiAgICAgIGJvc3MoMCwgXCJHZWFyIFNwcml0ZVwiLCBcIlRpbnksIGZhc3QsIHNwYXJraW5nLlwiLCAzNSwgMS4zKSxcbiAgICAgIGJvc3MoMSwgXCJDbG9ja3dvcmsgSG91bmRcIiwgXCJNZXRhbCB0ZWV0aCwgc3ByaW5nLWxvYWRlZCBqYXdzLlwiLCAzNiwgMS4zNSksXG4gICAgICBib3NzKDIsIFwiUGlzdG9uIEdvbGVtXCIsIFwiRWFjaCBwdW5jaCBiYWNrZWQgYnkgc3RlYW0gcHJlc3N1cmUuXCIsIDM3LCAxLjQpLFxuICAgICAgYm9zcygzLCBcIlNhd2JsYWRlIERhbmNlclwiLCBcIlNwaW5uaW5nIGJsYWRlcywgZGVhZGx5IHJoeXRobS5cIiwgMzcsIDEuNDUpLFxuICAgICAgYm9zcyg0LCBcIlRlc2xhIFR1cnJldFwiLCBcIlphcHMgYW55dGhpbmcgdGhhdCBtb3Zlcy5cIiwgMzgsIDEuNSksXG4gICAgICBib3NzKDUsIFwiU3RlYW0gS25pZ2h0XCIsIFwiSGlzc2VzLCBjbGFua3MsIGFubmloaWxhdGVzLlwiLCAzOCwgMS41NSksXG4gICAgICBib3NzKDYsIFwiR2VhciBEcmFnb25cIiwgXCJXaW5ncyBvZiBpbnRlcmxvY2tpbmcgY29ncy5cIiwgMzksIDEuNiksXG4gICAgICBib3NzKDcsIFwiR3JhbmQgTWVjaGFuaXN0XCIsIFwiQnVpbGRlciBvZiBuaWdodG1hcmVzLlwiLCA0MCwgMS42NSksXG4gICAgICBib3NzKDgsIFwiU2llZ2UgQXV0b21hdG9uXCIsIFwiQSB3YWxraW5nIGZvcnRyZXNzIG9mIGJyYXNzIGFuZCBmdXJ5LlwiLCA0MCwgMS43KSxcbiAgICAgIGJvc3MoOSwgXCJUaGUgR3JhbmQgRW5naW5lXCIsIFwiVGhlIGNpdGFkZWwncyBoZWFydC4gSW5maW5pdGUgZ2VhcnMuIE9uZSBtaW5kLlwiLCA0MiwgMS44NSksXG4gICAgXSxcbiAgfSxcblxuICAvKiA5LiBBYnlzc2FsIERlcHRocyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbiAge1xuICAgIGlkOiBcImFieXNzYWxfZGVwdGhzXCIsXG4gICAgbmFtZTogXCJBYnlzc2FsIERlcHRoc1wiLFxuICAgIHN1YnRpdGxlOiBcIkJlbmVhdGggdGhlIHdvcmxkLCBzb21ldGhpbmcgd2FpdHNcIixcbiAgICBtaW5MZXZlbDogNDAsXG4gICAgc3RhbWluYUNvc3Q6IDI2LFxuICAgIHByZXZEdW5nZW9uSWQ6IFwiY2xvY2t3b3JrX2NpdGFkZWxcIixcbiAgICB0aGVtZToge1xuICAgICAgZ3JhZGllbnQ6IFwiZnJvbS1pbmRpZ28tOTAwIHZpYS1ibHVlLTkwMCB0by1pbmRpZ28tOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1pbmRpZ28tOTUwLzkwIHZpYS1ibHVlLTk1MC84MCB0by1zbGF0ZS05NTAvOTBcIixcbiAgICAgIGFjY2VudDogXCJib3JkZXItaW5kaWdvLTUwMC83MCBzaGFkb3ctaW5kaWdvLTUwMC8zMFwiLFxuICAgICAgZ2xvd0NvbG9yOiBcInJpbmctaW5kaWdvLTQwMC81MFwiLFxuICAgICAgYm9yZGVyR2xvdzogXCJob3ZlcjpzaGFkb3ctaW5kaWdvLTUwMC8yMFwiLFxuICAgICAgaWNvbjogXCLwn4yKXCIsXG4gICAgfSxcbiAgICBib3NzZXM6IFtcbiAgICAgIGJvc3MoMCwgXCJEZXB0aCBDcmF3bGVyXCIsIFwiU2tpdHRlcnMgYWNyb3NzIHRoZSBvY2VhbiBmbG9vci5cIiwgNDAsIDEuNCksXG4gICAgICBib3NzKDEsIFwiQW5nbGVyIEhvcnJvclwiLCBcIkl0cyBsaWdodCBsdXJlcy4gSXRzIGphd3MgY2xvc2UuXCIsIDQxLCAxLjQ1KSxcbiAgICAgIGJvc3MoMiwgXCJDb3JhbCBHb2xlbVwiLCBcIkxpdmluZyByZWVmIHdpdGggYSBncnVkZ2UuXCIsIDQyLCAxLjUpLFxuICAgICAgYm9zcygzLCBcIlNpcmVuXCIsIFwiSGVyIHNvbmcgZHJvd25zIHJlYXNvbi5cIiwgNDIsIDEuNTUpLFxuICAgICAgYm9zcyg0LCBcIktyYWtlbiBTcGF3blwiLCBcIk9uZSB0ZW50YWNsZSBmcm9tIHNvbWV0aGluZyBtdWNoIGxhcmdlci5cIiwgNDMsIDEuNiksXG4gICAgICBib3NzKDUsIFwiQWJ5c3NhbCBMZXZpYXRoYW5cIiwgXCJBIHdoYWxlLXNpemVkIHByZWRhdG9yIHdpdGggYSB0ZW1wZXIuXCIsIDQzLCAxLjY1KSxcbiAgICAgIGJvc3MoNiwgXCJEZWVwIFNlYSBEcmFnb25cIiwgXCJTY2FsZXMgY292ZXJlZCBpbiBiYXJuYWNsZXMgYW5kIGZ1cnkuXCIsIDQ0LCAxLjcpLFxuICAgICAgYm9zcyg3LCBcIkRyb3duZWQgQWRtaXJhbFwiLCBcIlN0aWxsIGNvbW1hbmRzIGEgZ2hvc3QgZmxlZXQuXCIsIDQ1LCAxLjc1KSxcbiAgICAgIGJvc3MoOCwgXCJUaWRhbCBDb2xvc3N1c1wiLCBcIlRoZSBvY2VhbiBnaXZlbiBsZWdzLlwiLCA0NSwgMS44KSxcbiAgICAgIGJvc3MoOSwgXCJDaGFyeWJkaXMgdGhlIERldm91cmVyXCIsIFwiVGhlIGFieXNzIG9wZW5zLiBFdmVyeXRoaW5nIGZhbGxzIGluLlwiLCA0NywgMS45NSksXG4gICAgXSxcbiAgfSxcblxuICAvKiAxMC4gSW5mZXJuYWwgVGhyb25lIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuICB7XG4gICAgaWQ6IFwiaW5mZXJuYWxfdGhyb25lXCIsXG4gICAgbmFtZTogXCJJbmZlcm5hbCBUaHJvbmVcIixcbiAgICBzdWJ0aXRsZTogXCJUaGUgZmluYWwgZGVzY2VudCBpbnRvIG1hZG5lc3NcIixcbiAgICBtaW5MZXZlbDogNDUsXG4gICAgc3RhbWluYUNvc3Q6IDMwLFxuICAgIHByZXZEdW5nZW9uSWQ6IFwiYWJ5c3NhbF9kZXB0aHNcIixcbiAgICB0aGVtZToge1xuICAgICAgZ3JhZGllbnQ6IFwiZnJvbS1yZWQtOTAwIHZpYS1yb3NlLTgwMCB0by1yZWQtOTUwXCIsXG4gICAgICBjYXJkQmc6IFwiZnJvbS1yZWQtOTUwLzkwIHZpYS1yb3NlLTk1MC84MCB0by1zbGF0ZS05NTAvOTBcIixcbiAgICAgIGFjY2VudDogXCJib3JkZXItcmVkLTUwMC83MCBzaGFkb3ctcmVkLTUwMC8zMFwiLFxuICAgICAgZ2xvd0NvbG9yOiBcInJpbmctcmVkLTQwMC81MFwiLFxuICAgICAgYm9yZGVyR2xvdzogXCJob3ZlcjpzaGFkb3ctcmVkLTUwMC8yMFwiLFxuICAgICAgaWNvbjogXCLwn5GRXCIsXG4gICAgfSxcbiAgICBib3NzZXM6IFtcbiAgICAgIGJvc3MoMCwgXCJJbXAgU3dhcm1cIiwgXCJTbWFsbCwgdmljaW91cywgZXZlcnl3aGVyZS5cIiwgNDUsIDEuNSksXG4gICAgICBib3NzKDEsIFwiSGVsbGhvdW5kIEFscGhhXCIsIFwiVGhyZWUgaGVhZHMsIHRyaXBsZSB0aGUgZnVyeS5cIiwgNDYsIDEuNTUpLFxuICAgICAgYm9zcygyLCBcIkZsYW1lIERlbW9uZXNzXCIsIFwiQmVhdXR5IGFuZCBhbm5paGlsYXRpb24uXCIsIDQ3LCAxLjYpLFxuICAgICAgYm9zcygzLCBcIklyb24gRGVtb25cIiwgXCJGb3JnZWQgaW4gaW5mZXJuYWwgcGl0cy5cIiwgNDcsIDEuNjUpLFxuICAgICAgYm9zcyg0LCBcIlBpdCBGaWVuZFwiLCBcIkNvbW1hbmRlciBvZiBsZXNzZXIgZGVtb25zLlwiLCA0OCwgMS43KSxcbiAgICAgIGJvc3MoNSwgXCJTb3VsIFJlYXZlclwiLCBcIlN0ZWFscyBzdHJlbmd0aCBmcm9tIHRoZSBmYWxsZW4uXCIsIDQ4LCAxLjc1KSxcbiAgICAgIGJvc3MoNiwgXCJJbmZlcm5hbCBEcmFnb25cIiwgXCJGaXJlIG1hZGUgZmxlc2gsIGZ1cnkgbWFkZSBzY2FsZS5cIiwgNDksIDEuOCksXG4gICAgICBib3NzKDcsIFwiRGFyayBTZXJhcGhcIiwgXCJBbiBhbmdlbCB0aGF0IGNob3NlIHRoZSB3cm9uZyBzaWRlLlwiLCA1MCwgMS44NSksXG4gICAgICBib3NzKDgsIFwiVGhlIFRocm9uZSBHdWFyZGlhblwiLCBcIlRoZSBsYXN0IGxpbmUgb2YgZGVmZW5zZS4gQWJzb2x1dGUuXCIsIDUwLCAxLjkpLFxuICAgICAgYm9zcyg5LCBcIkFyY2hmaWVuZCBNYWxhY2hhclwiLCBcIkhlIHNpdHMgb24gdGhlIHRocm9uZS4gSGUgd2FpdHMuIEhlIHdpbnMuXCIsIDUyLCAyLjEpLFxuICAgIF0sXG4gIH0sXG5dO1xuXG4vKiDilIDilIDilIAgTG9va3VwIGhlbHBlcnMg4pSA4pSA4pSAICovXG5cbmV4cG9ydCBjb25zdCBnZXREdW5nZW9uQnlJZCA9IChpZDogc3RyaW5nKTogRHVuZ2VvbkRlZmluaXRpb24gfCB1bmRlZmluZWQgPT5cbiAgRFVOR0VPTlMuZmluZCgoZCkgPT4gZC5pZCA9PT0gaWQpO1xuXG5leHBvcnQgY29uc3QgQk9TU0VTX1BFUl9EVU5HRU9OID0gMTA7XG4iXSwibmFtZXMiOlsiYm9zcyIsImluZGV4IiwibmFtZSIsImRlc2NyaXB0aW9uIiwiYmFzZUxldmVsIiwibXVsdCIsImxldmVsIiwic3RhdE11bHRpcGxpZXIiLCJEVU5HRU9OUyIsImlkIiwic3VidGl0bGUiLCJtaW5MZXZlbCIsInN0YW1pbmFDb3N0IiwicHJldkR1bmdlb25JZCIsInRoZW1lIiwiZ3JhZGllbnQiLCJjYXJkQmciLCJhY2NlbnQiLCJnbG93Q29sb3IiLCJib3JkZXJHbG93IiwiaWNvbiIsImJvc3NlcyIsImdldER1bmdlb25CeUlkIiwiZmluZCIsImQiLCJCT1NTRVNfUEVSX0RVTkdFT04iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/dungeon-data.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/dungeon.ts":
/*!*****************************!*\
  !*** ./lib/game/dungeon.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BOSSES_PER_DUNGEON: () => (/* reexport safe */ _dungeon_data__WEBPACK_IMPORTED_MODULE_0__.BOSSES_PER_DUNGEON),\n/* harmony export */   DUNGEONS: () => (/* reexport safe */ _dungeon_data__WEBPACK_IMPORTED_MODULE_0__.DUNGEONS),\n/* harmony export */   buildDungeonListWithProgress: () => (/* binding */ buildDungeonListWithProgress),\n/* harmony export */   getBossGoldReward: () => (/* binding */ getBossGoldReward),\n/* harmony export */   getBossStats: () => (/* binding */ getBossStats),\n/* harmony export */   getBossXpReward: () => (/* binding */ getBossXpReward),\n/* harmony export */   getDungeonById: () => (/* reexport safe */ _dungeon_data__WEBPACK_IMPORTED_MODULE_0__.getDungeonById),\n/* harmony export */   getDungeonCompletionBonus: () => (/* binding */ getDungeonCompletionBonus),\n/* harmony export */   isDungeonUnlocked: () => (/* binding */ isDungeonUnlocked)\n/* harmony export */ });\n/* harmony import */ var _dungeon_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dungeon-data */ \"(rsc)/./lib/game/dungeon-data.ts\");\n/** Dungeon boss progression logic.\n *  Each dungeon has 10 fixed bosses beaten sequentially.\n *  GDD §5.5 enemy scaling: Boss_Stats = base × statMultiplier */ \n/** Generate boss combat stats scaled to the player's level and the boss multiplier. */ const getBossStats = (playerLevel, boss)=>{\n    const base = Math.max(10, Math.floor(30 + playerLevel * 4));\n    const mult = boss.statMultiplier;\n    const str = Math.max(10, Math.floor(base * mult * 0.9));\n    const vit = Math.max(10, Math.floor(base * mult * 1.1));\n    const end = Math.max(10, Math.floor(base * mult * 0.85));\n    const agi = Math.max(10, Math.floor(base * mult * 0.7));\n    const int = Math.max(10, Math.floor(base * mult * 0.6));\n    const wis = Math.max(10, Math.floor(base * mult * 0.5));\n    const hp = Math.max(100, vit * 10);\n    const armor = Math.max(0, Math.floor(end * 0.8));\n    return {\n        strength: str,\n        agility: agi,\n        vitality: vit,\n        endurance: end,\n        intelligence: int,\n        wisdom: wis,\n        luck: 10,\n        charisma: 10,\n        armor,\n        maxHp: hp,\n        name: boss.name\n    };\n};\n/** Check if a dungeon is unlocked for this character given their progress records. */ const isDungeonUnlocked = (dungeon, playerLevel, progressMap)=>{\n    if (playerLevel < dungeon.minLevel) return false;\n    if (!dungeon.prevDungeonId) return true;\n    const prev = progressMap.get(dungeon.prevDungeonId);\n    return !!prev?.completed;\n};\n/** Build the full dungeon list with unlock/progress state for a character. */ const buildDungeonListWithProgress = (playerLevel, progressRecords)=>{\n    const progressMap = new Map();\n    for (const r of progressRecords){\n        progressMap.set(r.dungeonId, r);\n    }\n    return _dungeon_data__WEBPACK_IMPORTED_MODULE_0__.DUNGEONS.map((dungeon)=>{\n        const unlocked = isDungeonUnlocked(dungeon, playerLevel, progressMap);\n        const progress = progressMap.get(dungeon.id);\n        const bossIndex = progress?.bossIndex ?? 0;\n        const completed = progress?.completed ?? false;\n        const currentBoss = completed || !unlocked ? null : dungeon.bosses[bossIndex] ?? null;\n        return {\n            ...dungeon,\n            unlocked,\n            bossIndex,\n            completed,\n            currentBoss\n        };\n    });\n};\n/* ─── Reward formulas ─── */ /** Gold reward per boss. Scales with dungeon index and boss index. */ const getBossGoldReward = (dungeonIndex, bossIndex)=>{\n    const base = 20 + dungeonIndex * 30;\n    const bossScale = 1 + bossIndex * 0.2;\n    return Math.floor(base * bossScale);\n};\n/** XP reward per boss. */ const getBossXpReward = (dungeonIndex, bossIndex)=>{\n    const base = 30 + dungeonIndex * 25;\n    const bossScale = 1 + bossIndex * 0.15;\n    return Math.floor(base * bossScale);\n};\n/** Bonus reward for completing a full dungeon (10/10). */ const getDungeonCompletionBonus = (dungeonIndex)=>({\n        gold: 200 + dungeonIndex * 150,\n        xp: 300 + dungeonIndex * 200\n    });\n/* ─── Re-exports for convenience ─── */ \n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBSjtJQUVBLE1BQU0xQyxPQUFPLEtBQUs4QyxlQUFlO0lBQ2pDLE1BQU1DLFlBQVksSUFBSUwsWUFBWTtJQUNsQyxPQUFPekMsS0FBS0UsS0FBSyxDQUFDSCxPQUFPK0M7QUFDM0IsRUFBRTtBQUVGLHdEQUF3RCxHQUNqRCxNQUFNRSw0QkFBNEIsQ0FDdkNILGVBQ2tDO1FBQ2xDSSxNQUFNLE1BQU1KLGVBQWU7UUFDM0JLLElBQUksTUFBTUwsZUFBZTtJQUMzQixHQUFHO0FBRUgsc0NBQXNDLEdBRWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvZHVuZ2Vvbi50cz85YzAxIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBEdW5nZW9uIGJvc3MgcHJvZ3Jlc3Npb24gbG9naWMuXG4gKiAgRWFjaCBkdW5nZW9uIGhhcyAxMCBmaXhlZCBib3NzZXMgYmVhdGVuIHNlcXVlbnRpYWxseS5cbiAqICBHREQgwqc1LjUgZW5lbXkgc2NhbGluZzogQm9zc19TdGF0cyA9IGJhc2Ugw5cgc3RhdE11bHRpcGxpZXIgKi9cblxuaW1wb3J0IHtcbiAgRFVOR0VPTlMsXG4gIGdldER1bmdlb25CeUlkLFxuICBCT1NTRVNfUEVSX0RVTkdFT04sXG4gIHR5cGUgRHVuZ2VvbkRlZmluaXRpb24sXG4gIHR5cGUgRHVuZ2VvbkJvc3MsXG59IGZyb20gXCIuL2R1bmdlb24tZGF0YVwiO1xuXG4vKiDilIDilIDilIAgQm9zcyBzdGF0cyDilIDilIDilIAgKi9cblxuZXhwb3J0IHR5cGUgQm9zc1N0YXRzID0ge1xuICBzdHJlbmd0aDogbnVtYmVyO1xuICBhZ2lsaXR5OiBudW1iZXI7XG4gIHZpdGFsaXR5OiBudW1iZXI7XG4gIGVuZHVyYW5jZTogbnVtYmVyO1xuICBpbnRlbGxpZ2VuY2U6IG51bWJlcjtcbiAgd2lzZG9tOiBudW1iZXI7XG4gIGx1Y2s6IG51bWJlcjtcbiAgY2hhcmlzbWE6IG51bWJlcjtcbiAgYXJtb3I6IG51bWJlcjtcbiAgbWF4SHA6IG51bWJlcjtcbiAgbmFtZTogc3RyaW5nO1xufTtcblxuLyoqIEdlbmVyYXRlIGJvc3MgY29tYmF0IHN0YXRzIHNjYWxlZCB0byB0aGUgcGxheWVyJ3MgbGV2ZWwgYW5kIHRoZSBib3NzIG11bHRpcGxpZXIuICovXG5leHBvcnQgY29uc3QgZ2V0Qm9zc1N0YXRzID0gKFxuICBwbGF5ZXJMZXZlbDogbnVtYmVyLFxuICBib3NzOiBEdW5nZW9uQm9zcyxcbik6IEJvc3NTdGF0cyA9PiB7XG4gIGNvbnN0IGJhc2UgPSBNYXRoLm1heCgxMCwgTWF0aC5mbG9vcigzMCArIHBsYXllckxldmVsICogNCkpO1xuICBjb25zdCBtdWx0ID0gYm9zcy5zdGF0TXVsdGlwbGllcjtcblxuICBjb25zdCBzdHIgPSBNYXRoLm1heCgxMCwgTWF0aC5mbG9vcihiYXNlICogbXVsdCAqIDAuOSkpO1xuICBjb25zdCB2aXQgPSBNYXRoLm1heCgxMCwgTWF0aC5mbG9vcihiYXNlICogbXVsdCAqIDEuMSkpO1xuICBjb25zdCBlbmQgPSBNYXRoLm1heCgxMCwgTWF0aC5mbG9vcihiYXNlICogbXVsdCAqIDAuODUpKTtcbiAgY29uc3QgYWdpID0gTWF0aC5tYXgoMTAsIE1hdGguZmxvb3IoYmFzZSAqIG11bHQgKiAwLjcpKTtcbiAgY29uc3QgaW50ID0gTWF0aC5tYXgoMTAsIE1hdGguZmxvb3IoYmFzZSAqIG11bHQgKiAwLjYpKTtcbiAgY29uc3Qgd2lzID0gTWF0aC5tYXgoMTAsIE1hdGguZmxvb3IoYmFzZSAqIG11bHQgKiAwLjUpKTtcbiAgY29uc3QgaHAgPSBNYXRoLm1heCgxMDAsIHZpdCAqIDEwKTtcbiAgY29uc3QgYXJtb3IgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGVuZCAqIDAuOCkpO1xuXG4gIHJldHVybiB7XG4gICAgc3RyZW5ndGg6IHN0cixcbiAgICBhZ2lsaXR5OiBhZ2ksXG4gICAgdml0YWxpdHk6IHZpdCxcbiAgICBlbmR1cmFuY2U6IGVuZCxcbiAgICBpbnRlbGxpZ2VuY2U6IGludCxcbiAgICB3aXNkb206IHdpcyxcbiAgICBsdWNrOiAxMCxcbiAgICBjaGFyaXNtYTogMTAsXG4gICAgYXJtb3IsXG4gICAgbWF4SHA6IGhwLFxuICAgIG5hbWU6IGJvc3MubmFtZSxcbiAgfTtcbn07XG5cbi8qIOKUgOKUgOKUgCBEdW5nZW9uIHVubG9jayBsb2dpYyDilIDilIDilIAgKi9cblxuZXhwb3J0IHR5cGUgRHVuZ2VvblByb2dyZXNzUmVjb3JkID0ge1xuICBkdW5nZW9uSWQ6IHN0cmluZztcbiAgYm9zc0luZGV4OiBudW1iZXI7IC8vIDAtOSAobmV4dCBib3NzIHRvIGJlYXQpXG4gIGNvbXBsZXRlZDogYm9vbGVhbjtcbn07XG5cbi8qKiBDaGVjayBpZiBhIGR1bmdlb24gaXMgdW5sb2NrZWQgZm9yIHRoaXMgY2hhcmFjdGVyIGdpdmVuIHRoZWlyIHByb2dyZXNzIHJlY29yZHMuICovXG5leHBvcnQgY29uc3QgaXNEdW5nZW9uVW5sb2NrZWQgPSAoXG4gIGR1bmdlb246IER1bmdlb25EZWZpbml0aW9uLFxuICBwbGF5ZXJMZXZlbDogbnVtYmVyLFxuICBwcm9ncmVzc01hcDogTWFwPHN0cmluZywgRHVuZ2VvblByb2dyZXNzUmVjb3JkPixcbik6IGJvb2xlYW4gPT4ge1xuICBpZiAocGxheWVyTGV2ZWwgPCBkdW5nZW9uLm1pbkxldmVsKSByZXR1cm4gZmFsc2U7XG4gIGlmICghZHVuZ2Vvbi5wcmV2RHVuZ2VvbklkKSByZXR1cm4gdHJ1ZTtcblxuICBjb25zdCBwcmV2ID0gcHJvZ3Jlc3NNYXAuZ2V0KGR1bmdlb24ucHJldkR1bmdlb25JZCk7XG4gIHJldHVybiAhIXByZXY/LmNvbXBsZXRlZDtcbn07XG5cbi8qKiBCdWlsZCB0aGUgZnVsbCBkdW5nZW9uIGxpc3Qgd2l0aCB1bmxvY2svcHJvZ3Jlc3Mgc3RhdGUgZm9yIGEgY2hhcmFjdGVyLiAqL1xuZXhwb3J0IGNvbnN0IGJ1aWxkRHVuZ2Vvbkxpc3RXaXRoUHJvZ3Jlc3MgPSAoXG4gIHBsYXllckxldmVsOiBudW1iZXIsXG4gIHByb2dyZXNzUmVjb3JkczogRHVuZ2VvblByb2dyZXNzUmVjb3JkW10sXG4pID0+IHtcbiAgY29uc3QgcHJvZ3Jlc3NNYXAgPSBuZXcgTWFwPHN0cmluZywgRHVuZ2VvblByb2dyZXNzUmVjb3JkPigpO1xuICBmb3IgKGNvbnN0IHIgb2YgcHJvZ3Jlc3NSZWNvcmRzKSB7XG4gICAgcHJvZ3Jlc3NNYXAuc2V0KHIuZHVuZ2VvbklkLCByKTtcbiAgfVxuXG4gIHJldHVybiBEVU5HRU9OUy5tYXAoKGR1bmdlb24pID0+IHtcbiAgICBjb25zdCB1bmxvY2tlZCA9IGlzRHVuZ2VvblVubG9ja2VkKGR1bmdlb24sIHBsYXllckxldmVsLCBwcm9ncmVzc01hcCk7XG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBwcm9ncmVzc01hcC5nZXQoZHVuZ2Vvbi5pZCk7XG4gICAgY29uc3QgYm9zc0luZGV4ID0gcHJvZ3Jlc3M/LmJvc3NJbmRleCA/PyAwO1xuICAgIGNvbnN0IGNvbXBsZXRlZCA9IHByb2dyZXNzPy5jb21wbGV0ZWQgPz8gZmFsc2U7XG4gICAgY29uc3QgY3VycmVudEJvc3MgPVxuICAgICAgY29tcGxldGVkIHx8ICF1bmxvY2tlZCA/IG51bGwgOiBkdW5nZW9uLmJvc3Nlc1tib3NzSW5kZXhdID8/IG51bGw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uZHVuZ2VvbixcbiAgICAgIHVubG9ja2VkLFxuICAgICAgYm9zc0luZGV4LFxuICAgICAgY29tcGxldGVkLFxuICAgICAgY3VycmVudEJvc3MsXG4gICAgfTtcbiAgfSk7XG59O1xuXG4vKiDilIDilIDilIAgUmV3YXJkIGZvcm11bGFzIOKUgOKUgOKUgCAqL1xuXG4vKiogR29sZCByZXdhcmQgcGVyIGJvc3MuIFNjYWxlcyB3aXRoIGR1bmdlb24gaW5kZXggYW5kIGJvc3MgaW5kZXguICovXG5leHBvcnQgY29uc3QgZ2V0Qm9zc0dvbGRSZXdhcmQgPSAoXG4gIGR1bmdlb25JbmRleDogbnVtYmVyLFxuICBib3NzSW5kZXg6IG51bWJlcixcbik6IG51bWJlciA9PiB7XG4gIGNvbnN0IGJhc2UgPSAyMCArIGR1bmdlb25JbmRleCAqIDMwO1xuICBjb25zdCBib3NzU2NhbGUgPSAxICsgYm9zc0luZGV4ICogMC4yO1xuICByZXR1cm4gTWF0aC5mbG9vcihiYXNlICogYm9zc1NjYWxlKTtcbn07XG5cbi8qKiBYUCByZXdhcmQgcGVyIGJvc3MuICovXG5leHBvcnQgY29uc3QgZ2V0Qm9zc1hwUmV3YXJkID0gKFxuICBkdW5nZW9uSW5kZXg6IG51bWJlcixcbiAgYm9zc0luZGV4OiBudW1iZXIsXG4pOiBudW1iZXIgPT4ge1xuICBjb25zdCBiYXNlID0gMzAgKyBkdW5nZW9uSW5kZXggKiAyNTtcbiAgY29uc3QgYm9zc1NjYWxlID0gMSArIGJvc3NJbmRleCAqIDAuMTU7XG4gIHJldHVybiBNYXRoLmZsb29yKGJhc2UgKiBib3NzU2NhbGUpO1xufTtcblxuLyoqIEJvbnVzIHJld2FyZCBmb3IgY29tcGxldGluZyBhIGZ1bGwgZHVuZ2VvbiAoMTAvMTApLiAqL1xuZXhwb3J0IGNvbnN0IGdldER1bmdlb25Db21wbGV0aW9uQm9udXMgPSAoXG4gIGR1bmdlb25JbmRleDogbnVtYmVyLFxuKTogeyBnb2xkOiBudW1iZXI7IHhwOiBudW1iZXIgfSA9PiAoe1xuICBnb2xkOiAyMDAgKyBkdW5nZW9uSW5kZXggKiAxNTAsXG4gIHhwOiAzMDAgKyBkdW5nZW9uSW5kZXggKiAyMDAsXG59KTtcblxuLyog4pSA4pSA4pSAIFJlLWV4cG9ydHMgZm9yIGNvbnZlbmllbmNlIOKUgOKUgOKUgCAqL1xuXG5leHBvcnQgeyBEVU5HRU9OUywgZ2V0RHVuZ2VvbkJ5SWQsIEJPU1NFU19QRVJfRFVOR0VPTiB9O1xuZXhwb3J0IHR5cGUgeyBEdW5nZW9uRGVmaW5pdGlvbiwgRHVuZ2VvbkJvc3MgfTtcbiJdLCJuYW1lcyI6WyJEVU5HRU9OUyIsImdldER1bmdlb25CeUlkIiwiQk9TU0VTX1BFUl9EVU5HRU9OIiwiZ2V0Qm9zc1N0YXRzIiwicGxheWVyTGV2ZWwiLCJib3NzIiwiYmFzZSIsIk1hdGgiLCJtYXgiLCJmbG9vciIsIm11bHQiLCJzdGF0TXVsdGlwbGllciIsInN0ciIsInZpdCIsImVuZCIsImFnaSIsImludCIsIndpcyIsImhwIiwiYXJtb3IiLCJzdHJlbmd0aCIsImFnaWxpdHkiLCJ2aXRhbGl0eSIsImVuZHVyYW5jZSIsImludGVsbGlnZW5jZSIsIndpc2RvbSIsImx1Y2siLCJjaGFyaXNtYSIsIm1heEhwIiwibmFtZSIsImlzRHVuZ2VvblVubG9ja2VkIiwiZHVuZ2VvbiIsInByb2dyZXNzTWFwIiwibWluTGV2ZWwiLCJwcmV2RHVuZ2VvbklkIiwicHJldiIsImdldCIsImNvbXBsZXRlZCIsImJ1aWxkRHVuZ2Vvbkxpc3RXaXRoUHJvZ3Jlc3MiLCJwcm9ncmVzc1JlY29yZHMiLCJNYXAiLCJyIiwic2V0IiwiZHVuZ2VvbklkIiwibWFwIiwidW5sb2NrZWQiLCJwcm9ncmVzcyIsImlkIiwiYm9zc0luZGV4IiwiY3VycmVudEJvc3MiLCJib3NzZXMiLCJnZXRCb3NzR29sZFJld2FyZCIsImR1bmdlb25JbmRleCIsImJvc3NTY2FsZSIsImdldEJvc3NYcFJld2FyZCIsImdldER1bmdlb25Db21wbGV0aW9uQm9udXMiLCJnb2xkIiwieHAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/dungeon.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/levelUp.ts":
/*!*****************************!*\
  !*** ./lib/game/levelUp.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyLevelUp: () => (/* binding */ applyLevelUp),\n/* harmony export */   checkLevelUp: () => (/* binding */ checkLevelUp)\n/* harmony export */ });\n/* harmony import */ var _progression__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./progression */ \"(rsc)/./lib/game/progression.ts\");\n\n/** GDD §3 - Level up: +5 stat points, +1 skill every 5 levels, 100*level gold, full HP restore */ const checkLevelUp = (params)=>{\n    let { level, currentXp } = params;\n    let statPointsGained = 0;\n    let skillPointsGained = 0;\n    let goldGained = 0;\n    let xpNeeded = (0,_progression__WEBPACK_IMPORTED_MODULE_0__.xpForLevel)(level);\n    while(currentXp >= xpNeeded){\n        currentXp -= xpNeeded;\n        level++;\n        statPointsGained += 5;\n        if (level % 5 === 0) skillPointsGained += 1;\n        goldGained += 100 * level;\n        xpNeeded = (0,_progression__WEBPACK_IMPORTED_MODULE_0__.xpForLevel)(level);\n    }\n    return {\n        newLevel: level,\n        newCurrentXp: currentXp,\n        statPointsGained,\n        skillPointsGained,\n        goldGained\n    };\n};\n/** Apply level-up to character: update level, currentXp, statPointsAvailable, gold, currentHp (full heal) */ const applyLevelUp = (params)=>{\n    const result = checkLevelUp({\n        level: params.level,\n        currentXp: params.currentXp\n    });\n    return {\n        level: result.newLevel,\n        currentXp: result.newCurrentXp,\n        statPointsAvailable: params.statPointsAvailable + result.statPointsGained,\n        gold: params.gold + result.goldGained,\n        currentHp: params.maxHp\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9sZXZlbFVwLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQztBQUUzQyxnR0FBZ0csR0FDekYsTUFBTUMsZUFBZSxDQUFDQztJQUkzQixJQUFJLEVBQUVDLEtBQUssRUFBRUMsU0FBUyxFQUFFLEdBQUdGO0lBQzNCLElBQUlHLG1CQUFtQjtJQUN2QixJQUFJQyxvQkFBb0I7SUFDeEIsSUFBSUMsYUFBYTtJQUVqQixJQUFJQyxXQUFXUix3REFBVUEsQ0FBQ0c7SUFDMUIsTUFBT0MsYUFBYUksU0FBVTtRQUM1QkosYUFBYUk7UUFDYkw7UUFDQUUsb0JBQW9CO1FBQ3BCLElBQUlGLFFBQVEsTUFBTSxHQUFHRyxxQkFBcUI7UUFDMUNDLGNBQWMsTUFBTUo7UUFDcEJLLFdBQVdSLHdEQUFVQSxDQUFDRztJQUN4QjtJQUVBLE9BQU87UUFDTE0sVUFBVU47UUFDVk8sY0FBY047UUFDZEM7UUFDQUM7UUFDQUM7SUFDRjtBQUNGLEVBQUU7QUFFRiwyR0FBMkcsR0FDcEcsTUFBTUksZUFBZSxDQUFDVDtJQWEzQixNQUFNVSxTQUFTWCxhQUFhO1FBQUVFLE9BQU9ELE9BQU9DLEtBQUs7UUFBRUMsV0FBV0YsT0FBT0UsU0FBUztJQUFDO0lBQy9FLE9BQU87UUFDTEQsT0FBT1MsT0FBT0gsUUFBUTtRQUN0QkwsV0FBV1EsT0FBT0YsWUFBWTtRQUM5QkcscUJBQXFCWCxPQUFPVyxtQkFBbUIsR0FBR0QsT0FBT1AsZ0JBQWdCO1FBQ3pFUyxNQUFNWixPQUFPWSxJQUFJLEdBQUdGLE9BQU9MLFVBQVU7UUFDckNRLFdBQVdiLE9BQU9jLEtBQUs7SUFDekI7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvbGV2ZWxVcC50cz9mMDcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHhwRm9yTGV2ZWwgfSBmcm9tIFwiLi9wcm9ncmVzc2lvblwiO1xuXG4vKiogR0REIMKnMyAtIExldmVsIHVwOiArNSBzdGF0IHBvaW50cywgKzEgc2tpbGwgZXZlcnkgNSBsZXZlbHMsIDEwMCpsZXZlbCBnb2xkLCBmdWxsIEhQIHJlc3RvcmUgKi9cbmV4cG9ydCBjb25zdCBjaGVja0xldmVsVXAgPSAocGFyYW1zOiB7XG4gIGxldmVsOiBudW1iZXI7XG4gIGN1cnJlbnRYcDogbnVtYmVyO1xufSk6IHsgbmV3TGV2ZWw6IG51bWJlcjsgbmV3Q3VycmVudFhwOiBudW1iZXI7IHN0YXRQb2ludHNHYWluZWQ6IG51bWJlcjsgc2tpbGxQb2ludHNHYWluZWQ6IG51bWJlcjsgZ29sZEdhaW5lZDogbnVtYmVyIH0gPT4ge1xuICBsZXQgeyBsZXZlbCwgY3VycmVudFhwIH0gPSBwYXJhbXM7XG4gIGxldCBzdGF0UG9pbnRzR2FpbmVkID0gMDtcbiAgbGV0IHNraWxsUG9pbnRzR2FpbmVkID0gMDtcbiAgbGV0IGdvbGRHYWluZWQgPSAwO1xuXG4gIGxldCB4cE5lZWRlZCA9IHhwRm9yTGV2ZWwobGV2ZWwpO1xuICB3aGlsZSAoY3VycmVudFhwID49IHhwTmVlZGVkKSB7XG4gICAgY3VycmVudFhwIC09IHhwTmVlZGVkO1xuICAgIGxldmVsKys7XG4gICAgc3RhdFBvaW50c0dhaW5lZCArPSA1O1xuICAgIGlmIChsZXZlbCAlIDUgPT09IDApIHNraWxsUG9pbnRzR2FpbmVkICs9IDE7XG4gICAgZ29sZEdhaW5lZCArPSAxMDAgKiBsZXZlbDtcbiAgICB4cE5lZWRlZCA9IHhwRm9yTGV2ZWwobGV2ZWwpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBuZXdMZXZlbDogbGV2ZWwsXG4gICAgbmV3Q3VycmVudFhwOiBjdXJyZW50WHAsXG4gICAgc3RhdFBvaW50c0dhaW5lZCxcbiAgICBza2lsbFBvaW50c0dhaW5lZCxcbiAgICBnb2xkR2FpbmVkLFxuICB9O1xufTtcblxuLyoqIEFwcGx5IGxldmVsLXVwIHRvIGNoYXJhY3RlcjogdXBkYXRlIGxldmVsLCBjdXJyZW50WHAsIHN0YXRQb2ludHNBdmFpbGFibGUsIGdvbGQsIGN1cnJlbnRIcCAoZnVsbCBoZWFsKSAqL1xuZXhwb3J0IGNvbnN0IGFwcGx5TGV2ZWxVcCA9IChwYXJhbXM6IHtcbiAgbGV2ZWw6IG51bWJlcjtcbiAgY3VycmVudFhwOiBudW1iZXI7XG4gIHN0YXRQb2ludHNBdmFpbGFibGU6IG51bWJlcjtcbiAgZ29sZDogbnVtYmVyO1xuICBtYXhIcDogbnVtYmVyO1xufSk6IHtcbiAgbGV2ZWw6IG51bWJlcjtcbiAgY3VycmVudFhwOiBudW1iZXI7XG4gIHN0YXRQb2ludHNBdmFpbGFibGU6IG51bWJlcjtcbiAgZ29sZDogbnVtYmVyO1xuICBjdXJyZW50SHA6IG51bWJlcjtcbn0gPT4ge1xuICBjb25zdCByZXN1bHQgPSBjaGVja0xldmVsVXAoeyBsZXZlbDogcGFyYW1zLmxldmVsLCBjdXJyZW50WHA6IHBhcmFtcy5jdXJyZW50WHAgfSk7XG4gIHJldHVybiB7XG4gICAgbGV2ZWw6IHJlc3VsdC5uZXdMZXZlbCxcbiAgICBjdXJyZW50WHA6IHJlc3VsdC5uZXdDdXJyZW50WHAsXG4gICAgc3RhdFBvaW50c0F2YWlsYWJsZTogcGFyYW1zLnN0YXRQb2ludHNBdmFpbGFibGUgKyByZXN1bHQuc3RhdFBvaW50c0dhaW5lZCxcbiAgICBnb2xkOiBwYXJhbXMuZ29sZCArIHJlc3VsdC5nb2xkR2FpbmVkLFxuICAgIGN1cnJlbnRIcDogcGFyYW1zLm1heEhwLFxuICB9O1xufTtcbiJdLCJuYW1lcyI6WyJ4cEZvckxldmVsIiwiY2hlY2tMZXZlbFVwIiwicGFyYW1zIiwibGV2ZWwiLCJjdXJyZW50WHAiLCJzdGF0UG9pbnRzR2FpbmVkIiwic2tpbGxQb2ludHNHYWluZWQiLCJnb2xkR2FpbmVkIiwieHBOZWVkZWQiLCJuZXdMZXZlbCIsIm5ld0N1cnJlbnRYcCIsImFwcGx5TGV2ZWxVcCIsInJlc3VsdCIsInN0YXRQb2ludHNBdmFpbGFibGUiLCJnb2xkIiwiY3VycmVudEhwIiwibWF4SHAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/levelUp.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/loot.ts":
/*!**************************!*\
  !*** ./lib/game/loot.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   rollDropChance: () => (/* binding */ rollDropChance),\n/* harmony export */   rollRarity: () => (/* binding */ rollRarity)\n/* harmony export */ });\n/** GDD §5.3 - Drop by rarity, Luck, difficulty bonus */ const RARITY_THRESHOLDS = [\n    {\n        rarity: \"legendary\",\n        minRoll: 990\n    },\n    {\n        rarity: \"epic\",\n        minRoll: 960\n    },\n    {\n        rarity: \"rare\",\n        minRoll: 900\n    },\n    {\n        rarity: \"uncommon\",\n        minRoll: 750\n    },\n    {\n        rarity: \"common\",\n        minRoll: 0\n    }\n];\nconst DIFFICULTY_BONUS = {\n    easy: 0,\n    normal: 50,\n    hard: 120\n};\n/** Enhanced_Roll = Drop_Roll + (Player_Luck × 2) + Difficulty_Bonus. Roll 1-1000. */ const rollRarity = (luck, difficulty)=>{\n    const roll = Math.floor(Math.random() * 1000) + 1;\n    const bonus = luck * 2 + (DIFFICULTY_BONUS[difficulty] ?? 0);\n    const enhanced = Math.min(1200, roll + bonus);\n    for (const { rarity, minRoll } of RARITY_THRESHOLDS){\n        if (enhanced >= minRoll) return rarity;\n    }\n    return \"common\";\n};\n/** Whether an item drops (e.g. 60% easy, 50% normal, 70% hard per enemy; boss guaranteed) */ const rollDropChance = (difficulty, isBoss)=>{\n    if (isBoss) return true;\n    const chance = difficulty === \"easy\" ? 0.6 : difficulty === \"hard\" ? 0.7 : 0.5;\n    return Math.random() < chance;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9sb290LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsc0RBQXNELEdBSXRELE1BQU1BLG9CQUEyRDtJQUMvRDtRQUFFQyxRQUFRO1FBQWFDLFNBQVM7SUFBSTtJQUNwQztRQUFFRCxRQUFRO1FBQVFDLFNBQVM7SUFBSTtJQUMvQjtRQUFFRCxRQUFRO1FBQVFDLFNBQVM7SUFBSTtJQUMvQjtRQUFFRCxRQUFRO1FBQVlDLFNBQVM7SUFBSTtJQUNuQztRQUFFRCxRQUFRO1FBQVVDLFNBQVM7SUFBRTtDQUNoQztBQUVELE1BQU1DLG1CQUEyQztJQUMvQ0MsTUFBTTtJQUNOQyxRQUFRO0lBQ1JDLE1BQU07QUFDUjtBQUVBLG1GQUFtRixHQUM1RSxNQUFNQyxhQUFhLENBQ3hCQyxNQUNBQztJQUVBLE1BQU1DLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLLFFBQVE7SUFDaEQsTUFBTUMsUUFBUSxPQUFRLElBQU1YLENBQUFBLGdCQUFnQixDQUFDTSxXQUFXLElBQUk7SUFDNUQsTUFBTU0sV0FBV0osS0FBS0ssR0FBRyxDQUFDLE1BQU1OLE9BQU9JO0lBQ3ZDLEtBQUssTUFBTSxFQUFFYixNQUFNLEVBQUVDLE9BQU8sRUFBRSxJQUFJRixrQkFBbUI7UUFDbkQsSUFBSWUsWUFBWWIsU0FBUyxPQUFPRDtJQUNsQztJQUNBLE9BQU87QUFDVCxFQUFFO0FBRUYsMkZBQTJGLEdBQ3BGLE1BQU1nQixpQkFBaUIsQ0FBQ1IsWUFBb0JTO0lBQ2pELElBQUlBLFFBQVEsT0FBTztJQUNuQixNQUFNQyxTQUFTVixlQUFlLFNBQVMsTUFBTUEsZUFBZSxTQUFTLE1BQU07SUFDM0UsT0FBT0UsS0FBS0UsTUFBTSxLQUFLTTtBQUN6QixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvbG9vdC50cz9iNmU2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBHREQgwqc1LjMgLSBEcm9wIGJ5IHJhcml0eSwgTHVjaywgZGlmZmljdWx0eSBib251cyAqL1xuXG5leHBvcnQgdHlwZSBSYXJpdHkgPSBcImNvbW1vblwiIHwgXCJ1bmNvbW1vblwiIHwgXCJyYXJlXCIgfCBcImVwaWNcIiB8IFwibGVnZW5kYXJ5XCI7XG5cbmNvbnN0IFJBUklUWV9USFJFU0hPTERTOiB7IHJhcml0eTogUmFyaXR5OyBtaW5Sb2xsOiBudW1iZXIgfVtdID0gW1xuICB7IHJhcml0eTogXCJsZWdlbmRhcnlcIiwgbWluUm9sbDogOTkwIH0sXG4gIHsgcmFyaXR5OiBcImVwaWNcIiwgbWluUm9sbDogOTYwIH0sXG4gIHsgcmFyaXR5OiBcInJhcmVcIiwgbWluUm9sbDogOTAwIH0sXG4gIHsgcmFyaXR5OiBcInVuY29tbW9uXCIsIG1pblJvbGw6IDc1MCB9LFxuICB7IHJhcml0eTogXCJjb21tb25cIiwgbWluUm9sbDogMCB9LFxuXTtcblxuY29uc3QgRElGRklDVUxUWV9CT05VUzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHtcbiAgZWFzeTogMCxcbiAgbm9ybWFsOiA1MCxcbiAgaGFyZDogMTIwLFxufTtcblxuLyoqIEVuaGFuY2VkX1JvbGwgPSBEcm9wX1JvbGwgKyAoUGxheWVyX0x1Y2sgw5cgMikgKyBEaWZmaWN1bHR5X0JvbnVzLiBSb2xsIDEtMTAwMC4gKi9cbmV4cG9ydCBjb25zdCByb2xsUmFyaXR5ID0gKFxuICBsdWNrOiBudW1iZXIsXG4gIGRpZmZpY3VsdHk6IHN0cmluZ1xuKTogUmFyaXR5ID0+IHtcbiAgY29uc3Qgcm9sbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDApICsgMTtcbiAgY29uc3QgYm9udXMgPSAobHVjayAqIDIpICsgKERJRkZJQ1VMVFlfQk9OVVNbZGlmZmljdWx0eV0gPz8gMCk7XG4gIGNvbnN0IGVuaGFuY2VkID0gTWF0aC5taW4oMTIwMCwgcm9sbCArIGJvbnVzKTtcbiAgZm9yIChjb25zdCB7IHJhcml0eSwgbWluUm9sbCB9IG9mIFJBUklUWV9USFJFU0hPTERTKSB7XG4gICAgaWYgKGVuaGFuY2VkID49IG1pblJvbGwpIHJldHVybiByYXJpdHk7XG4gIH1cbiAgcmV0dXJuIFwiY29tbW9uXCI7XG59O1xuXG4vKiogV2hldGhlciBhbiBpdGVtIGRyb3BzIChlLmcuIDYwJSBlYXN5LCA1MCUgbm9ybWFsLCA3MCUgaGFyZCBwZXIgZW5lbXk7IGJvc3MgZ3VhcmFudGVlZCkgKi9cbmV4cG9ydCBjb25zdCByb2xsRHJvcENoYW5jZSA9IChkaWZmaWN1bHR5OiBzdHJpbmcsIGlzQm9zczogYm9vbGVhbik6IGJvb2xlYW4gPT4ge1xuICBpZiAoaXNCb3NzKSByZXR1cm4gdHJ1ZTtcbiAgY29uc3QgY2hhbmNlID0gZGlmZmljdWx0eSA9PT0gXCJlYXN5XCIgPyAwLjYgOiBkaWZmaWN1bHR5ID09PSBcImhhcmRcIiA/IDAuNyA6IDAuNTtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkgPCBjaGFuY2U7XG59O1xuIl0sIm5hbWVzIjpbIlJBUklUWV9USFJFU0hPTERTIiwicmFyaXR5IiwibWluUm9sbCIsIkRJRkZJQ1VMVFlfQk9OVVMiLCJlYXN5Iiwibm9ybWFsIiwiaGFyZCIsInJvbGxSYXJpdHkiLCJsdWNrIiwiZGlmZmljdWx0eSIsInJvbGwiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJib251cyIsImVuaGFuY2VkIiwibWluIiwicm9sbERyb3BDaGFuY2UiLCJpc0Jvc3MiLCJjaGFuY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/loot.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/origins.ts":
/*!*****************************!*\
  !*** ./lib/game/origins.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALL_ORIGINS: () => (/* binding */ ALL_ORIGINS),\n/* harmony export */   ORIGIN_ACCENT: () => (/* binding */ ORIGIN_ACCENT),\n/* harmony export */   ORIGIN_BORDER: () => (/* binding */ ORIGIN_BORDER),\n/* harmony export */   ORIGIN_CHANGE_COST: () => (/* binding */ ORIGIN_CHANGE_COST),\n/* harmony export */   ORIGIN_DEFS: () => (/* binding */ ORIGIN_DEFS),\n/* harmony export */   ORIGIN_GRADIENT: () => (/* binding */ ORIGIN_GRADIENT),\n/* harmony export */   applyOriginBonuses: () => (/* binding */ applyOriginBonuses),\n/* harmony export */   getCheatDeathChance: () => (/* binding */ getCheatDeathChance),\n/* harmony export */   hasCheatDeath: () => (/* binding */ hasCheatDeath)\n/* harmony export */ });\n/** GDD Extension — Character Races (passive bonuses layer) */ /* ────────────────── Constants ────────────────── */ const ALL_ORIGINS = [\n    \"human\",\n    \"orc\",\n    \"skeleton\",\n    \"demon\",\n    \"dogfolk\"\n];\nconst ORIGIN_CHANGE_COST = 500;\n/* ────────────────── Origin Definitions ────────────────── */ const ORIGIN_DEFS = {\n    human: {\n        id: \"human\",\n        label: \"Human\",\n        icon: \"\\uD83E\\uDDD1\",\n        description: \"Versatile and adaptable, balanced in all aspects\",\n        bonusDescription: \"+5% to all stats\",\n        statModifiers: {\n            strength: 0.05,\n            agility: 0.05,\n            vitality: 0.05,\n            endurance: 0.05,\n            intelligence: 0.05,\n            wisdom: 0.05,\n            luck: 0.05,\n            charisma: 0.05\n        }\n    },\n    orc: {\n        id: \"orc\",\n        label: \"Orc\",\n        icon: \"\\uD83D\\uDC79\",\n        description: \"Brutal warriors, feared for their raw strength\",\n        bonusDescription: \"+8% STR, -3% END\",\n        statModifiers: {\n            strength: 0.08,\n            endurance: -0.03\n        }\n    },\n    skeleton: {\n        id: \"skeleton\",\n        label: \"Skeleton\",\n        icon: \"\\uD83D\\uDC80\",\n        description: \"Undead remnants, swift and eerily lucky\",\n        bonusDescription: \"+6% AGI, +4% LCK\",\n        statModifiers: {\n            agility: 0.06,\n            luck: 0.04\n        }\n    },\n    demon: {\n        id: \"demon\",\n        label: \"Demon\",\n        icon: \"\\uD83D\\uDE08\",\n        description: \"Infernal beings, armored in hellfire and resilience\",\n        bonusDescription: \"+8% END, +5% VIT\",\n        statModifiers: {\n            endurance: 0.08,\n            vitality: 0.05\n        }\n    },\n    dogfolk: {\n        id: \"dogfolk\",\n        label: \"Dogfolk\",\n        icon: \"\\uD83D\\uDC15\",\n        description: \"Loyal canine warriors — they refuse to stay down\",\n        bonusDescription: \"5% chance to cheat death (survive at 1 HP)\",\n        statModifiers: {},\n        passive: {\n            id: \"cheating_death\",\n            name: \"Cheating Death\",\n            chance: 0.05,\n            description: \"5% chance to survive a killing blow with 1 HP\"\n        }\n    }\n};\n/* ────────────────── UI Style Maps ────────────────── */ const ORIGIN_GRADIENT = {\n    human: \"from-amber-600/20 to-yellow-600/20\",\n    orc: \"from-red-600/20 to-rose-600/20\",\n    skeleton: \"from-purple-600/20 to-fuchsia-600/20\",\n    demon: \"from-cyan-600/20 to-blue-600/20\",\n    dogfolk: \"from-orange-600/20 to-yellow-600/20\"\n};\nconst ORIGIN_BORDER = {\n    human: \"border-amber-500/40 hover:border-amber-400/60\",\n    orc: \"border-red-500/40 hover:border-red-400/60\",\n    skeleton: \"border-purple-500/40 hover:border-purple-400/60\",\n    demon: \"border-cyan-500/40 hover:border-cyan-400/60\",\n    dogfolk: \"border-orange-500/40 hover:border-orange-400/60\"\n};\nconst ORIGIN_ACCENT = {\n    human: \"text-amber-400\",\n    orc: \"text-red-400\",\n    skeleton: \"text-purple-400\",\n    demon: \"text-cyan-400\",\n    dogfolk: \"text-orange-400\"\n};\n/* ────────────────── Logic ────────────────── */ /** Apply origin percentage bonuses to base stats. No stacking multiplier. */ const applyOriginBonuses = (baseStats, origin)=>{\n    const def = ORIGIN_DEFS[origin];\n    if (!def) return {\n        ...baseStats\n    };\n    const mods = def.statModifiers;\n    return {\n        strength: Math.floor(baseStats.strength * (1 + (mods.strength ?? 0))),\n        agility: Math.floor(baseStats.agility * (1 + (mods.agility ?? 0))),\n        vitality: Math.floor(baseStats.vitality * (1 + (mods.vitality ?? 0))),\n        endurance: Math.floor(baseStats.endurance * (1 + (mods.endurance ?? 0))),\n        intelligence: Math.floor(baseStats.intelligence * (1 + (mods.intelligence ?? 0))),\n        wisdom: Math.floor(baseStats.wisdom * (1 + (mods.wisdom ?? 0))),\n        luck: Math.floor(baseStats.luck * (1 + (mods.luck ?? 0))),\n        charisma: Math.floor(baseStats.charisma * (1 + (mods.charisma ?? 0)))\n    };\n};\n/** Check if origin has the cheating_death passive */ const hasCheatDeath = (origin)=>{\n    return ORIGIN_DEFS[origin]?.passive?.id === \"cheating_death\";\n};\n/** Get cheating_death chance (0 if origin doesn't have it) */ const getCheatDeathChance = (origin)=>{\n    const def = ORIGIN_DEFS[origin];\n    if (def?.passive?.id === \"cheating_death\") return def.passive.chance;\n    return 0;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLEtBQUtpQixDQUFBQSxLQUFLakIsTUFBTSxJQUFJLEVBQUM7UUFDNURDLE1BQU1pQixLQUFLQyxLQUFLLENBQUNMLFVBQVViLElBQUksR0FBSSxLQUFLZ0IsQ0FBQUEsS0FBS2hCLElBQUksSUFBSSxFQUFDO1FBQ3REQyxVQUFVZ0IsS0FBS0MsS0FBSyxDQUFDTCxVQUFVWixRQUFRLEdBQUksS0FBS2UsQ0FBQUEsS0FBS2YsUUFBUSxJQUFJLEVBQUM7SUFDcEU7QUFDRixFQUFFO0FBRUYsbURBQW1ELEdBQzVDLE1BQU1rQixnQkFBZ0IsQ0FBQ0w7SUFDNUIsT0FBTzVCLFdBQVcsQ0FBQzRCLE9BQU8sRUFBRVIsU0FBU2xCLE9BQU87QUFDOUMsRUFBRTtBQUVGLDREQUE0RCxHQUNyRCxNQUFNZ0Msc0JBQXNCLENBQUNOO0lBQ2xDLE1BQU1DLE1BQU03QixXQUFXLENBQUM0QixPQUFPO0lBQy9CLElBQUlDLEtBQUtULFNBQVNsQixPQUFPLGtCQUFrQixPQUFPMkIsSUFBSVQsT0FBTyxDQUFDRSxNQUFNO0lBQ3BFLE9BQU87QUFDVCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvb3JpZ2lucy50cz9iNmVmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBHREQgRXh0ZW5zaW9uIOKAlCBDaGFyYWN0ZXIgUmFjZXMgKHBhc3NpdmUgYm9udXNlcyBsYXllcikgKi9cblxuaW1wb3J0IHR5cGUgeyBCYXNlU3RhdHMgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgVHlwZXMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG5cbmV4cG9ydCB0eXBlIENoYXJhY3Rlck9yaWdpbiA9XG4gIHwgXCJodW1hblwiXG4gIHwgXCJvcmNcIlxuICB8IFwic2tlbGV0b25cIlxuICB8IFwiZGVtb25cIlxuICB8IFwiZG9nZm9sa1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9yaWdpblN0YXRNb2RpZmllcnMge1xuICAvKiogUGVyY2VudGFnZSBtb2RpZmllcnMgcGVyIHN0YXQuIEUuZy4gMC4wNSA9ICs1JSAqL1xuICBzdHJlbmd0aD86IG51bWJlcjtcbiAgYWdpbGl0eT86IG51bWJlcjtcbiAgdml0YWxpdHk/OiBudW1iZXI7XG4gIGVuZHVyYW5jZT86IG51bWJlcjtcbiAgaW50ZWxsaWdlbmNlPzogbnVtYmVyO1xuICB3aXNkb20/OiBudW1iZXI7XG4gIGx1Y2s/OiBudW1iZXI7XG4gIGNoYXJpc21hPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yaWdpbkRlZiB7XG4gIGlkOiBDaGFyYWN0ZXJPcmlnaW47XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGljb246IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgYm9udXNEZXNjcmlwdGlvbjogc3RyaW5nO1xuICBzdGF0TW9kaWZpZXJzOiBPcmlnaW5TdGF0TW9kaWZpZXJzO1xuICAvKiogU3BlY2lhbCBwYXNzaXZlIGFiaWxpdHkgKG5vdCBzdGF0LWJhc2VkKSAqL1xuICBwYXNzaXZlPzoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNoYW5jZTogbnVtYmVyO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIH07XG59XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBDb25zdGFudHMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG5cbmV4cG9ydCBjb25zdCBBTExfT1JJR0lOUzogQ2hhcmFjdGVyT3JpZ2luW10gPSBbXG4gIFwiaHVtYW5cIixcbiAgXCJvcmNcIixcbiAgXCJza2VsZXRvblwiLFxuICBcImRlbW9uXCIsXG4gIFwiZG9nZm9sa1wiLFxuXTtcblxuZXhwb3J0IGNvbnN0IE9SSUdJTl9DSEFOR0VfQ09TVCA9IDUwMDtcblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIE9yaWdpbiBEZWZpbml0aW9ucyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cblxuZXhwb3J0IGNvbnN0IE9SSUdJTl9ERUZTOiBSZWNvcmQ8Q2hhcmFjdGVyT3JpZ2luLCBPcmlnaW5EZWY+ID0ge1xuICBodW1hbjoge1xuICAgIGlkOiBcImh1bWFuXCIsXG4gICAgbGFiZWw6IFwiSHVtYW5cIixcbiAgICBpY29uOiBcIvCfp5FcIixcbiAgICBkZXNjcmlwdGlvbjogXCJWZXJzYXRpbGUgYW5kIGFkYXB0YWJsZSwgYmFsYW5jZWQgaW4gYWxsIGFzcGVjdHNcIixcbiAgICBib251c0Rlc2NyaXB0aW9uOiBcIis1JSB0byBhbGwgc3RhdHNcIixcbiAgICBzdGF0TW9kaWZpZXJzOiB7XG4gICAgICBzdHJlbmd0aDogMC4wNSxcbiAgICAgIGFnaWxpdHk6IDAuMDUsXG4gICAgICB2aXRhbGl0eTogMC4wNSxcbiAgICAgIGVuZHVyYW5jZTogMC4wNSxcbiAgICAgIGludGVsbGlnZW5jZTogMC4wNSxcbiAgICAgIHdpc2RvbTogMC4wNSxcbiAgICAgIGx1Y2s6IDAuMDUsXG4gICAgICBjaGFyaXNtYTogMC4wNSxcbiAgICB9LFxuICB9LFxuICBvcmM6IHtcbiAgICBpZDogXCJvcmNcIixcbiAgICBsYWJlbDogXCJPcmNcIixcbiAgICBpY29uOiBcIvCfkblcIixcbiAgICBkZXNjcmlwdGlvbjogXCJCcnV0YWwgd2FycmlvcnMsIGZlYXJlZCBmb3IgdGhlaXIgcmF3IHN0cmVuZ3RoXCIsXG4gICAgYm9udXNEZXNjcmlwdGlvbjogXCIrOCUgU1RSLCAtMyUgRU5EXCIsXG4gICAgc3RhdE1vZGlmaWVyczoge1xuICAgICAgc3RyZW5ndGg6IDAuMDgsXG4gICAgICBlbmR1cmFuY2U6IC0wLjAzLFxuICAgIH0sXG4gIH0sXG4gIHNrZWxldG9uOiB7XG4gICAgaWQ6IFwic2tlbGV0b25cIixcbiAgICBsYWJlbDogXCJTa2VsZXRvblwiLFxuICAgIGljb246IFwi8J+SgFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlVuZGVhZCByZW1uYW50cywgc3dpZnQgYW5kIGVlcmlseSBsdWNreVwiLFxuICAgIGJvbnVzRGVzY3JpcHRpb246IFwiKzYlIEFHSSwgKzQlIExDS1wiLFxuICAgIHN0YXRNb2RpZmllcnM6IHtcbiAgICAgIGFnaWxpdHk6IDAuMDYsXG4gICAgICBsdWNrOiAwLjA0LFxuICAgIH0sXG4gIH0sXG4gIGRlbW9uOiB7XG4gICAgaWQ6IFwiZGVtb25cIixcbiAgICBsYWJlbDogXCJEZW1vblwiLFxuICAgIGljb246IFwi8J+YiFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkluZmVybmFsIGJlaW5ncywgYXJtb3JlZCBpbiBoZWxsZmlyZSBhbmQgcmVzaWxpZW5jZVwiLFxuICAgIGJvbnVzRGVzY3JpcHRpb246IFwiKzglIEVORCwgKzUlIFZJVFwiLFxuICAgIHN0YXRNb2RpZmllcnM6IHtcbiAgICAgIGVuZHVyYW5jZTogMC4wOCxcbiAgICAgIHZpdGFsaXR5OiAwLjA1LFxuICAgIH0sXG4gIH0sXG4gIGRvZ2ZvbGs6IHtcbiAgICBpZDogXCJkb2dmb2xrXCIsXG4gICAgbGFiZWw6IFwiRG9nZm9sa1wiLFxuICAgIGljb246IFwi8J+QlVwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkxveWFsIGNhbmluZSB3YXJyaW9ycyDigJQgdGhleSByZWZ1c2UgdG8gc3RheSBkb3duXCIsXG4gICAgYm9udXNEZXNjcmlwdGlvbjogXCI1JSBjaGFuY2UgdG8gY2hlYXQgZGVhdGggKHN1cnZpdmUgYXQgMSBIUClcIixcbiAgICBzdGF0TW9kaWZpZXJzOiB7fSxcbiAgICBwYXNzaXZlOiB7XG4gICAgICBpZDogXCJjaGVhdGluZ19kZWF0aFwiLFxuICAgICAgbmFtZTogXCJDaGVhdGluZyBEZWF0aFwiLFxuICAgICAgY2hhbmNlOiAwLjA1LFxuICAgICAgZGVzY3JpcHRpb246IFwiNSUgY2hhbmNlIHRvIHN1cnZpdmUgYSBraWxsaW5nIGJsb3cgd2l0aCAxIEhQXCIsXG4gICAgfSxcbiAgfSxcbn07XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBVSSBTdHlsZSBNYXBzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuXG5leHBvcnQgY29uc3QgT1JJR0lOX0dSQURJRU5UOiBSZWNvcmQ8Q2hhcmFjdGVyT3JpZ2luLCBzdHJpbmc+ID0ge1xuICBodW1hbjogXCJmcm9tLWFtYmVyLTYwMC8yMCB0by15ZWxsb3ctNjAwLzIwXCIsXG4gIG9yYzogXCJmcm9tLXJlZC02MDAvMjAgdG8tcm9zZS02MDAvMjBcIixcbiAgc2tlbGV0b246IFwiZnJvbS1wdXJwbGUtNjAwLzIwIHRvLWZ1Y2hzaWEtNjAwLzIwXCIsXG4gIGRlbW9uOiBcImZyb20tY3lhbi02MDAvMjAgdG8tYmx1ZS02MDAvMjBcIixcbiAgZG9nZm9sazogXCJmcm9tLW9yYW5nZS02MDAvMjAgdG8teWVsbG93LTYwMC8yMFwiLFxufTtcblxuZXhwb3J0IGNvbnN0IE9SSUdJTl9CT1JERVI6IFJlY29yZDxDaGFyYWN0ZXJPcmlnaW4sIHN0cmluZz4gPSB7XG4gIGh1bWFuOiBcImJvcmRlci1hbWJlci01MDAvNDAgaG92ZXI6Ym9yZGVyLWFtYmVyLTQwMC82MFwiLFxuICBvcmM6IFwiYm9yZGVyLXJlZC01MDAvNDAgaG92ZXI6Ym9yZGVyLXJlZC00MDAvNjBcIixcbiAgc2tlbGV0b246IFwiYm9yZGVyLXB1cnBsZS01MDAvNDAgaG92ZXI6Ym9yZGVyLXB1cnBsZS00MDAvNjBcIixcbiAgZGVtb246IFwiYm9yZGVyLWN5YW4tNTAwLzQwIGhvdmVyOmJvcmRlci1jeWFuLTQwMC82MFwiLFxuICBkb2dmb2xrOiBcImJvcmRlci1vcmFuZ2UtNTAwLzQwIGhvdmVyOmJvcmRlci1vcmFuZ2UtNDAwLzYwXCIsXG59O1xuXG5leHBvcnQgY29uc3QgT1JJR0lOX0FDQ0VOVDogUmVjb3JkPENoYXJhY3Rlck9yaWdpbiwgc3RyaW5nPiA9IHtcbiAgaHVtYW46IFwidGV4dC1hbWJlci00MDBcIixcbiAgb3JjOiBcInRleHQtcmVkLTQwMFwiLFxuICBza2VsZXRvbjogXCJ0ZXh0LXB1cnBsZS00MDBcIixcbiAgZGVtb246IFwidGV4dC1jeWFuLTQwMFwiLFxuICBkb2dmb2xrOiBcInRleHQtb3JhbmdlLTQwMFwiLFxufTtcblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIExvZ2ljIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuXG4vKiogQXBwbHkgb3JpZ2luIHBlcmNlbnRhZ2UgYm9udXNlcyB0byBiYXNlIHN0YXRzLiBObyBzdGFja2luZyBtdWx0aXBsaWVyLiAqL1xuZXhwb3J0IGNvbnN0IGFwcGx5T3JpZ2luQm9udXNlcyA9IChcbiAgYmFzZVN0YXRzOiBCYXNlU3RhdHMsXG4gIG9yaWdpbjogQ2hhcmFjdGVyT3JpZ2luXG4pOiBCYXNlU3RhdHMgPT4ge1xuICBjb25zdCBkZWYgPSBPUklHSU5fREVGU1tvcmlnaW5dO1xuICBpZiAoIWRlZikgcmV0dXJuIHsgLi4uYmFzZVN0YXRzIH07XG5cbiAgY29uc3QgbW9kcyA9IGRlZi5zdGF0TW9kaWZpZXJzO1xuXG4gIHJldHVybiB7XG4gICAgc3RyZW5ndGg6IE1hdGguZmxvb3IoYmFzZVN0YXRzLnN0cmVuZ3RoICogKDEgKyAobW9kcy5zdHJlbmd0aCA/PyAwKSkpLFxuICAgIGFnaWxpdHk6IE1hdGguZmxvb3IoYmFzZVN0YXRzLmFnaWxpdHkgKiAoMSArIChtb2RzLmFnaWxpdHkgPz8gMCkpKSxcbiAgICB2aXRhbGl0eTogTWF0aC5mbG9vcihiYXNlU3RhdHMudml0YWxpdHkgKiAoMSArIChtb2RzLnZpdGFsaXR5ID8/IDApKSksXG4gICAgZW5kdXJhbmNlOiBNYXRoLmZsb29yKGJhc2VTdGF0cy5lbmR1cmFuY2UgKiAoMSArIChtb2RzLmVuZHVyYW5jZSA/PyAwKSkpLFxuICAgIGludGVsbGlnZW5jZTogTWF0aC5mbG9vcihiYXNlU3RhdHMuaW50ZWxsaWdlbmNlICogKDEgKyAobW9kcy5pbnRlbGxpZ2VuY2UgPz8gMCkpKSxcbiAgICB3aXNkb206IE1hdGguZmxvb3IoYmFzZVN0YXRzLndpc2RvbSAqICgxICsgKG1vZHMud2lzZG9tID8/IDApKSksXG4gICAgbHVjazogTWF0aC5mbG9vcihiYXNlU3RhdHMubHVjayAqICgxICsgKG1vZHMubHVjayA/PyAwKSkpLFxuICAgIGNoYXJpc21hOiBNYXRoLmZsb29yKGJhc2VTdGF0cy5jaGFyaXNtYSAqICgxICsgKG1vZHMuY2hhcmlzbWEgPz8gMCkpKSxcbiAgfTtcbn07XG5cbi8qKiBDaGVjayBpZiBvcmlnaW4gaGFzIHRoZSBjaGVhdGluZ19kZWF0aCBwYXNzaXZlICovXG5leHBvcnQgY29uc3QgaGFzQ2hlYXREZWF0aCA9IChvcmlnaW46IENoYXJhY3Rlck9yaWdpbik6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gT1JJR0lOX0RFRlNbb3JpZ2luXT8ucGFzc2l2ZT8uaWQgPT09IFwiY2hlYXRpbmdfZGVhdGhcIjtcbn07XG5cbi8qKiBHZXQgY2hlYXRpbmdfZGVhdGggY2hhbmNlICgwIGlmIG9yaWdpbiBkb2Vzbid0IGhhdmUgaXQpICovXG5leHBvcnQgY29uc3QgZ2V0Q2hlYXREZWF0aENoYW5jZSA9IChvcmlnaW46IENoYXJhY3Rlck9yaWdpbik6IG51bWJlciA9PiB7XG4gIGNvbnN0IGRlZiA9IE9SSUdJTl9ERUZTW29yaWdpbl07XG4gIGlmIChkZWY/LnBhc3NpdmU/LmlkID09PSBcImNoZWF0aW5nX2RlYXRoXCIpIHJldHVybiBkZWYucGFzc2l2ZS5jaGFuY2U7XG4gIHJldHVybiAwO1xufTtcbiJdLCJuYW1lcyI6WyJBTExfT1JJR0lOUyIsIk9SSUdJTl9DSEFOR0VfQ09TVCIsIk9SSUdJTl9ERUZTIiwiaHVtYW4iLCJpZCIsImxhYmVsIiwiaWNvbiIsImRlc2NyaXB0aW9uIiwiYm9udXNEZXNjcmlwdGlvbiIsInN0YXRNb2RpZmllcnMiLCJzdHJlbmd0aCIsImFnaWxpdHkiLCJ2aXRhbGl0eSIsImVuZHVyYW5jZSIsImludGVsbGlnZW5jZSIsIndpc2RvbSIsImx1Y2siLCJjaGFyaXNtYSIsIm9yYyIsInNrZWxldG9uIiwiZGVtb24iLCJkb2dmb2xrIiwicGFzc2l2ZSIsIm5hbWUiLCJjaGFuY2UiLCJPUklHSU5fR1JBRElFTlQiLCJPUklHSU5fQk9SREVSIiwiT1JJR0lOX0FDQ0VOVCIsImFwcGx5T3JpZ2luQm9udXNlcyIsImJhc2VTdGF0cyIsIm9yaWdpbiIsImRlZiIsIm1vZHMiLCJNYXRoIiwiZmxvb3IiLCJoYXNDaGVhdERlYXRoIiwiZ2V0Q2hlYXREZWF0aENoYW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/origins.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/progression.ts":
/*!*********************************!*\
  !*** ./lib/game/progression.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   XP_REWARD: () => (/* binding */ XP_REWARD),\n/* harmony export */   goldForPvPLoss: () => (/* binding */ goldForPvPLoss),\n/* harmony export */   goldForPvPWin: () => (/* binding */ goldForPvPWin),\n/* harmony export */   scaleXpByLevel: () => (/* binding */ scaleXpByLevel),\n/* harmony export */   xpForLevel: () => (/* binding */ xpForLevel)\n/* harmony export */ });\n/** GDD §3.1 - XP required for level N */ const xpForLevel = (level)=>{\n    return Math.floor(100 * Math.pow(level, 1.8) + 50 * level);\n};\n/** GDD §3.1 - Base XP sources */ const XP_REWARD = {\n    PVP_WIN: 100,\n    PVP_LOSS: 30,\n    EASY_DUNGEON_PER_FLOOR: 80,\n    NORMAL_DUNGEON_PER_FLOOR: 150,\n    HARD_DUNGEON_PER_FLOOR: 250,\n    BOSS_KILL: 500,\n    DAILY_QUEST: 200,\n    WEEKLY_QUEST: 1000\n};\n/** Scale XP by enemy level: *(1 + Enemy_Level/50) */ const scaleXpByLevel = (baseXp, enemyLevel)=>{\n    return Math.floor(baseXp * (1 + enemyLevel / 50));\n};\n/** GDD §6.4 - Gold per match */ const goldForPvPWin = (oppRating, winStreak)=>{\n    let gold = 100 + Math.floor(oppRating / 10);\n    if (winStreak >= 2) gold += 50;\n    if (winStreak >= 3) gold += 100;\n    if (winStreak >= 4) gold += 200;\n    if (winStreak >= 5) gold += 400;\n    return gold;\n};\nconst goldForPvPLoss = ()=>30;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9wcm9ncmVzc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLHVDQUF1QyxHQUNoQyxNQUFNQSxhQUFhLENBQUNDO0lBQ3pCLE9BQU9DLEtBQUtDLEtBQUssQ0FBQyxNQUFNRCxLQUFLRSxHQUFHLENBQUNILE9BQU8sT0FBTyxLQUFLQTtBQUN0RCxFQUFFO0FBRUYsK0JBQStCLEdBQ3hCLE1BQU1JLFlBQVk7SUFDdkJDLFNBQVM7SUFDVEMsVUFBVTtJQUNWQyx3QkFBd0I7SUFDeEJDLDBCQUEwQjtJQUMxQkMsd0JBQXdCO0lBQ3hCQyxXQUFXO0lBQ1hDLGFBQWE7SUFDYkMsY0FBYztBQUNoQixFQUFXO0FBRVgsbURBQW1ELEdBQzVDLE1BQU1DLGlCQUFpQixDQUFDQyxRQUFnQkM7SUFDN0MsT0FBT2QsS0FBS0MsS0FBSyxDQUFDWSxTQUFVLEtBQUlDLGFBQWEsRUFBQztBQUNoRCxFQUFFO0FBRUYsOEJBQThCLEdBQ3ZCLE1BQU1DLGdCQUFnQixDQUFDQyxXQUFtQkM7SUFDL0MsSUFBSUMsT0FBTyxNQUFNbEIsS0FBS0MsS0FBSyxDQUFDZSxZQUFZO0lBQ3hDLElBQUlDLGFBQWEsR0FBR0MsUUFBUTtJQUM1QixJQUFJRCxhQUFhLEdBQUdDLFFBQVE7SUFDNUIsSUFBSUQsYUFBYSxHQUFHQyxRQUFRO0lBQzVCLElBQUlELGFBQWEsR0FBR0MsUUFBUTtJQUM1QixPQUFPQTtBQUNULEVBQUU7QUFFSyxNQUFNQyxpQkFBaUIsSUFBYyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvcHJvZ3Jlc3Npb24udHM/ODNiOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogR0REIMKnMy4xIC0gWFAgcmVxdWlyZWQgZm9yIGxldmVsIE4gKi9cbmV4cG9ydCBjb25zdCB4cEZvckxldmVsID0gKGxldmVsOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICByZXR1cm4gTWF0aC5mbG9vcigxMDAgKiBNYXRoLnBvdyhsZXZlbCwgMS44KSArIDUwICogbGV2ZWwpO1xufTtcblxuLyoqIEdERCDCpzMuMSAtIEJhc2UgWFAgc291cmNlcyAqL1xuZXhwb3J0IGNvbnN0IFhQX1JFV0FSRCA9IHtcbiAgUFZQX1dJTjogMTAwLFxuICBQVlBfTE9TUzogMzAsXG4gIEVBU1lfRFVOR0VPTl9QRVJfRkxPT1I6IDgwLFxuICBOT1JNQUxfRFVOR0VPTl9QRVJfRkxPT1I6IDE1MCxcbiAgSEFSRF9EVU5HRU9OX1BFUl9GTE9PUjogMjUwLFxuICBCT1NTX0tJTEw6IDUwMCxcbiAgREFJTFlfUVVFU1Q6IDIwMCxcbiAgV0VFS0xZX1FVRVNUOiAxMDAwLFxufSBhcyBjb25zdDtcblxuLyoqIFNjYWxlIFhQIGJ5IGVuZW15IGxldmVsOiAqKDEgKyBFbmVteV9MZXZlbC81MCkgKi9cbmV4cG9ydCBjb25zdCBzY2FsZVhwQnlMZXZlbCA9IChiYXNlWHA6IG51bWJlciwgZW5lbXlMZXZlbDogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoYmFzZVhwICogKDEgKyBlbmVteUxldmVsIC8gNTApKTtcbn07XG5cbi8qKiBHREQgwqc2LjQgLSBHb2xkIHBlciBtYXRjaCAqL1xuZXhwb3J0IGNvbnN0IGdvbGRGb3JQdlBXaW4gPSAob3BwUmF0aW5nOiBudW1iZXIsIHdpblN0cmVhazogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgbGV0IGdvbGQgPSAxMDAgKyBNYXRoLmZsb29yKG9wcFJhdGluZyAvIDEwKTtcbiAgaWYgKHdpblN0cmVhayA+PSAyKSBnb2xkICs9IDUwO1xuICBpZiAod2luU3RyZWFrID49IDMpIGdvbGQgKz0gMTAwO1xuICBpZiAod2luU3RyZWFrID49IDQpIGdvbGQgKz0gMjAwO1xuICBpZiAod2luU3RyZWFrID49IDUpIGdvbGQgKz0gNDAwO1xuICByZXR1cm4gZ29sZDtcbn07XG5cbmV4cG9ydCBjb25zdCBnb2xkRm9yUHZQTG9zcyA9ICgpOiBudW1iZXIgPT4gMzA7XG4iXSwibmFtZXMiOlsieHBGb3JMZXZlbCIsImxldmVsIiwiTWF0aCIsImZsb29yIiwicG93IiwiWFBfUkVXQVJEIiwiUFZQX1dJTiIsIlBWUF9MT1NTIiwiRUFTWV9EVU5HRU9OX1BFUl9GTE9PUiIsIk5PUk1BTF9EVU5HRU9OX1BFUl9GTE9PUiIsIkhBUkRfRFVOR0VPTl9QRVJfRkxPT1IiLCJCT1NTX0tJTEwiLCJEQUlMWV9RVUVTVCIsIldFRUtMWV9RVUVTVCIsInNjYWxlWHBCeUxldmVsIiwiYmFzZVhwIiwiZW5lbXlMZXZlbCIsImdvbGRGb3JQdlBXaW4iLCJvcHBSYXRpbmciLCJ3aW5TdHJlYWsiLCJnb2xkIiwiZ29sZEZvclB2UExvc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/progression.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/quests.ts":
/*!****************************!*\
  !*** ./lib/game/quests.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   updateDailyQuestProgress: () => (/* binding */ updateDailyQuestProgress)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n\nconst updateDailyQuestProgress = async (characterId, questType, amount = 1)=>{\n    const today = new Date();\n    today.setUTCHours(0, 0, 0, 0);\n    const character = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.character.findUnique({\n        where: {\n            id: characterId\n        },\n        select: {\n            userId: true\n        }\n    });\n    if (!character) return;\n    const quests = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.dailyQuest.findMany({\n        where: {\n            characterId,\n            day: today,\n            questType,\n            completed: false\n        }\n    });\n    for (const q of quests){\n        const newProgress = q.progress + amount;\n        if (newProgress >= q.target) {\n            // Atomic: only complete if not already completed (prevents double-reward race)\n            await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n                const fresh = await tx.dailyQuest.findUnique({\n                    where: {\n                        id: q.id\n                    }\n                });\n                if (!fresh || fresh.completed) return; // Already completed by another request\n                await tx.dailyQuest.update({\n                    where: {\n                        id: q.id\n                    },\n                    data: {\n                        progress: q.target,\n                        completed: true\n                    }\n                });\n                await tx.character.update({\n                    where: {\n                        id: characterId\n                    },\n                    data: {\n                        gold: {\n                            increment: q.rewardGold\n                        },\n                        currentXp: {\n                            increment: q.rewardXp\n                        }\n                    }\n                });\n                await tx.user.update({\n                    where: {\n                        id: character.userId\n                    },\n                    data: {\n                        gems: {\n                            increment: q.rewardGems\n                        }\n                    }\n                });\n            });\n        } else {\n            await _lib_db__WEBPACK_IMPORTED_MODULE_0__.prisma.dailyQuest.update({\n                where: {\n                    id: q.id\n                },\n                data: {\n                    progress: {\n                        increment: amount\n                    }\n                }\n            });\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZ2FtZS9xdWVzdHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBa0M7QUFFM0IsTUFBTUMsMkJBQTJCLE9BQ3RDQyxhQUNBQyxXQUNBQyxTQUFpQixDQUFDO0lBRWxCLE1BQU1DLFFBQVEsSUFBSUM7SUFDbEJELE1BQU1FLFdBQVcsQ0FBQyxHQUFHLEdBQUcsR0FBRztJQUUzQixNQUFNQyxZQUFZLE1BQU1SLDJDQUFNQSxDQUFDUSxTQUFTLENBQUNDLFVBQVUsQ0FBQztRQUNsREMsT0FBTztZQUFFQyxJQUFJVDtRQUFZO1FBQ3pCVSxRQUFRO1lBQUVDLFFBQVE7UUFBSztJQUN6QjtJQUNBLElBQUksQ0FBQ0wsV0FBVztJQUVoQixNQUFNTSxTQUFTLE1BQU1kLDJDQUFNQSxDQUFDZSxVQUFVLENBQUNDLFFBQVEsQ0FBQztRQUM5Q04sT0FBTztZQUFFUjtZQUFhZSxLQUFLWjtZQUFPRjtZQUFXZSxXQUFXO1FBQU07SUFDaEU7SUFFQSxLQUFLLE1BQU1DLEtBQUtMLE9BQVE7UUFDdEIsTUFBTU0sY0FBY0QsRUFBRUUsUUFBUSxHQUFHakI7UUFDakMsSUFBSWdCLGVBQWVELEVBQUVHLE1BQU0sRUFBRTtZQUMzQiwrRUFBK0U7WUFDL0UsTUFBTXRCLDJDQUFNQSxDQUFDdUIsWUFBWSxDQUFDLE9BQU9DO2dCQUMvQixNQUFNQyxRQUFRLE1BQU1ELEdBQUdULFVBQVUsQ0FBQ04sVUFBVSxDQUFDO29CQUFFQyxPQUFPO3dCQUFFQyxJQUFJUSxFQUFFUixFQUFFO29CQUFDO2dCQUFFO2dCQUNuRSxJQUFJLENBQUNjLFNBQVNBLE1BQU1QLFNBQVMsRUFBRSxRQUFRLHVDQUF1QztnQkFFOUUsTUFBTU0sR0FBR1QsVUFBVSxDQUFDVyxNQUFNLENBQUM7b0JBQ3pCaEIsT0FBTzt3QkFBRUMsSUFBSVEsRUFBRVIsRUFBRTtvQkFBQztvQkFDbEJnQixNQUFNO3dCQUFFTixVQUFVRixFQUFFRyxNQUFNO3dCQUFFSixXQUFXO29CQUFLO2dCQUM5QztnQkFDQSxNQUFNTSxHQUFHaEIsU0FBUyxDQUFDa0IsTUFBTSxDQUFDO29CQUN4QmhCLE9BQU87d0JBQUVDLElBQUlUO29CQUFZO29CQUN6QnlCLE1BQU07d0JBQ0pDLE1BQU07NEJBQUVDLFdBQVdWLEVBQUVXLFVBQVU7d0JBQUM7d0JBQ2hDQyxXQUFXOzRCQUFFRixXQUFXVixFQUFFYSxRQUFRO3dCQUFDO29CQUNyQztnQkFDRjtnQkFDQSxNQUFNUixHQUFHUyxJQUFJLENBQUNQLE1BQU0sQ0FBQztvQkFDbkJoQixPQUFPO3dCQUFFQyxJQUFJSCxVQUFVSyxNQUFNO29CQUFDO29CQUM5QmMsTUFBTTt3QkFBRU8sTUFBTTs0QkFBRUwsV0FBV1YsRUFBRWdCLFVBQVU7d0JBQUM7b0JBQUU7Z0JBQzVDO1lBQ0Y7UUFDRixPQUFPO1lBQ0wsTUFBTW5DLDJDQUFNQSxDQUFDZSxVQUFVLENBQUNXLE1BQU0sQ0FBQztnQkFDN0JoQixPQUFPO29CQUFFQyxJQUFJUSxFQUFFUixFQUFFO2dCQUFDO2dCQUNsQmdCLE1BQU07b0JBQUVOLFVBQVU7d0JBQUVRLFdBQVd6QjtvQkFBTztnQkFBRTtZQUMxQztRQUNGO0lBQ0Y7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJvbi1maXN0LWFyZW5hLy4vbGliL2dhbWUvcXVlc3RzLnRzPzg3NmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL2RiXCI7XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVEYWlseVF1ZXN0UHJvZ3Jlc3MgPSBhc3luYyAoXG4gIGNoYXJhY3RlcklkOiBzdHJpbmcsXG4gIHF1ZXN0VHlwZTogXCJwdnBfd2luc1wiIHwgXCJkdW5nZW9uc19jb21wbGV0ZVwiLFxuICBhbW91bnQ6IG51bWJlciA9IDFcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gIHRvZGF5LnNldFVUQ0hvdXJzKDAsIDAsIDAsIDApO1xuXG4gIGNvbnN0IGNoYXJhY3RlciA9IGF3YWl0IHByaXNtYS5jaGFyYWN0ZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IGNoYXJhY3RlcklkIH0sXG4gICAgc2VsZWN0OiB7IHVzZXJJZDogdHJ1ZSB9LFxuICB9KTtcbiAgaWYgKCFjaGFyYWN0ZXIpIHJldHVybjtcblxuICBjb25zdCBxdWVzdHMgPSBhd2FpdCBwcmlzbWEuZGFpbHlRdWVzdC5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgY2hhcmFjdGVySWQsIGRheTogdG9kYXksIHF1ZXN0VHlwZSwgY29tcGxldGVkOiBmYWxzZSB9LFxuICB9KTtcblxuICBmb3IgKGNvbnN0IHEgb2YgcXVlc3RzKSB7XG4gICAgY29uc3QgbmV3UHJvZ3Jlc3MgPSBxLnByb2dyZXNzICsgYW1vdW50O1xuICAgIGlmIChuZXdQcm9ncmVzcyA+PSBxLnRhcmdldCkge1xuICAgICAgLy8gQXRvbWljOiBvbmx5IGNvbXBsZXRlIGlmIG5vdCBhbHJlYWR5IGNvbXBsZXRlZCAocHJldmVudHMgZG91YmxlLXJld2FyZCByYWNlKVxuICAgICAgYXdhaXQgcHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcbiAgICAgICAgY29uc3QgZnJlc2ggPSBhd2FpdCB0eC5kYWlseVF1ZXN0LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogcS5pZCB9IH0pO1xuICAgICAgICBpZiAoIWZyZXNoIHx8IGZyZXNoLmNvbXBsZXRlZCkgcmV0dXJuOyAvLyBBbHJlYWR5IGNvbXBsZXRlZCBieSBhbm90aGVyIHJlcXVlc3RcblxuICAgICAgICBhd2FpdCB0eC5kYWlseVF1ZXN0LnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IHEuaWQgfSxcbiAgICAgICAgICBkYXRhOiB7IHByb2dyZXNzOiBxLnRhcmdldCwgY29tcGxldGVkOiB0cnVlIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0eC5jaGFyYWN0ZXIudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogY2hhcmFjdGVySWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnb2xkOiB7IGluY3JlbWVudDogcS5yZXdhcmRHb2xkIH0sXG4gICAgICAgICAgICBjdXJyZW50WHA6IHsgaW5jcmVtZW50OiBxLnJld2FyZFhwIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHR4LnVzZXIudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogY2hhcmFjdGVyLnVzZXJJZCB9LFxuICAgICAgICAgIGRhdGE6IHsgZ2VtczogeyBpbmNyZW1lbnQ6IHEucmV3YXJkR2VtcyB9IH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHByaXNtYS5kYWlseVF1ZXN0LnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBxLmlkIH0sXG4gICAgICAgIGRhdGE6IHsgcHJvZ3Jlc3M6IHsgaW5jcmVtZW50OiBhbW91bnQgfSB9LFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwidXBkYXRlRGFpbHlRdWVzdFByb2dyZXNzIiwiY2hhcmFjdGVySWQiLCJxdWVzdFR5cGUiLCJhbW91bnQiLCJ0b2RheSIsIkRhdGUiLCJzZXRVVENIb3VycyIsImNoYXJhY3RlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwic2VsZWN0IiwidXNlcklkIiwicXVlc3RzIiwiZGFpbHlRdWVzdCIsImZpbmRNYW55IiwiZGF5IiwiY29tcGxldGVkIiwicSIsIm5ld1Byb2dyZXNzIiwicHJvZ3Jlc3MiLCJ0YXJnZXQiLCIkdHJhbnNhY3Rpb24iLCJ0eCIsImZyZXNoIiwidXBkYXRlIiwiZGF0YSIsImdvbGQiLCJpbmNyZW1lbnQiLCJyZXdhcmRHb2xkIiwiY3VycmVudFhwIiwicmV3YXJkWHAiLCJ1c2VyIiwiZ2VtcyIsInJld2FyZEdlbXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/quests.ts\n");

/***/ }),

/***/ "(rsc)/./lib/game/stats.ts":
/*!***************************!*\
  !*** ./lib/game/stats.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   baseStatsFromCharacter: () => (/* binding */ baseStatsFromCharacter),\n/* harmony export */   computeDerivedStats: () => (/* binding */ computeDerivedStats),\n/* harmony export */   getArmorReduction: () => (/* binding */ getArmorReduction),\n/* harmony export */   getCritChance: () => (/* binding */ getCritChance),\n/* harmony export */   getCritDamageMult: () => (/* binding */ getCritDamageMult),\n/* harmony export */   getDodgeChance: () => (/* binding */ getDodgeChance),\n/* harmony export */   getEffectiveStats: () => (/* binding */ getEffectiveStats),\n/* harmony export */   getMagicResistPercent: () => (/* binding */ getMagicResistPercent),\n/* harmony export */   getMaxHp: () => (/* binding */ getMaxHp)\n/* harmony export */ });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ \"(rsc)/./lib/game/constants.ts\");\n/* harmony import */ var _origins__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./origins */ \"(rsc)/./lib/game/origins.ts\");\n\n\n/** GDD §2.1 - Max HP from VIT */ const getMaxHp = (vit)=>{\n    return Math.max(100, vit * _constants__WEBPACK_IMPORTED_MODULE_0__.HP_PER_VIT);\n};\n/** Armor damage reduction: Armor / (Armor + 100), cap 0.75 */ const getArmorReduction = (armor)=>{\n    if (armor <= 0) return 0;\n    return Math.min(_constants__WEBPACK_IMPORTED_MODULE_0__.ARMOR_REDUCTION_CAP, armor / (armor + _constants__WEBPACK_IMPORTED_MODULE_0__.ARMOR_DENOMINATOR));\n};\n/** Magic resist: MIN(0.70, WIS / (WIS + 150)) */ const getMagicResistPercent = (wis)=>{\n    if (wis <= 0) return 0;\n    return Math.min(_constants__WEBPACK_IMPORTED_MODULE_0__.MAGIC_RESIST_CAP, wis / (wis + _constants__WEBPACK_IMPORTED_MODULE_0__.MAGIC_RESIST_DENOM));\n};\n/** Crit chance % = 5 + AGI/10 + LCK/15 + equipment, max 50% */ const getCritChance = (agi, lck, equipmentBonus = 0)=>{\n    const total = _constants__WEBPACK_IMPORTED_MODULE_0__.BASE_CRIT_CHANCE + agi / 10 + lck / 15 + equipmentBonus;\n    return Math.min(_constants__WEBPACK_IMPORTED_MODULE_0__.MAX_CRIT_CHANCE, Math.max(0, total));\n};\n/** Crit damage mult = 1.5 + STR/500 + equipment%, max 2.8 */ const getCritDamageMult = (str, equipmentPercent = 0)=>{\n    const total = _constants__WEBPACK_IMPORTED_MODULE_0__.BASE_CRIT_DAMAGE + str / 500 + equipmentPercent / 100;\n    return Math.min(_constants__WEBPACK_IMPORTED_MODULE_0__.MAX_CRIT_DAMAGE_MULT, total);\n};\n/** Dodge % = 3 + AGI/8 + equipment, max 40% */ const getDodgeChance = (agi, equipmentBonus = 0)=>{\n    const total = _constants__WEBPACK_IMPORTED_MODULE_0__.BASE_DODGE + agi / 8 + equipmentBonus;\n    return Math.min(_constants__WEBPACK_IMPORTED_MODULE_0__.MAX_DODGE, Math.max(0, total));\n};\n/** Compute all derived stats from base stats and optional armor values */ const computeDerivedStats = (base, armorValue = 0, magicResistValue = 0, critEquipmentBonus = 0, critDmgEquipmentPercent = 0, dodgeEquipmentBonus = 0)=>{\n    const maxHp = getMaxHp(base.vitality);\n    return {\n        maxHp,\n        critChance: getCritChance(base.agility, base.luck, critEquipmentBonus),\n        critDamageMult: getCritDamageMult(base.strength, critDmgEquipmentPercent),\n        dodgeChance: getDodgeChance(base.agility, dodgeEquipmentBonus),\n        armor: armorValue,\n        magicResist: getMagicResistPercent(base.wisdom) * 100\n    };\n};\n/** Base stats from character (all 10 at start, then allocated) */ const baseStatsFromCharacter = (c)=>({\n        strength: c.strength,\n        agility: c.agility,\n        vitality: c.vitality,\n        endurance: c.endurance,\n        intelligence: c.intelligence,\n        wisdom: c.wisdom,\n        luck: c.luck,\n        charisma: c.charisma\n    });\n/** Get effective base stats with origin bonuses applied */ const getEffectiveStats = (c, origin)=>{\n    const raw = baseStatsFromCharacter(c);\n    if (!origin) return raw;\n    return (0,_origins__WEBPACK_IMPORTED_MODULE_1__.applyOriginBonuses)(raw, origin);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cmVuYS8uL2xpYi9nYW1lL3N0YXRzLnRzPzMyMzYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBCYXNlU3RhdHMsIENoYXJhY3Rlck9yaWdpbiwgRGVyaXZlZFN0YXRzIH0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7XG4gIEJBU0VfQ1JJVF9DSEFOQ0UsXG4gIE1BWF9DUklUX0NIQU5DRSxcbiAgQkFTRV9ET0RHRSxcbiAgTUFYX0RPREdFLFxuICBCQVNFX0NSSVRfREFNQUdFLFxuICBNQVhfQ1JJVF9EQU1BR0VfTVVMVCxcbiAgQVJNT1JfUkVEVUNUSU9OX0NBUCxcbiAgTUFHSUNfUkVTSVNUX0NBUCxcbiAgSFBfUEVSX1ZJVCxcbiAgQVJNT1JfREVOT01JTkFUT1IsXG4gIE1BR0lDX1JFU0lTVF9ERU5PTSxcbn0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBhcHBseU9yaWdpbkJvbnVzZXMgfSBmcm9tIFwiLi9vcmlnaW5zXCI7XG5cbi8qKiBHREQgwqcyLjEgLSBNYXggSFAgZnJvbSBWSVQgKi9cbmV4cG9ydCBjb25zdCBnZXRNYXhIcCA9ICh2aXQ6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIHJldHVybiBNYXRoLm1heCgxMDAsIHZpdCAqIEhQX1BFUl9WSVQpO1xufTtcblxuLyoqIEFybW9yIGRhbWFnZSByZWR1Y3Rpb246IEFybW9yIC8gKEFybW9yICsgMTAwKSwgY2FwIDAuNzUgKi9cbmV4cG9ydCBjb25zdCBnZXRBcm1vclJlZHVjdGlvbiA9IChhcm1vcjogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgaWYgKGFybW9yIDw9IDApIHJldHVybiAwO1xuICByZXR1cm4gTWF0aC5taW4oQVJNT1JfUkVEVUNUSU9OX0NBUCwgYXJtb3IgLyAoYXJtb3IgKyBBUk1PUl9ERU5PTUlOQVRPUikpO1xufTtcblxuLyoqIE1hZ2ljIHJlc2lzdDogTUlOKDAuNzAsIFdJUyAvIChXSVMgKyAxNTApKSAqL1xuZXhwb3J0IGNvbnN0IGdldE1hZ2ljUmVzaXN0UGVyY2VudCA9ICh3aXM6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIGlmICh3aXMgPD0gMCkgcmV0dXJuIDA7XG4gIHJldHVybiBNYXRoLm1pbihNQUdJQ19SRVNJU1RfQ0FQLCB3aXMgLyAod2lzICsgTUFHSUNfUkVTSVNUX0RFTk9NKSk7XG59O1xuXG4vKiogQ3JpdCBjaGFuY2UgJSA9IDUgKyBBR0kvMTAgKyBMQ0svMTUgKyBlcXVpcG1lbnQsIG1heCA1MCUgKi9cbmV4cG9ydCBjb25zdCBnZXRDcml0Q2hhbmNlID0gKFxuICBhZ2k6IG51bWJlcixcbiAgbGNrOiBudW1iZXIsXG4gIGVxdWlwbWVudEJvbnVzOiBudW1iZXIgPSAwXG4pOiBudW1iZXIgPT4ge1xuICBjb25zdCB0b3RhbCA9XG4gICAgQkFTRV9DUklUX0NIQU5DRSArIGFnaSAvIDEwICsgbGNrIC8gMTUgKyBlcXVpcG1lbnRCb251cztcbiAgcmV0dXJuIE1hdGgubWluKE1BWF9DUklUX0NIQU5DRSwgTWF0aC5tYXgoMCwgdG90YWwpKTtcbn07XG5cbi8qKiBDcml0IGRhbWFnZSBtdWx0ID0gMS41ICsgU1RSLzUwMCArIGVxdWlwbWVudCUsIG1heCAyLjggKi9cbmV4cG9ydCBjb25zdCBnZXRDcml0RGFtYWdlTXVsdCA9IChcbiAgc3RyOiBudW1iZXIsXG4gIGVxdWlwbWVudFBlcmNlbnQ6IG51bWJlciA9IDBcbik6IG51bWJlciA9PiB7XG4gIGNvbnN0IHRvdGFsID0gQkFTRV9DUklUX0RBTUFHRSArIHN0ciAvIDUwMCArIGVxdWlwbWVudFBlcmNlbnQgLyAxMDA7XG4gIHJldHVybiBNYXRoLm1pbihNQVhfQ1JJVF9EQU1BR0VfTVVMVCwgdG90YWwpO1xufTtcblxuLyoqIERvZGdlICUgPSAzICsgQUdJLzggKyBlcXVpcG1lbnQsIG1heCA0MCUgKi9cbmV4cG9ydCBjb25zdCBnZXREb2RnZUNoYW5jZSA9IChhZ2k6IG51bWJlciwgZXF1aXBtZW50Qm9udXM6IG51bWJlciA9IDApOiBudW1iZXIgPT4ge1xuICBjb25zdCB0b3RhbCA9IEJBU0VfRE9ER0UgKyBhZ2kgLyA4ICsgZXF1aXBtZW50Qm9udXM7XG4gIHJldHVybiBNYXRoLm1pbihNQVhfRE9ER0UsIE1hdGgubWF4KDAsIHRvdGFsKSk7XG59O1xuXG4vKiogQ29tcHV0ZSBhbGwgZGVyaXZlZCBzdGF0cyBmcm9tIGJhc2Ugc3RhdHMgYW5kIG9wdGlvbmFsIGFybW9yIHZhbHVlcyAqL1xuZXhwb3J0IGNvbnN0IGNvbXB1dGVEZXJpdmVkU3RhdHMgPSAoXG4gIGJhc2U6IEJhc2VTdGF0cyxcbiAgYXJtb3JWYWx1ZTogbnVtYmVyID0gMCxcbiAgbWFnaWNSZXNpc3RWYWx1ZTogbnVtYmVyID0gMCxcbiAgY3JpdEVxdWlwbWVudEJvbnVzOiBudW1iZXIgPSAwLFxuICBjcml0RG1nRXF1aXBtZW50UGVyY2VudDogbnVtYmVyID0gMCxcbiAgZG9kZ2VFcXVpcG1lbnRCb251czogbnVtYmVyID0gMFxuKTogRGVyaXZlZFN0YXRzID0+IHtcbiAgY29uc3QgbWF4SHAgPSBnZXRNYXhIcChiYXNlLnZpdGFsaXR5KTtcbiAgcmV0dXJuIHtcbiAgICBtYXhIcCxcbiAgICBjcml0Q2hhbmNlOiBnZXRDcml0Q2hhbmNlKGJhc2UuYWdpbGl0eSwgYmFzZS5sdWNrLCBjcml0RXF1aXBtZW50Qm9udXMpLFxuICAgIGNyaXREYW1hZ2VNdWx0OiBnZXRDcml0RGFtYWdlTXVsdChiYXNlLnN0cmVuZ3RoLCBjcml0RG1nRXF1aXBtZW50UGVyY2VudCksXG4gICAgZG9kZ2VDaGFuY2U6IGdldERvZGdlQ2hhbmNlKGJhc2UuYWdpbGl0eSwgZG9kZ2VFcXVpcG1lbnRCb251cyksXG4gICAgYXJtb3I6IGFybW9yVmFsdWUsXG4gICAgbWFnaWNSZXNpc3Q6IGdldE1hZ2ljUmVzaXN0UGVyY2VudChiYXNlLndpc2RvbSkgKiAxMDAsXG4gIH07XG59O1xuXG4vKiogQmFzZSBzdGF0cyBmcm9tIGNoYXJhY3RlciAoYWxsIDEwIGF0IHN0YXJ0LCB0aGVuIGFsbG9jYXRlZCkgKi9cbmV4cG9ydCBjb25zdCBiYXNlU3RhdHNGcm9tQ2hhcmFjdGVyID0gKGM6IHtcbiAgc3RyZW5ndGg6IG51bWJlcjtcbiAgYWdpbGl0eTogbnVtYmVyO1xuICB2aXRhbGl0eTogbnVtYmVyO1xuICBlbmR1cmFuY2U6IG51bWJlcjtcbiAgaW50ZWxsaWdlbmNlOiBudW1iZXI7XG4gIHdpc2RvbTogbnVtYmVyO1xuICBsdWNrOiBudW1iZXI7XG4gIGNoYXJpc21hOiBudW1iZXI7XG59KTogQmFzZVN0YXRzID0+ICh7XG4gIHN0cmVuZ3RoOiBjLnN0cmVuZ3RoLFxuICBhZ2lsaXR5OiBjLmFnaWxpdHksXG4gIHZpdGFsaXR5OiBjLnZpdGFsaXR5LFxuICBlbmR1cmFuY2U6IGMuZW5kdXJhbmNlLFxuICBpbnRlbGxpZ2VuY2U6IGMuaW50ZWxsaWdlbmNlLFxuICB3aXNkb206IGMud2lzZG9tLFxuICBsdWNrOiBjLmx1Y2ssXG4gIGNoYXJpc21hOiBjLmNoYXJpc21hLFxufSk7XG5cbi8qKiBHZXQgZWZmZWN0aXZlIGJhc2Ugc3RhdHMgd2l0aCBvcmlnaW4gYm9udXNlcyBhcHBsaWVkICovXG5leHBvcnQgY29uc3QgZ2V0RWZmZWN0aXZlU3RhdHMgPSAoXG4gIGM6IHtcbiAgICBzdHJlbmd0aDogbnVtYmVyO1xuICAgIGFnaWxpdHk6IG51bWJlcjtcbiAgICB2aXRhbGl0eTogbnVtYmVyO1xuICAgIGVuZHVyYW5jZTogbnVtYmVyO1xuICAgIGludGVsbGlnZW5jZTogbnVtYmVyO1xuICAgIHdpc2RvbTogbnVtYmVyO1xuICAgIGx1Y2s6IG51bWJlcjtcbiAgICBjaGFyaXNtYTogbnVtYmVyO1xuICB9LFxuICBvcmlnaW4/OiBDaGFyYWN0ZXJPcmlnaW5cbik6IEJhc2VTdGF0cyA9PiB7XG4gIGNvbnN0IHJhdyA9IGJhc2VTdGF0c0Zyb21DaGFyYWN0ZXIoYyk7XG4gIGlmICghb3JpZ2luKSByZXR1cm4gcmF3O1xuICByZXR1cm4gYXBwbHlPcmlnaW5Cb251c2VzKHJhdywgb3JpZ2luKTtcbn07XG4iXSwibmFtZXMiOlsiQkFTRV9DUklUX0NIQU5DRSIsIk1BWF9DUklUX0NIQU5DRSIsIkJBU0VfRE9ER0UiLCJNQVhfRE9ER0UiLCJCQVNFX0NSSVRfREFNQUdFIiwiTUFYX0NSSVRfREFNQUdFX01VTFQiLCJBUk1PUl9SRURVQ1RJT05fQ0FQIiwiTUFHSUNfUkVTSVNUX0NBUCIsIkhQX1BFUl9WSVQiLCJBUk1PUl9ERU5PTUlOQVRPUiIsIk1BR0lDX1JFU0lTVF9ERU5PTSIsImFwcGx5T3JpZ2luQm9udXNlcyIsImdldE1heEhwIiwidml0IiwiTWF0aCIsIm1heCIsImdldEFybW9yUmVkdWN0aW9uIiwiYXJtb3IiLCJtaW4iLCJnZXRNYWdpY1Jlc2lzdFBlcmNlbnQiLCJ3aXMiLCJnZXRDcml0Q2hhbmNlIiwiYWdpIiwibGNrIiwiZXF1aXBtZW50Qm9udXMiLCJ0b3RhbCIsImdldENyaXREYW1hZ2VNdWx0Iiwic3RyIiwiZXF1aXBtZW50UGVyY2VudCIsImdldERvZGdlQ2hhbmNlIiwiY29tcHV0ZURlcml2ZWRTdGF0cyIsImJhc2UiLCJhcm1vclZhbHVlIiwibWFnaWNSZXNpc3RWYWx1ZSIsImNyaXRFcXVpcG1lbnRCb251cyIsImNyaXREbWdFcXVpcG1lbnRQZXJjZW50IiwiZG9kZ2VFcXVpcG1lbnRCb251cyIsIm1heEhwIiwidml0YWxpdHkiLCJjcml0Q2hhbmNlIiwiYWdpbGl0eSIsImx1Y2siLCJjcml0RGFtYWdlTXVsdCIsInN0cmVuZ3RoIiwiZG9kZ2VDaGFuY2UiLCJtYWdpY1Jlc2lzdCIsIndpc2RvbSIsImJhc2VTdGF0c0Zyb21DaGFyYWN0ZXIiLCJjIiwiZW5kdXJhbmNlIiwiaW50ZWxsaWdlbmNlIiwiY2hhcmlzbWEiLCJnZXRFZmZlY3RpdmVTdGF0cyIsIm9yaWdpbiIsInJhdyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/game/stats.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerSupabaseClient: () => (/* binding */ createServerSupabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nconst createServerSupabaseClient = async ()=>{\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const url = \"https://pdidndmfavighhlnsxbf.supabase.co\";\n    const key = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBkaWRuZG1mYXZpZ2hobG5zeGJmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NDM1ODgsImV4cCI6MjA4NjQxOTU4OH0.eYdudzehvvT3r8zvk9cOUQOHwrLxa0vm77LokMC5E-E\";\n    if (!url || !key) {\n        throw new Error(\"Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n    }\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(url, key, {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                try {\n                    cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n                } catch  {\n                // ignore in Server Components\n                }\n            }\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFtRDtBQUNaO0FBRWhDLE1BQU1FLDZCQUE2QjtJQUN4QyxNQUFNQyxjQUFjLE1BQU1GLHFEQUFPQTtJQUNqQyxNQUFNRyxNQUFNQywwQ0FBb0M7SUFDaEQsTUFBTUcsTUFBTUgsa05BQXlDO0lBQ3JELElBQUksQ0FBQ0QsT0FBTyxDQUFDSSxLQUFLO1FBQ2hCLE1BQU0sSUFBSUUsTUFBTTtJQUNsQjtJQUNBLE9BQU9WLGlFQUFrQkEsQ0FBQ0ksS0FBS0ksS0FBSztRQUNsQ1AsU0FBUztZQUNQVTtnQkFDRSxPQUFPUixZQUFZUSxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQWlFO2dCQUN0RSxJQUFJO29CQUNGQSxhQUFhQyxPQUFPLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsT0FBTyxFQUFFLEdBQzVDZCxZQUFZZSxHQUFHLENBQUNILE1BQU1DLE9BQU9DO2dCQUVqQyxFQUFFLE9BQU07Z0JBQ04sOEJBQThCO2dCQUNoQztZQUNGO1FBQ0Y7SUFDRjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcm9uLWZpc3QtYXJlbmEvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zc3JcIjtcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVTZXJ2ZXJTdXBhYmFzZUNsaWVudCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG4gIGNvbnN0IHVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbiAgY29uc3Qga2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XG4gIGlmICghdXJsIHx8ICFrZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCBvciBORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWVwiKTtcbiAgfVxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KHVybCwga2V5LCB7XG4gICAgY29va2llczoge1xuICAgICAgZ2V0QWxsKCkge1xuICAgICAgICByZXR1cm4gY29va2llU3RvcmUuZ2V0QWxsKCk7XG4gICAgICB9LFxuICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldDogeyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmc7IG9wdGlvbnM/OiBvYmplY3QgfVtdKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29va2llc1RvU2V0LmZvckVhY2goKHsgbmFtZSwgdmFsdWUsIG9wdGlvbnMgfSkgPT5cbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldChuYW1lLCB2YWx1ZSwgb3B0aW9ucylcbiAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAvLyBpZ25vcmUgaW4gU2VydmVyIENvbXBvbmVudHNcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbn07XG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiY29va2llcyIsImNyZWF0ZVNlcnZlclN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwia2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJFcnJvciIsImdldEFsbCIsInNldEFsbCIsImNvb2tpZXNUb1NldCIsImZvckVhY2giLCJuYW1lIiwidmFsdWUiLCJvcHRpb25zIiwic2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&page=%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdungeons%2Frun%2F%5Bid%5D%2Ffight%2Froute.ts&appDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fartosetrov%2FDocuments%2FCursor%20AI%2FBumWars&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();