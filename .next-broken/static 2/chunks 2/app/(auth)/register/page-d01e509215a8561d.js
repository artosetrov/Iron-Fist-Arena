(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{3489:function(e,t,a){Promise.resolve().then(a.bind(a,3777))},3777:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(7437),l=a(2265),r=a(9376),n=a(7648),i=a(970);function u(){let[e,t]=(0,l.useState)(""),[a,u]=(0,l.useState)(""),[o,c]=(0,l.useState)(""),[d,m]=(0,l.useState)(null),[x,p]=(0,l.useState)(!1),h=(0,r.useRouter)(),f=async t=>{t.preventDefault(),m(null),p(!0);try{let t=(0,i.e)(),{data:l,error:r}=await t.auth.signUp({email:e,password:o,options:{data:{username:a}}});if(r){m(r.message);return}if(l.user){var s;await fetch("/api/auth/sync-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.user.email,username:a||(null===(s=l.user.user_metadata)||void 0===s?void 0:s.username)})})}h.push("/hub"),h.refresh()}finally{p(!1)}};return(0,s.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-8",children:(0,s.jsxs)("div",{className:"w-full max-w-sm rounded-lg border border-slate-200 bg-white p-6 shadow",children:[(0,s.jsx)("h1",{className:"mb-6 text-xl font-bold",children:"Регистрация"}),(0,s.jsxs)("form",{onSubmit:f,className:"flex flex-col gap-4",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"text-sm text-slate-600",children:"Email"}),(0,s.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"rounded border border-slate-300 px-3 py-2",autoComplete:"email","aria-label":"Email"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"text-sm text-slate-600",children:"Имя игрока"}),(0,s.jsx)("input",{type:"text",value:a,onChange:e=>u(e.target.value),required:!0,minLength:2,maxLength:50,className:"rounded border border-slate-300 px-3 py-2",autoComplete:"username","aria-label":"Имя игрока"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"text-sm text-slate-600",children:"Пароль"}),(0,s.jsx)("input",{type:"password",value:o,onChange:e=>c(e.target.value),required:!0,minLength:6,className:"rounded border border-slate-300 px-3 py-2",autoComplete:"new-password","aria-label":"Пароль"})]}),d&&(0,s.jsx)("p",{className:"text-sm text-red-600",role:"alert",children:d}),(0,s.jsx)("button",{type:"submit",disabled:x,className:"rounded bg-slate-800 px-4 py-2 text-white hover:bg-slate-700 disabled:opacity-50",children:x?"Регистрация…":"Зарегистрироваться"})]}),(0,s.jsxs)("p",{className:"mt-4 text-center text-sm text-slate-600",children:["Уже есть аккаунт?"," ",(0,s.jsx)(n.default,{href:"/login",className:"text-slate-800 underline",children:"Вход"})]})]})})}},970:function(e,t,a){"use strict";a.d(t,{e:function(){return r}});var s=a(4033),l=a(257);let r=()=>{let e=l.env.NEXT_PUBLIC_SUPABASE_URL,t=l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!t)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");return(0,s.createBrowserClient)(e,t)}}},function(e){e.O(0,[972,321,971,117,744],function(){return e(e.s=3489)}),_N_E=e.O()}]);